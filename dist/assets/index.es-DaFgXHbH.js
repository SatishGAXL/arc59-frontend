import{g as Tn,a as N0,bb as _a,c as Zi}from"./index-DRi3X8hX.js";import{a as $0,f as Yi,g as Xi,c as T0,b as df,d as F0,e as lf,p as Ui}from"./format-DGteTMuG.js";var pf={exports:{}},En=typeof Reflect=="object"?Reflect:null,oh=En&&typeof En.apply=="function"?En.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Gs;En&&typeof En.ownKeys=="function"?Gs=En.ownKeys:Object.getOwnPropertySymbols?Gs=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Gs=function(e){return Object.getOwnPropertyNames(e)};function C0(t){console&&console.warn&&console.warn(t)}var Tu=Number.isNaN||function(e){return e!==e};function nt(){nt.init.call(this)}pf.exports=nt;pf.exports.once=U0;nt.EventEmitter=nt;nt.prototype._events=void 0;nt.prototype._eventsCount=0;nt.prototype._maxListeners=void 0;var fh=10;function xa(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(nt,"defaultMaxListeners",{enumerable:!0,get:function(){return fh},set:function(t){if(typeof t!="number"||t<0||Tu(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");fh=t}});nt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};nt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Tu(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Fu(t){return t._maxListeners===void 0?nt.defaultMaxListeners:t._maxListeners}nt.prototype.getMaxListeners=function(){return Fu(this)};nt.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var s=e==="error",n=this._events;if(n!==void 0)s=s&&n.error===void 0;else if(!s)return!1;if(s){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var p=n[e];if(p===void 0)return!1;if(typeof p=="function")oh(p,this,r);else for(var b=p.length,w=Uu(p,b),i=0;i<b;++i)oh(w[i],this,r);return!0};function Cu(t,e,r,i){var s,n,o;if(xa(r),n=t._events,n===void 0?(n=t._events=Object.create(null),t._eventsCount=0):(n.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),n=t._events),o=n[e]),o===void 0)o=n[e]=r,++t._eventsCount;else if(typeof o=="function"?o=n[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),s=Fu(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,C0(c)}return t}nt.prototype.addListener=function(e,r){return Cu(this,e,r,!1)};nt.prototype.on=nt.prototype.addListener;nt.prototype.prependListener=function(e,r){return Cu(this,e,r,!0)};function L0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lu(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},s=L0.bind(i);return s.listener=r,i.wrapFn=s,s}nt.prototype.once=function(e,r){return xa(r),this.on(e,Lu(this,e,r)),this};nt.prototype.prependOnceListener=function(e,r){return xa(r),this.prependListener(e,Lu(this,e,r)),this};nt.prototype.removeListener=function(e,r){var i,s,n,o,c;if(xa(r),s=this._events,s===void 0)return this;if(i=s[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(n=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){c=i[o].listener,n=o;break}if(n<0)return this;n===0?i.shift():q0(i,n),i.length===1&&(s[e]=i[0]),s.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this};nt.prototype.off=nt.prototype.removeListener;nt.prototype.removeAllListeners=function(e){var r,i,s;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var n=Object.keys(i),o;for(s=0;s<n.length;++s)o=n[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(e,r[s]);return this};function qu(t,e,r){var i=t._events;if(i===void 0)return[];var s=i[e];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?B0(s):Uu(s,s.length)}nt.prototype.listeners=function(e){return qu(this,e,!0)};nt.prototype.rawListeners=function(e){return qu(this,e,!1)};nt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Bu.call(t,e)};nt.prototype.listenerCount=Bu;function Bu(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}nt.prototype.eventNames=function(){return this._eventsCount>0?Gs(this._events):[]};function Uu(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function q0(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function B0(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function U0(t,e){return new Promise(function(r,i){function s(o){t.removeListener(e,n),i(o)}function n(){typeof t.removeListener=="function"&&t.removeListener("error",s),r([].slice.call(arguments))}zu(t,e,n,{once:!0}),e!=="error"&&z0(t,s,{once:!0})})}function z0(t,e,r){typeof t.on=="function"&&zu(t,"error",e,r)}function zu(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(n){i.once&&t.removeEventListener(e,s),r(n)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var jr=pf.exports;const ku=Tn(jr);var W={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Lo=function(t,e){return Lo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},Lo(t,e)};function k0(t,e){Lo(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var qo=function(){return qo=Object.assign||function(e){for(var r,i=1,s=arguments.length;i<s;i++){r=arguments[i];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qo.apply(this,arguments)};function j0(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(r[i[s]]=t[i[s]]);return r}function K0(t,e,r,i){var s=arguments.length,n=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n}function V0(t,e){return function(r,i){e(r,i,t)}}function H0(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function W0(t,e,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function c(w){try{b(i.next(w))}catch(x){o(x)}}function p(w){try{b(i.throw(w))}catch(x){o(x)}}function b(w){w.done?n(w.value):s(w.value).then(c,p)}b((i=i.apply(t,e||[])).next())})}function G0(t,e){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,s,n,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(b){return function(w){return p([b,w])}}function p(b){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=b[0]&2?s.return:b[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,b[1])).done)return n;switch(s=0,n&&(b=[b[0]&2,n.value]),b[0]){case 0:case 1:n=b;break;case 4:return r.label++,{value:b[1],done:!1};case 5:r.label++,s=b[1],b=[0];continue;case 7:b=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(b[0]===6||b[0]===2)){r=0;continue}if(b[0]===3&&(!n||b[1]>n[0]&&b[1]<n[3])){r.label=b[1];break}if(b[0]===6&&r.label<n[1]){r.label=n[1],n=b;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(b);break}n[2]&&r.ops.pop(),r.trys.pop();continue}b=e.call(t,r)}catch(w){b=[6,w],s=0}finally{i=n=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function J0(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Z0(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Bo(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ju(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),s,n=[],o;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)n.push(s.value)}catch(c){o={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return n}function Y0(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ju(arguments[e]));return t}function X0(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),s=0,e=0;e<r;e++)for(var n=arguments[e],o=0,c=n.length;o<c;o++,s++)i[s]=n[o];return i}function ds(t){return this instanceof ds?(this.v=t,this):new ds(t)}function Q0(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),s,n=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(E){i[E]&&(s[E]=function(I){return new Promise(function(S,D){n.push([E,I,S,D])>1||c(E,I)})})}function c(E,I){try{p(i[E](I))}catch(S){x(n[0][3],S)}}function p(E){E.value instanceof ds?Promise.resolve(E.value.v).then(b,w):x(n[0][2],E)}function b(E){c("next",E)}function w(E){c("throw",E)}function x(E,I){E(I),n.shift(),n.length&&c(n[0][0],n[0][1])}}function ep(t){var e,r;return e={},i("next"),i("throw",function(s){throw s}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(s,n){e[s]=t[s]?function(o){return(r=!r)?{value:ds(t[s](o)),done:s==="return"}:n?n(o):o}:n}}function tp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Bo=="function"?Bo(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=t[n]&&function(o){return new Promise(function(c,p){o=t[n](o),s(c,p,o.done,o.value)})}}function s(n,o,c,p){Promise.resolve(p).then(function(b){n({value:b,done:c})},o)}}function rp(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ip(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function np(t){return t&&t.__esModule?t:{default:t}}function sp(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ap(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const op=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return qo},__asyncDelegator:ep,__asyncGenerator:Q0,__asyncValues:tp,__await:ds,__awaiter:W0,__classPrivateFieldGet:sp,__classPrivateFieldSet:ap,__createBinding:J0,__decorate:K0,__exportStar:Z0,__extends:k0,__generator:G0,__importDefault:np,__importStar:ip,__makeTemplateObject:rp,__metadata:H0,__param:V0,__read:ju,__rest:j0,__spread:Y0,__spreadArrays:X0,__values:Bo},Symbol.toStringTag,{value:"Module"})),Ma=N0(op);var Ja={},Gn={},hh;function fp(){if(hh)return Gn;hh=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Gn.delay=t,Gn}var zi={},Za={},ki={},ch;function hp(){return ch||(ch=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.ONE_THOUSAND=ki.ONE_HUNDRED=void 0,ki.ONE_HUNDRED=100,ki.ONE_THOUSAND=1e3),ki}var Ya={},uh;function cp(){return uh||(uh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Ya)),Ya}var dh;function Ku(){return dh||(dh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ma;e.__exportStar(hp(),t),e.__exportStar(cp(),t)}(Za)),Za}var lh;function up(){if(lh)return zi;lh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.fromMiliseconds=zi.toMiliseconds=void 0;const t=Ku();function e(i){return i*t.ONE_THOUSAND}zi.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return zi.fromMiliseconds=r,zi}var ph;function dp(){return ph||(ph=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ma;e.__exportStar(fp(),t),e.__exportStar(up(),t)}(Ja)),Ja}var pn={},gh;function lp(){if(gh)return pn;gh=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:s})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return pn.Watch=t,pn.default=t,pn}var Xa={},Jn={},vh;function pp(){if(vh)return Jn;vh=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.IWatch=void 0;class t{}return Jn.IWatch=t,Jn}var bh;function gp(){return bh||(bh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Ma.__exportStar(pp(),t)}(Xa)),Xa}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ma;e.__exportStar(dp(),t),e.__exportStar(lp(),t),e.__exportStar(gp(),t),e.__exportStar(Ku(),t)})(W);class an{}let vp=class extends an{constructor(e){super()}};const mh=W.FIVE_SECONDS,Fn={pulse:"heartbeat_pulse"};let bp=class Vu extends vp{constructor(e){super(e),this.events=new jr.EventEmitter,this.interval=mh,this.interval=(e==null?void 0:e.interval)||mh}static async init(e){const r=new Vu(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),W.toMiliseconds(this.interval))}pulse(){this.events.emit(Fn.pulse)}};const mp=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,yp=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,wp=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _p(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){xp(t);return}return e}function xp(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Ls(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!wp.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(mp.test(t)||yp.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,_p)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function Mp(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Et(t,...e){try{return Mp(t(...e))}catch(r){return Promise.reject(r)}}function Ep(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Sp(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Js(t){if(Ep(t))return String(t);if(Sp(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Js(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Uo="base64:";function Ip(t){return typeof t=="string"?t:Uo+Op(t)}function Ap(t){return typeof t!="string"||!t.startsWith(Uo)?t:Dp(t.slice(Uo.length))}function Dp(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function Op(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Gt(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Pp(...t){return Gt(t.join(":"))}function qs(t){return t=Gt(t),t?t+":":""}const Rp="memory",Np=()=>{const t=new Map;return{name:Rp,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function $p(t={}){const e={mounts:{"":t.driver||Np()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=b=>{for(const w of e.mountpoints)if(b.startsWith(w))return{base:w,relativeKey:b.slice(w.length),driver:e.mounts[w]};return{base:"",relativeKey:b,driver:e.mounts[""]}},i=(b,w)=>e.mountpoints.filter(x=>x.startsWith(b)||w&&b.startsWith(x)).map(x=>({relativeBase:b.length>x.length?b.slice(x.length):void 0,mountpoint:x,driver:e.mounts[x]})),s=(b,w)=>{if(e.watching){w=Gt(w);for(const x of e.watchListeners)x(b,w)}},n=async()=>{if(!e.watching){e.watching=!0;for(const b in e.mounts)e.unwatch[b]=await yh(e.mounts[b],s,b)}},o=async()=>{if(e.watching){for(const b in e.unwatch)await e.unwatch[b]();e.unwatch={},e.watching=!1}},c=(b,w,x)=>{const E=new Map,I=S=>{let D=E.get(S.base);return D||(D={driver:S.driver,base:S.base,items:[]},E.set(S.base,D)),D};for(const S of b){const D=typeof S=="string",P=Gt(D?S:S.key),R=D?void 0:S.value,N=D||!S.options?w:{...w,...S.options},C=r(P);I(C).items.push({key:P,value:R,relativeKey:C.relativeKey,options:N})}return Promise.all([...E.values()].map(S=>x(S))).then(S=>S.flat())},p={hasItem(b,w={}){b=Gt(b);const{relativeKey:x,driver:E}=r(b);return Et(E.hasItem,x,w)},getItem(b,w={}){b=Gt(b);const{relativeKey:x,driver:E}=r(b);return Et(E.getItem,x,w).then(I=>Ls(I))},getItems(b,w={}){return c(b,w,x=>x.driver.getItems?Et(x.driver.getItems,x.items.map(E=>({key:E.relativeKey,options:E.options})),w).then(E=>E.map(I=>({key:Pp(x.base,I.key),value:Ls(I.value)}))):Promise.all(x.items.map(E=>Et(x.driver.getItem,E.relativeKey,E.options).then(I=>({key:E.key,value:Ls(I)})))))},getItemRaw(b,w={}){b=Gt(b);const{relativeKey:x,driver:E}=r(b);return E.getItemRaw?Et(E.getItemRaw,x,w):Et(E.getItem,x,w).then(I=>Ap(I))},async setItem(b,w,x={}){if(w===void 0)return p.removeItem(b);b=Gt(b);const{relativeKey:E,driver:I}=r(b);I.setItem&&(await Et(I.setItem,E,Js(w),x),I.watch||s("update",b))},async setItems(b,w){await c(b,w,async x=>{if(x.driver.setItems)return Et(x.driver.setItems,x.items.map(E=>({key:E.relativeKey,value:Js(E.value),options:E.options})),w);x.driver.setItem&&await Promise.all(x.items.map(E=>Et(x.driver.setItem,E.relativeKey,Js(E.value),E.options)))})},async setItemRaw(b,w,x={}){if(w===void 0)return p.removeItem(b,x);b=Gt(b);const{relativeKey:E,driver:I}=r(b);if(I.setItemRaw)await Et(I.setItemRaw,E,w,x);else if(I.setItem)await Et(I.setItem,E,Ip(w),x);else return;I.watch||s("update",b)},async removeItem(b,w={}){typeof w=="boolean"&&(w={removeMeta:w}),b=Gt(b);const{relativeKey:x,driver:E}=r(b);E.removeItem&&(await Et(E.removeItem,x,w),(w.removeMeta||w.removeMata)&&await Et(E.removeItem,x+"$",w),E.watch||s("remove",b))},async getMeta(b,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),b=Gt(b);const{relativeKey:x,driver:E}=r(b),I=Object.create(null);if(E.getMeta&&Object.assign(I,await Et(E.getMeta,x,w)),!w.nativeOnly){const S=await Et(E.getItem,x+"$",w).then(D=>Ls(D));S&&typeof S=="object"&&(typeof S.atime=="string"&&(S.atime=new Date(S.atime)),typeof S.mtime=="string"&&(S.mtime=new Date(S.mtime)),Object.assign(I,S))}return I},setMeta(b,w,x={}){return this.setItem(b+"$",w,x)},removeMeta(b,w={}){return this.removeItem(b+"$",w)},async getKeys(b,w={}){b=qs(b);const x=i(b,!0);let E=[];const I=[];for(const S of x){const D=await Et(S.driver.getKeys,S.relativeBase,w);for(const P of D){const R=S.mountpoint+Gt(P);E.some(N=>R.startsWith(N))||I.push(R)}E=[S.mountpoint,...E.filter(P=>!P.startsWith(S.mountpoint))]}return b?I.filter(S=>S.startsWith(b)&&S[S.length-1]!=="$"):I.filter(S=>S[S.length-1]!=="$")},async clear(b,w={}){b=qs(b),await Promise.all(i(b,!1).map(async x=>{if(x.driver.clear)return Et(x.driver.clear,x.relativeBase,w);if(x.driver.removeItem){const E=await x.driver.getKeys(x.relativeBase||"",w);return Promise.all(E.map(I=>x.driver.removeItem(I,w)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(b=>wh(b)))},async watch(b){return await n(),e.watchListeners.push(b),async()=>{e.watchListeners=e.watchListeners.filter(w=>w!==b),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(b,w){if(b=qs(b),b&&e.mounts[b])throw new Error(`already mounted at ${b}`);return b&&(e.mountpoints.push(b),e.mountpoints.sort((x,E)=>E.length-x.length)),e.mounts[b]=w,e.watching&&Promise.resolve(yh(w,s,b)).then(x=>{e.unwatch[b]=x}).catch(console.error),p},async unmount(b,w=!0){var x,E;b=qs(b),!(!b||!e.mounts[b])&&(e.watching&&b in e.unwatch&&((E=(x=e.unwatch)[b])==null||E.call(x),delete e.unwatch[b]),w&&await wh(e.mounts[b]),e.mountpoints=e.mountpoints.filter(I=>I!==b),delete e.mounts[b])},getMount(b=""){b=Gt(b)+":";const w=r(b);return{driver:w.driver,base:w.base}},getMounts(b="",w={}){return b=Gt(b),i(b,w.parents).map(E=>({driver:E.driver,base:E.mountpoint}))},keys:(b,w={})=>p.getKeys(b,w),get:(b,w={})=>p.getItem(b,w),set:(b,w,x={})=>p.setItem(b,w,x),has:(b,w={})=>p.hasItem(b,w),del:(b,w={})=>p.removeItem(b,w),remove:(b,w={})=>p.removeItem(b,w)};return p}function yh(t,e,r){return t.watch?t.watch((i,s)=>e(i,r+s)):()=>{}}async function wh(t){typeof t.dispose=="function"&&await Et(t.dispose)}function on(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Hu(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const i=on(r);return(s,n)=>i.then(o=>n(o.transaction(e,s).objectStore(e)))}let Qa;function ms(){return Qa||(Qa=Hu("keyval-store","keyval")),Qa}function _h(t,e=ms()){return e("readonly",r=>on(r.get(t)))}function Tp(t,e,r=ms()){return r("readwrite",i=>(i.put(e,t),on(i.transaction)))}function Fp(t,e=ms()){return e("readwrite",r=>(r.delete(t),on(r.transaction)))}function Cp(t=ms()){return t("readwrite",e=>(e.clear(),on(e.transaction)))}function Lp(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},on(t.transaction)}function qp(t=ms()){return t("readonly",e=>{if(e.getAllKeys)return on(e.getAllKeys());const r=[];return Lp(e,i=>r.push(i.key)).then(()=>r)})}const Bp=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Up=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function In(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Up(t)}catch{return t}}function tn(t){return typeof t=="string"?t:Bp(t)||""}const zp="idb-keyval";var kp=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=s=>e+s;let i;return t.dbName&&t.storeName&&(i=Hu(t.dbName,t.storeName)),{name:zp,options:t,async hasItem(s){return!(typeof await _h(r(s),i)>"u")},async getItem(s){return await _h(r(s),i)??null},setItem(s,n){return Tp(r(s),n,i)},removeItem(s){return Fp(r(s),i)},getKeys(){return qp(i)},clear(){return Cp(i)}}};const jp="WALLET_CONNECT_V2_INDEXED_DB",Kp="keyvaluestorage";let Vp=class{constructor(){this.indexedDb=$p({driver:kp({dbName:jp,storeName:Kp})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,tn(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zs={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof eo<"u"&&eo.localStorage?Zs.exports=eo.localStorage:typeof window<"u"&&window.localStorage?Zs.exports=window.localStorage:Zs.exports=new e})();function Hp(t){var e;return[t[0],In((e=t[1])!=null?e:"")]}let Wp=class{constructor(){this.localStorage=Zs.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Hp)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return In(r)}async setItem(e,r){this.localStorage.setItem(e,tn(r))}async removeItem(e){this.localStorage.removeItem(e)}};const Gp="wc_storage_version",xh=1,Jp=async(t,e,r)=>{const i=Gp,s=await e.getItem(i);if(s&&s>=xh){r(e);return}const n=await t.getKeys();if(!n.length){r(e);return}const o=[];for(;n.length;){const c=n.shift();if(!c)continue;const p=c.toLowerCase();if(p.includes("wc@")||p.includes("walletconnect")||p.includes("wc_")||p.includes("wallet_connect")){const b=await t.getItem(c);await e.setItem(c,b),o.push(c)}}await e.setItem(i,xh),r(e),Zp(t,o)},Zp=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let Yp=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new Wp;this.storage=e;try{const r=new Vp;Jp(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};function Xp(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Qp=e1;function e1(t,e,r){var i=r&&r.stringify||Xp,s=1;if(typeof t=="object"&&t!==null){var n=e.length+s;if(n===1)return t;var o=new Array(n);o[0]=i(t);for(var c=1;c<n;c++)o[c]=i(e[c]);return o.join(" ")}if(typeof t!="string")return t;var p=e.length;if(p===0)return t;for(var b="",w=1-s,x=-1,E=t&&t.length||0,I=0;I<E;){if(t.charCodeAt(I)===37&&I+1<E){switch(x=x>-1?x:0,t.charCodeAt(I+1)){case 100:case 102:if(w>=p||e[w]==null)break;x<I&&(b+=t.slice(x,I)),b+=Number(e[w]),x=I+2,I++;break;case 105:if(w>=p||e[w]==null)break;x<I&&(b+=t.slice(x,I)),b+=Math.floor(Number(e[w])),x=I+2,I++;break;case 79:case 111:case 106:if(w>=p||e[w]===void 0)break;x<I&&(b+=t.slice(x,I));var S=typeof e[w];if(S==="string"){b+="'"+e[w]+"'",x=I+2,I++;break}if(S==="function"){b+=e[w].name||"<anonymous>",x=I+2,I++;break}b+=i(e[w]),x=I+2,I++;break;case 115:if(w>=p)break;x<I&&(b+=t.slice(x,I)),b+=String(e[w]),x=I+2,I++;break;case 37:x<I&&(b+=t.slice(x,I)),b+="%",x=I+2,I++,w--;break}++w}++I}return x===-1?t:(x<E&&(b+=t.slice(x)),b)}const Mh=Qp;var _n=Jr;const ls=c1().console||{},t1={mapHttpRequest:Bs,mapHttpResponse:Bs,wrapRequestSerializer:to,wrapResponseSerializer:to,wrapErrorSerializer:to,req:Bs,res:Bs,err:a1};function r1(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Jr(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||ls;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},s=r1(t.browser.serialize,i);let n=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(n=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",p=Object.create(r);p.log||(p.log=ps),Object.defineProperty(p,"levelVal",{get:w}),Object.defineProperty(p,"level",{get:x,set:E});const b={transmit:e,serialize:s,asObject:t.browser.asObject,levels:o,timestamp:o1(t)};p.levels=Jr.levels,p.level=c,p.setMaxListeners=p.getMaxListeners=p.emit=p.addListener=p.on=p.prependListener=p.once=p.prependOnceListener=p.removeListener=p.removeAllListeners=p.listeners=p.listenerCount=p.eventNames=p.write=p.flush=ps,p.serializers=i,p._serialize=s,p._stdErrSerialize=n,p.child=I,e&&(p._logEvent=zo());function w(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function E(S){if(S!=="silent"&&!this.levels.values[S])throw Error("unknown level "+S);this._level=S,gn(b,p,"error","log"),gn(b,p,"fatal","error"),gn(b,p,"warn","error"),gn(b,p,"info","log"),gn(b,p,"debug","log"),gn(b,p,"trace","log")}function I(S,D){if(!S)throw new Error("missing bindings for child Pino");D=D||{},s&&S.serializers&&(D.serializers=S.serializers);const P=D.serializers;if(s&&P){var R=Object.assign({},i,P),N=t.browser.serialize===!0?Object.keys(R):s;delete S.serializers,Ea([S],N,R,this._stdErrSerialize)}function C(L){this._childLevel=(L._childLevel|0)+1,this.error=vn(L,S,"error"),this.fatal=vn(L,S,"fatal"),this.warn=vn(L,S,"warn"),this.info=vn(L,S,"info"),this.debug=vn(L,S,"debug"),this.trace=vn(L,S,"trace"),R&&(this.serializers=R,this._serialize=N),e&&(this._logEvent=zo([].concat(L._logEvent.bindings,S)))}return C.prototype=this,new C(this)}return p}Jr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Jr.stdSerializers=t1;Jr.stdTimeFunctions=Object.assign({},{nullTime:Wu,epochTime:Gu,unixTime:f1,isoTime:h1});function gn(t,e,r,i){const s=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?ps:s[r]?s[r]:ls[r]||ls[i]||ps,i1(t,e,r)}function i1(t,e,r){!t.transmit&&e[r]===ps||(e[r]=function(i){return function(){const n=t.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ls?ls:this;for(var p=0;p<o.length;p++)o[p]=arguments[p];if(t.serialize&&!t.asObject&&Ea(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,n1(this,r,o,n)):i.apply(c,o),t.transmit){const b=t.transmit.level||e.level,w=Jr.levels.values[b],x=Jr.levels.values[r];if(x<w)return;s1(this,{ts:n,methodLevel:r,methodValue:x,transmitLevel:b,transmitValue:Jr.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function n1(t,e,r,i){t._serialize&&Ea(r,t._serialize,t.serializers,t._stdErrSerialize);const s=r.slice();let n=s[0];const o={};i&&(o.time=i),o.level=Jr.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),n!==null&&typeof n=="object"){for(;c--&&typeof s[0]=="object";)Object.assign(o,s.shift());n=s.length?Mh(s.shift(),s):void 0}else typeof n=="string"&&(n=Mh(s.shift(),s));return n!==void 0&&(o.msg=n),o}function Ea(t,e,r,i){for(const s in t)if(i&&t[s]instanceof Error)t[s]=Jr.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const n in t[s])e&&e.indexOf(n)>-1&&n in r&&(t[s][n]=r[n](t[s][n]))}function vn(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return t[r].apply(this,i)}}function s1(t,e,r){const i=e.send,s=e.ts,n=e.methodLevel,o=e.methodValue,c=e.val,p=t._logEvent.bindings;Ea(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=r.filter(function(b){return p.indexOf(b)===-1}),t._logEvent.level.label=n,t._logEvent.level.value=o,i(n,t._logEvent,c),t._logEvent=zo(p)}function zo(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function a1(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function o1(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Wu:Gu}function Bs(){return{}}function to(t){return t}function ps(){}function Wu(){return!1}function Gu(){return Date.now()}function f1(){return Math.round(Date.now()/1e3)}function h1(){return new Date(Date.now()).toISOString()}function c1(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const Sa=Tn(_n),u1={level:"info"},ys="custom_context",gf=1e3*1024;class d1{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}let Eh=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new d1(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}},Ju=class{constructor(e,r=gf){this.level=e??"error",this.levelValue=_n.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Eh(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===_n.levels.values.error?console.error(e):r===_n.levels.values.warn?console.warn(e):r===_n.levels.values.debug?console.debug(e):r===_n.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(tn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Eh(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(tn({extraMetadata:e})),new Blob(r,{type:"application/json"})}};class l1{constructor(e,r=gf){this.baseChunkLogger=new Ju(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=r,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}}class p1{constructor(e,r=gf){this.baseChunkLogger=new Ju(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var g1=Object.defineProperty,v1=Object.defineProperties,b1=Object.getOwnPropertyDescriptors,Sh=Object.getOwnPropertySymbols,m1=Object.prototype.hasOwnProperty,y1=Object.prototype.propertyIsEnumerable,Ih=(t,e,r)=>e in t?g1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sa=(t,e)=>{for(var r in e||(e={}))m1.call(e,r)&&Ih(t,r,e[r]);if(Sh)for(var r of Sh(e))y1.call(e,r)&&Ih(t,r,e[r]);return t},aa=(t,e)=>v1(t,b1(e));function vf(t){return aa(sa({},t),{level:(t==null?void 0:t.level)||u1.level})}function w1(t,e=ys){return t[e]||""}function _1(t,e,r=ys){return t[r]=e,t}function Xt(t,e=ys){let r="";return typeof t.bindings>"u"?r=w1(t,e):r=t.bindings().context||"",r}function x1(t,e,r=ys){const i=Xt(t,r);return i.trim()?`${i}/${e}`:e}function Ht(t,e,r=ys){const i=x1(t,e,r),s=t.child({context:i});return _1(s,i,r)}function M1(t){var e,r;const i=new l1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Sa(aa(sa({},t.opts),{level:"trace",browser:aa(sa({},(r=t.opts)==null?void 0:r.browser),{write:s=>i.write(s)})})),chunkLoggerController:i}}function E1(t){var e;const r=new p1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Sa(aa(sa({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function S1(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?M1(t):E1(t)}let I1=class extends an{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}},A1=class extends an{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}};class D1{constructor(e,r){this.logger=e,this.core=r}}class O1 extends an{constructor(e,r){super(),this.relayer=e,this.logger=r}}class P1 extends an{constructor(e){super()}}class R1{constructor(e,r,i,s){this.core=e,this.logger=r,this.name=i}}let N1=class extends an{constructor(e,r){super(),this.relayer=e,this.logger=r}},$1=class extends an{constructor(e,r){super(),this.core=e,this.logger=r}};class T1{constructor(e,r,i){this.core=e,this.logger=r,this.store=i}}let F1=class{constructor(e,r){this.projectId=e,this.logger=r}},C1=class{constructor(e,r,i){this.core=e,this.logger=r,this.telemetryEnabled=i}};class L1{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}let q1=class{constructor(e){this.client=e}};function B1(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Zu(t,...e){if(!B1(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ah(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function U1(t,e){Zu(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const bn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ro=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function z1(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Yu(t){return typeof t=="string"&&(t=z1(t)),Zu(t),t}let k1=class{clone(){return this._cloneInto()}};function j1(t){const e=i=>t().update(Yu(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Xu(t=32){if(bn&&typeof bn.getRandomValues=="function")return bn.getRandomValues(new Uint8Array(t));if(bn&&typeof bn.randomBytes=="function")return bn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function K1(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),c=Number(r&n),p=i?4:0,b=i?0:4;t.setUint32(e+p,o,i),t.setUint32(e+b,c,i)}class V1 extends k1{constructor(e,r,i,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ro(this.buffer)}update(e){Ah(this);const{view:r,buffer:i,blockLen:s}=this;e=Yu(e);const n=e.length;for(let o=0;o<n;){const c=Math.min(s-this.pos,n-o);if(c===s){const p=ro(e);for(;s<=n-o;o+=s)this.process(p,o);continue}i.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ah(this),U1(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:s,isLE:n}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(i,0),o=0);for(let x=o;x<s;x++)r[x]=0;K1(i,s-8,BigInt(this.length*8),n),this.process(i,0);const c=ro(e),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=p/4,w=this.get();if(b>w.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<b;x++)c.setUint32(4*x,w[x],n)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:s,finished:n,destroyed:o,pos:c}=this;return e.length=s,e.pos=c,e.finished=n,e.destroyed=o,s%r&&e.buffer.set(i),e}}const Us=BigInt(2**32-1),ko=BigInt(32);function Qu(t,e=!1){return e?{h:Number(t&Us),l:Number(t>>ko&Us)}:{h:Number(t>>ko&Us)|0,l:Number(t&Us)|0}}function H1(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:n,l:o}=Qu(t[s],e);[r[s],i[s]]=[n,o]}return[r,i]}const W1=(t,e)=>BigInt(t>>>0)<<ko|BigInt(e>>>0),G1=(t,e,r)=>t>>>r,J1=(t,e,r)=>t<<32-r|e>>>r,Z1=(t,e,r)=>t>>>r|e<<32-r,Y1=(t,e,r)=>t<<32-r|e>>>r,X1=(t,e,r)=>t<<64-r|e>>>r-32,Q1=(t,e,r)=>t>>>r-32|e<<64-r,eg=(t,e)=>e,tg=(t,e)=>t,rg=(t,e,r)=>t<<r|e>>>32-r,ig=(t,e,r)=>e<<r|t>>>32-r,ng=(t,e,r)=>e<<r-32|t>>>64-r,sg=(t,e,r)=>t<<r-32|e>>>64-r;function ag(t,e,r,i){const s=(e>>>0)+(i>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const og=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),fg=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,hg=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),cg=(t,e,r,i,s)=>e+r+i+s+(t/2**32|0)|0,ug=(t,e,r,i,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(s>>>0),dg=(t,e,r,i,s,n)=>e+r+i+s+n+(t/2**32|0)|0,Le={fromBig:Qu,split:H1,toBig:W1,shrSH:G1,shrSL:J1,rotrSH:Z1,rotrSL:Y1,rotrBH:X1,rotrBL:Q1,rotr32H:eg,rotr32L:tg,rotlSH:rg,rotlSL:ig,rotlBH:ng,rotlBL:sg,add:ag,add3L:og,add3H:fg,add4L:hg,add4H:cg,add5H:dg,add5L:ug},[lg,pg]=Le.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),xi=new Uint32Array(80),Mi=new Uint32Array(80);let gg=class extends V1{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:s,Ch:n,Cl:o,Dh:c,Dl:p,Eh:b,El:w,Fh:x,Fl:E,Gh:I,Gl:S,Hh:D,Hl:P}=this;return[e,r,i,s,n,o,c,p,b,w,x,E,I,S,D,P]}set(e,r,i,s,n,o,c,p,b,w,x,E,I,S,D,P){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=s|0,this.Ch=n|0,this.Cl=o|0,this.Dh=c|0,this.Dl=p|0,this.Eh=b|0,this.El=w|0,this.Fh=x|0,this.Fl=E|0,this.Gh=I|0,this.Gl=S|0,this.Hh=D|0,this.Hl=P|0}process(e,r){for(let C=0;C<16;C++,r+=4)xi[C]=e.getUint32(r),Mi[C]=e.getUint32(r+=4);for(let C=16;C<80;C++){const L=xi[C-15]|0,B=Mi[C-15]|0,U=Le.rotrSH(L,B,1)^Le.rotrSH(L,B,8)^Le.shrSH(L,B,7),K=Le.rotrSL(L,B,1)^Le.rotrSL(L,B,8)^Le.shrSL(L,B,7),k=xi[C-2]|0,z=Mi[C-2]|0,pe=Le.rotrSH(k,z,19)^Le.rotrBH(k,z,61)^Le.shrSH(k,z,6),A=Le.rotrSL(k,z,19)^Le.rotrBL(k,z,61)^Le.shrSL(k,z,6),_=Le.add4L(K,A,Mi[C-7],Mi[C-16]),d=Le.add4H(_,U,pe,xi[C-7],xi[C-16]);xi[C]=d|0,Mi[C]=_|0}let{Ah:i,Al:s,Bh:n,Bl:o,Ch:c,Cl:p,Dh:b,Dl:w,Eh:x,El:E,Fh:I,Fl:S,Gh:D,Gl:P,Hh:R,Hl:N}=this;for(let C=0;C<80;C++){const L=Le.rotrSH(x,E,14)^Le.rotrSH(x,E,18)^Le.rotrBH(x,E,41),B=Le.rotrSL(x,E,14)^Le.rotrSL(x,E,18)^Le.rotrBL(x,E,41),U=x&I^~x&D,K=E&S^~E&P,k=Le.add5L(N,B,K,pg[C],Mi[C]),z=Le.add5H(k,R,L,U,lg[C],xi[C]),pe=k|0,A=Le.rotrSH(i,s,28)^Le.rotrBH(i,s,34)^Le.rotrBH(i,s,39),_=Le.rotrSL(i,s,28)^Le.rotrBL(i,s,34)^Le.rotrBL(i,s,39),d=i&n^i&c^n&c,a=s&o^s&p^o&p;R=D|0,N=P|0,D=I|0,P=S|0,I=x|0,S=E|0,{h:x,l:E}=Le.add(b|0,w|0,z|0,pe|0),b=c|0,w=p|0,c=n|0,p=o|0,n=i|0,o=s|0;const f=Le.add3L(pe,_,a);i=Le.add3H(f,z,A,d),s=f|0}({h:i,l:s}=Le.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:n,l:o}=Le.add(this.Bh|0,this.Bl|0,n|0,o|0),{h:c,l:p}=Le.add(this.Ch|0,this.Cl|0,c|0,p|0),{h:b,l:w}=Le.add(this.Dh|0,this.Dl|0,b|0,w|0),{h:x,l:E}=Le.add(this.Eh|0,this.El|0,x|0,E|0),{h:I,l:S}=Le.add(this.Fh|0,this.Fl|0,I|0,S|0),{h:D,l:P}=Le.add(this.Gh|0,this.Gl|0,D|0,P|0),{h:R,l:N}=Le.add(this.Hh|0,this.Hl|0,R|0,N|0),this.set(i,s,n,o,c,p,b,w,x,E,I,S,D,P,R,N)}roundClean(){xi.fill(0),Mi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const vg=j1(()=>new gg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bf=BigInt(0),ed=BigInt(1),bg=BigInt(2);function mf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function yf(t){if(!mf(t))throw new Error("Uint8Array expected")}function io(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const mg=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function wf(t){yf(t);let e="";for(let r=0;r<t.length;r++)e+=mg[t[r]];return e}function td(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?bf:BigInt("0x"+t)}const hi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Dh(t){if(t>=hi._0&&t<=hi._9)return t-hi._0;if(t>=hi.A&&t<=hi.F)return t-(hi.A-10);if(t>=hi.a&&t<=hi.f)return t-(hi.a-10)}function rd(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let s=0,n=0;s<r;s++,n+=2){const o=Dh(t.charCodeAt(n)),c=Dh(t.charCodeAt(n+1));if(o===void 0||c===void 0){const p=t[n]+t[n+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+n)}i[s]=o*16+c}return i}function yg(t){return td(wf(t))}function Ys(t){return yf(t),td(wf(Uint8Array.from(t).reverse()))}function id(t,e){return rd(t.toString(16).padStart(e*2,"0"))}function jo(t,e){return id(t,e).reverse()}function ci(t,e,r){let i;if(typeof e=="string")try{i=rd(e)}catch(n){throw new Error(t+" must be hex string or Uint8Array, cause: "+n)}else if(mf(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=i.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return i}function Oh(...t){let e=0;for(let i=0;i<t.length;i++){const s=t[i];yf(s),e+=s.length}const r=new Uint8Array(e);for(let i=0,s=0;i<t.length;i++){const n=t[i];r.set(n,s),s+=n.length}return r}const no=t=>typeof t=="bigint"&&bf<=t;function wg(t,e,r){return no(t)&&no(e)&&no(r)&&e<=t&&t<r}function Zn(t,e,r,i){if(!wg(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function _g(t){let e;for(e=0;t>bf;t>>=ed,e+=1);return e}const xg=t=>(bg<<BigInt(t-1))-ed,Mg={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||mf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function _f(t,e,r={}){const i=(s,n,o)=>{const c=Mg[n];if(typeof c!="function")throw new Error("invalid validator function");const p=t[s];if(!(o&&p===void 0)&&!c(p,t))throw new Error("param "+String(s)+" is invalid. Expected "+n+", got "+p)};for(const[s,n]of Object.entries(e))i(s,n,!1);for(const[s,n]of Object.entries(r))i(s,n,!0);return t}function Ph(t){const e=new WeakMap;return(r,...i)=>{const s=e.get(r);if(s!==void 0)return s;const n=t(r,...i);return e.set(r,n),n}}const At=BigInt(0),bt=BigInt(1),Wi=BigInt(2),Eg=BigInt(3),Ko=BigInt(4),Rh=BigInt(5),Nh=BigInt(8);function _t(t,e){const r=t%e;return r>=At?r:e+r}function Sg(t,e,r){if(e<At)throw new Error("invalid exponent, negatives unsupported");if(r<=At)throw new Error("invalid modulus");if(r===bt)return At;let i=bt;for(;e>At;)e&bt&&(i=i*t%r),t=t*t%r,e>>=bt;return i}function Kr(t,e,r){let i=t;for(;e-- >At;)i*=i,i%=r;return i}function $h(t,e){if(t===At)throw new Error("invert: expected non-zero number");if(e<=At)throw new Error("invert: expected positive modulus, got "+e);let r=_t(t,e),i=e,s=At,n=bt;for(;r!==At;){const o=i/r,c=i%r,p=s-n*o;i=r,r=c,s=n,n=p}if(i!==bt)throw new Error("invert: does not exist");return _t(s,e)}function Ig(t){const e=(t-bt)/Wi;let r,i,s;for(r=t-bt,i=0;r%Wi===At;r/=Wi,i++);for(s=Wi;s<t&&Sg(s,e,t)!==t-bt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const o=(t+bt)/Ko;return function(c,p){const b=c.pow(p,o);if(!c.eql(c.sqr(b),p))throw new Error("Cannot find square root");return b}}const n=(r+bt)/Wi;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let p=i,b=o.pow(o.mul(o.ONE,s),r),w=o.pow(c,n),x=o.pow(c,r);for(;!o.eql(x,o.ONE);){if(o.eql(x,o.ZERO))return o.ZERO;let E=1;for(let S=o.sqr(x);E<p&&!o.eql(S,o.ONE);E++)S=o.sqr(S);const I=o.pow(b,bt<<BigInt(p-E-1));b=o.sqr(I),w=o.mul(w,I),x=o.mul(x,b),p=E}return w}}function Ag(t){if(t%Ko===Eg){const e=(t+bt)/Ko;return function(r,i){const s=r.pow(i,e);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Nh===Rh){const e=(t-Rh)/Nh;return function(r,i){const s=r.mul(i,Wi),n=r.pow(s,e),o=r.mul(i,n),c=r.mul(r.mul(o,Wi),n),p=r.mul(o,r.sub(c,r.ONE));if(!r.eql(r.sqr(p),i))throw new Error("Cannot find square root");return p}}return Ig(t)}const Dg=(t,e)=>(_t(t,e)&bt)===bt,Og=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Pg(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Og.reduce((i,s)=>(i[s]="function",i),e);return _f(t,r)}function Rg(t,e,r){if(r<At)throw new Error("invalid exponent, negatives unsupported");if(r===At)return t.ONE;if(r===bt)return e;let i=t.ONE,s=e;for(;r>At;)r&bt&&(i=t.mul(i,s)),s=t.sqr(s),r>>=bt;return i}function Ng(t,e){const r=new Array(e.length),i=e.reduce((n,o,c)=>t.is0(o)?n:(r[c]=n,t.mul(n,o)),t.ONE),s=t.inv(i);return e.reduceRight((n,o,c)=>t.is0(o)?n:(r[c]=t.mul(n,r[c]),t.mul(n,o)),s),r}function nd(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function sd(t,e,r=!1,i={}){if(t<=At)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:n}=nd(t,e);if(n>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const c=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:n,MASK:xg(s),ZERO:At,ONE:bt,create:p=>_t(p,t),isValid:p=>{if(typeof p!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof p);return At<=p&&p<t},is0:p=>p===At,isOdd:p=>(p&bt)===bt,neg:p=>_t(-p,t),eql:(p,b)=>p===b,sqr:p=>_t(p*p,t),add:(p,b)=>_t(p+b,t),sub:(p,b)=>_t(p-b,t),mul:(p,b)=>_t(p*b,t),pow:(p,b)=>Rg(c,p,b),div:(p,b)=>_t(p*$h(b,t),t),sqrN:p=>p*p,addN:(p,b)=>p+b,subN:(p,b)=>p-b,mulN:(p,b)=>p*b,inv:p=>$h(p,t),sqrt:i.sqrt||(p=>(o||(o=Ag(t)),o(c,p))),invertBatch:p=>Ng(c,p),cmov:(p,b,w)=>w?b:p,toBytes:p=>r?jo(p,n):id(p,n),fromBytes:p=>{if(p.length!==n)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+p.length);return r?Ys(p):yg(p)}});return Object.freeze(c)}const Th=BigInt(0),zs=BigInt(1);function so(t,e){const r=e.negate();return t?r:e}function ad(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ao(t,e){ad(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function $g(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function Tg(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const oo=new WeakMap,od=new WeakMap;function fo(t){return od.get(t)||1}function Fg(t,e){return{constTimeNegate:so,hasPrecomputes(r){return fo(r)!==1},unsafeLadder(r,i,s=t.ZERO){let n=r;for(;i>Th;)i&zs&&(s=s.add(n)),n=n.double(),i>>=zs;return s},precomputeWindow(r,i){const{windows:s,windowSize:n}=ao(i,e),o=[];let c=r,p=c;for(let b=0;b<s;b++){p=c,o.push(p);for(let w=1;w<n;w++)p=p.add(c),o.push(p);c=p.double()}return o},wNAF(r,i,s){const{windows:n,windowSize:o}=ao(r,e);let c=t.ZERO,p=t.BASE;const b=BigInt(2**r-1),w=2**r,x=BigInt(r);for(let E=0;E<n;E++){const I=E*o;let S=Number(s&b);s>>=x,S>o&&(S-=w,s+=zs);const D=I,P=I+Math.abs(S)-1,R=E%2!==0,N=S<0;S===0?p=p.add(so(R,i[D])):c=c.add(so(N,i[P]))}return{p:c,f:p}},wNAFUnsafe(r,i,s,n=t.ZERO){const{windows:o,windowSize:c}=ao(r,e),p=BigInt(2**r-1),b=2**r,w=BigInt(r);for(let x=0;x<o;x++){const E=x*c;if(s===Th)break;let I=Number(s&p);if(s>>=w,I>c&&(I-=b,s+=zs),I===0)continue;let S=i[E+Math.abs(I)-1];I<0&&(S=S.negate()),n=n.add(S)}return n},getPrecomputes(r,i,s){let n=oo.get(i);return n||(n=this.precomputeWindow(i,r),r!==1&&oo.set(i,s(n))),n},wNAFCached(r,i,s){const n=fo(r);return this.wNAF(n,this.getPrecomputes(n,r,s),i)},wNAFCachedUnsafe(r,i,s,n){const o=fo(r);return o===1?this.unsafeLadder(r,i,n):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),i,n)},setWindowSize(r,i){ad(i,e),od.set(r,i),oo.delete(r)}}}function Cg(t,e,r,i){if($g(r,t),Tg(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,n=_g(BigInt(r.length)),o=n>12?n-3:n>4?n-2:n?2:1,c=(1<<o)-1,p=new Array(c+1).fill(s),b=Math.floor((e.BITS-1)/o)*o;let w=s;for(let x=b;x>=0;x-=o){p.fill(s);for(let I=0;I<i.length;I++){const S=i[I],D=Number(S>>BigInt(x)&BigInt(c));p[D]=p[D].add(r[I])}let E=s;for(let I=p.length-1,S=s;I>0;I--)S=S.add(p[I]),E=E.add(S);if(w=w.add(E),x!==0)for(let I=0;I<o;I++)w=w.double()}return w}function Lg(t){return Pg(t.Fp),_f(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nd(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const $r=BigInt(0),Wt=BigInt(1),ks=BigInt(2),qg=BigInt(8),Bg={zip215:!0};function Ug(t){const e=Lg(t);return _f(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function zg(t){const e=Ug(t),{Fp:r,n:i,prehash:s,hash:n,randomBytes:o,nByteLength:c,h:p}=e,b=ks<<BigInt(c*8)-Wt,w=r.create,x=sd(e.n,e.nBitLength),E=e.uvRatio||((f,u)=>{try{return{isValid:!0,value:r.sqrt(f*r.inv(u))}}catch{return{isValid:!1,value:$r}}}),I=e.adjustScalarBytes||(f=>f),S=e.domain||((f,u,v)=>{if(io("phflag",v),u.length||v)throw new Error("Contexts/pre-hash are not supported");return f});function D(f,u){Zn("coordinate "+f,u,$r,b)}function P(f){if(!(f instanceof C))throw new Error("ExtendedPoint expected")}const R=Ph((f,u)=>{const{ex:v,ey:y,ez:m}=f,l=f.is0();u==null&&(u=l?qg:r.inv(m));const g=w(v*u),h=w(y*u),M=w(m*u);if(l)return{x:$r,y:Wt};if(M!==Wt)throw new Error("invZ was invalid");return{x:g,y:h}}),N=Ph(f=>{const{a:u,d:v}=e;if(f.is0())throw new Error("bad point: ZERO");const{ex:y,ey:m,ez:l,et:g}=f,h=w(y*y),M=w(m*m),T=w(l*l),$=w(T*T),q=w(h*u),G=w(T*w(q+M)),H=w($+w(v*w(h*M)));if(G!==H)throw new Error("bad point: equation left != right (1)");const V=w(y*m),Oe=w(l*g);if(V!==Oe)throw new Error("bad point: equation left != right (2)");return!0});class C{constructor(u,v,y,m){this.ex=u,this.ey=v,this.ez=y,this.et=m,D("x",u),D("y",v),D("z",y),D("t",m),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(u){if(u instanceof C)throw new Error("extended point not allowed");const{x:v,y}=u||{};return D("x",v),D("y",y),new C(v,y,Wt,w(v*y))}static normalizeZ(u){const v=r.invertBatch(u.map(y=>y.ez));return u.map((y,m)=>y.toAffine(v[m])).map(C.fromAffine)}static msm(u,v){return Cg(C,x,u,v)}_setWindowSize(u){U.setWindowSize(this,u)}assertValidity(){N(this)}equals(u){P(u);const{ex:v,ey:y,ez:m}=this,{ex:l,ey:g,ez:h}=u,M=w(v*h),T=w(l*m),$=w(y*h),q=w(g*m);return M===T&&$===q}is0(){return this.equals(C.ZERO)}negate(){return new C(w(-this.ex),this.ey,this.ez,w(-this.et))}double(){const{a:u}=e,{ex:v,ey:y,ez:m}=this,l=w(v*v),g=w(y*y),h=w(ks*w(m*m)),M=w(u*l),T=v+y,$=w(w(T*T)-l-g),q=M+g,G=q-h,H=M-g,V=w($*G),Oe=w(q*H),ge=w($*H),Y=w(G*q);return new C(V,Oe,Y,ge)}add(u){P(u);const{a:v,d:y}=e,{ex:m,ey:l,ez:g,et:h}=this,{ex:M,ey:T,ez:$,et:q}=u;if(v===BigInt(-1)){const je=w((l-m)*(T+M)),we=w((l+m)*(T-M)),ee=w(we-je);if(ee===$r)return this.double();const Ke=w(g*ks*q),_e=w(h*ks*$),re=_e+Ke,Ve=we+je,xe=_e-Ke,Q=w(re*ee),ze=w(Ve*xe),Me=w(re*xe),Z=w(ee*Ve);return new C(Q,ze,Z,Me)}const G=w(m*M),H=w(l*T),V=w(h*y*q),Oe=w(g*$),ge=w((m+l)*(M+T)-G-H),Y=Oe-V,Be=Oe+V,be=w(H-v*G),ie=w(ge*Y),He=w(Be*be),Se=w(ge*be),ne=w(Y*Be);return new C(ie,He,ne,Se)}subtract(u){return this.add(u.negate())}wNAF(u){return U.wNAFCached(this,u,C.normalizeZ)}multiply(u){const v=u;Zn("scalar",v,Wt,i);const{p:y,f:m}=this.wNAF(v);return C.normalizeZ([y,m])[0]}multiplyUnsafe(u,v=C.ZERO){const y=u;return Zn("scalar",y,$r,i),y===$r?B:this.is0()||y===Wt?this:U.wNAFCachedUnsafe(this,y,C.normalizeZ,v)}isSmallOrder(){return this.multiplyUnsafe(p).is0()}isTorsionFree(){return U.unsafeLadder(this,i).is0()}toAffine(u){return R(this,u)}clearCofactor(){const{h:u}=e;return u===Wt?this:this.multiplyUnsafe(u)}static fromHex(u,v=!1){const{d:y,a:m}=e,l=r.BYTES;u=ci("pointHex",u,l),io("zip215",v);const g=u.slice(),h=u[l-1];g[l-1]=h&-129;const M=Ys(g),T=v?b:r.ORDER;Zn("pointHex.y",M,$r,T);const $=w(M*M),q=w($-Wt),G=w(y*$-m);let{isValid:H,value:V}=E(q,G);if(!H)throw new Error("Point.fromHex: invalid y coordinate");const Oe=(V&Wt)===Wt,ge=(h&128)!==0;if(!v&&V===$r&&ge)throw new Error("Point.fromHex: x=0 and x_0=1");return ge!==Oe&&(V=w(-V)),C.fromAffine({x:V,y:M})}static fromPrivateKey(u){return z(u).point}toRawBytes(){const{x:u,y:v}=this.toAffine(),y=jo(v,r.BYTES);return y[y.length-1]|=u&Wt?128:0,y}toHex(){return wf(this.toRawBytes())}}C.BASE=new C(e.Gx,e.Gy,Wt,w(e.Gx*e.Gy)),C.ZERO=new C($r,Wt,Wt,$r);const{BASE:L,ZERO:B}=C,U=Fg(C,c*8);function K(f){return _t(f,i)}function k(f){return K(Ys(f))}function z(f){const u=r.BYTES;f=ci("private key",f,u);const v=ci("hashed private key",n(f),2*u),y=I(v.slice(0,u)),m=v.slice(u,2*u),l=k(y),g=L.multiply(l),h=g.toRawBytes();return{head:y,prefix:m,scalar:l,point:g,pointBytes:h}}function pe(f){return z(f).pointBytes}function A(f=new Uint8Array,...u){const v=Oh(...u);return k(n(S(v,ci("context",f),!!s)))}function _(f,u,v={}){f=ci("message",f),s&&(f=s(f));const{prefix:y,scalar:m,pointBytes:l}=z(u),g=A(v.context,y,f),h=L.multiply(g).toRawBytes(),M=A(v.context,h,l,f),T=K(g+M*m);Zn("signature.s",T,$r,i);const $=Oh(h,jo(T,r.BYTES));return ci("result",$,r.BYTES*2)}const d=Bg;function a(f,u,v,y=d){const{context:m,zip215:l}=y,g=r.BYTES;f=ci("signature",f,2*g),u=ci("message",u),v=ci("publicKey",v,g),l!==void 0&&io("zip215",l),s&&(u=s(u));const h=Ys(f.slice(g,2*g));let M,T,$;try{M=C.fromHex(v,l),T=C.fromHex(f.slice(0,g),l),$=L.multiplyUnsafe(h)}catch{return!1}if(!l&&M.isSmallOrder())return!1;const q=A(m,T.toRawBytes(),M.toRawBytes(),u);return T.add(M.multiplyUnsafe(q)).subtract($).clearCofactor().equals(C.ZERO)}return L._setWindowSize(8),{CURVE:e,getPublicKey:pe,sign:_,verify:a,ExtendedPoint:C,utils:{getExtendedPublicKey:z,randomPrivateKey:()=>o(r.BYTES),precompute(f=8,u=C.BASE){return u._setWindowSize(f),u.multiply(BigInt(3)),u}}}}BigInt(0),BigInt(1);const xf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Fh=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const kg=BigInt(1),Ch=BigInt(2);BigInt(3);const jg=BigInt(5),Kg=BigInt(8);function Vg(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=xf,o=t*t%n*t%n,c=Kr(o,Ch,n)*o%n,p=Kr(c,kg,n)*t%n,b=Kr(p,jg,n)*p%n,w=Kr(b,e,n)*b%n,x=Kr(w,r,n)*w%n,E=Kr(x,i,n)*x%n,I=Kr(E,s,n)*E%n,S=Kr(I,s,n)*E%n,D=Kr(S,e,n)*b%n;return{pow_p_5_8:Kr(D,Ch,n)*t%n,b2:o}}function Hg(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Wg(t,e){const r=xf,i=_t(e*e*e,r),s=_t(i*i*e,r),n=Vg(t*s).pow_p_5_8;let o=_t(t*i*n,r);const c=_t(e*o*o,r),p=o,b=_t(o*Fh,r),w=c===t,x=c===_t(-t,r),E=c===_t(-t*Fh,r);return w&&(o=p),(x||E)&&(o=b),Dg(o,r)&&(o=_t(-o,r)),{isValid:w||x,value:o}}const Gg=sd(xf,void 0,!0),Jg={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Gg,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Kg,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:vg,randomBytes:Xu,adjustScalarBytes:Hg,uvRatio:Wg},fd=zg(Jg),Zg="EdDSA",Yg="JWT",oa=".",Ia="base64url",hd="utf8",cd="utf8",Xg=":",Qg="did",ev="key",Lh="base58btc",tv="z",rv="K36",iv=32;function Mf(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ud(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Mf(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function dd(t,e){e||(e=t.reduce((s,n)=>s+n.length,0));const r=ud(e);let i=0;for(const s of t)r.set(s,i),i+=s.length;return Mf(r)}function nv(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<t.length;s++){var n=t.charAt(s),o=n.charCodeAt(0);if(r[o]!==255)throw new TypeError(n+" is ambiguous");r[o]=s}var c=t.length,p=t.charAt(0),b=Math.log(c)/Math.log(256),w=Math.log(256)/Math.log(c);function x(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var D=0,P=0,R=0,N=S.length;R!==N&&S[R]===0;)R++,D++;for(var C=(N-R)*w+1>>>0,L=new Uint8Array(C);R!==N;){for(var B=S[R],U=0,K=C-1;(B!==0||U<P)&&K!==-1;K--,U++)B+=256*L[K]>>>0,L[K]=B%c>>>0,B=B/c>>>0;if(B!==0)throw new Error("Non-zero carry");P=U,R++}for(var k=C-P;k!==C&&L[k]===0;)k++;for(var z=p.repeat(D);k<C;++k)z+=t.charAt(L[k]);return z}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var D=0;if(S[D]!==" "){for(var P=0,R=0;S[D]===p;)P++,D++;for(var N=(S.length-D)*b+1>>>0,C=new Uint8Array(N);S[D];){var L=r[S.charCodeAt(D)];if(L===255)return;for(var B=0,U=N-1;(L!==0||B<R)&&U!==-1;U--,B++)L+=c*C[U]>>>0,C[U]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");R=B,D++}if(S[D]!==" "){for(var K=N-R;K!==N&&C[K]===0;)K++;for(var k=new Uint8Array(P+(N-K)),z=P;K!==N;)k[z++]=C[K++];return k}}}function I(S){var D=E(S);if(D)return D;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:E,decode:I}}var sv=nv,av=sv;const ld=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ov=t=>new TextEncoder().encode(t),fv=t=>new TextDecoder().decode(t);let hv=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},cv=class{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return pd(this,e)}},uv=class{constructor(e){this.decoders=e}or(e){return pd(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const pd=(t,e)=>new uv({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let dv=class{constructor(e,r,i,s){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new hv(e,r,i),this.decoder=new cv(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Aa=({name:t,prefix:e,encode:r,decode:i})=>new dv(t,e,r,i),ws=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:s}=av(r,e);return Aa({prefix:t,name:e,encode:i,decode:n=>ld(s(n))})},lv=(t,e,r,i)=>{const s={};for(let w=0;w<e.length;++w)s[e[w]]=w;let n=t.length;for(;t[n-1]==="=";)--n;const o=new Uint8Array(n*r/8|0);let c=0,p=0,b=0;for(let w=0;w<n;++w){const x=s[t[w]];if(x===void 0)throw new SyntaxError(`Non-${i} character`);p=p<<r|x,c+=r,c>=8&&(c-=8,o[b++]=255&p>>c)}if(c>=r||255&p<<8-c)throw new SyntaxError("Unexpected end of data");return o},pv=(t,e,r)=>{const i=e[e.length-1]==="=",s=(1<<r)-1;let n="",o=0,c=0;for(let p=0;p<t.length;++p)for(c=c<<8|t[p],o+=8;o>r;)o-=r,n+=e[s&c>>o];if(o&&(n+=e[s&c<<r-o]),i)for(;n.length*r&7;)n+="=";return n},Tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Aa({prefix:e,name:t,encode(s){return pv(s,i,r)},decode(s){return lv(s,i,r,t)}}),gv=Aa({prefix:"\0",name:"identity",encode:t=>fv(t),decode:t=>ov(t)});var vv=Object.freeze({__proto__:null,identity:gv});const bv=Tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mv=Object.freeze({__proto__:null,base2:bv});const yv=Tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var wv=Object.freeze({__proto__:null,base8:yv});const _v=ws({prefix:"9",name:"base10",alphabet:"0123456789"});var xv=Object.freeze({__proto__:null,base10:_v});const Mv=Tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ev=Tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Sv=Object.freeze({__proto__:null,base16:Mv,base16upper:Ev});const Iv=Tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Av=Tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Dv=Tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ov=Tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pv=Tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Rv=Tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Nv=Tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$v=Tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tv=Tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Fv=Object.freeze({__proto__:null,base32:Iv,base32upper:Av,base32pad:Dv,base32padupper:Ov,base32hex:Pv,base32hexupper:Rv,base32hexpad:Nv,base32hexpadupper:$v,base32z:Tv});const Cv=ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Lv=ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var qv=Object.freeze({__proto__:null,base36:Cv,base36upper:Lv});const Bv=ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Uv=ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var zv=Object.freeze({__proto__:null,base58btc:Bv,base58flickr:Uv});const kv=Tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jv=Tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kv=Tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vv=Tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Hv=Object.freeze({__proto__:null,base64:kv,base64pad:jv,base64url:Kv,base64urlpad:Vv});const gd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Wv=gd.reduce((t,e,r)=>(t[r]=e,t),[]),Gv=gd.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Jv(t){return t.reduce((e,r)=>(e+=Wv[r],e),"")}function Zv(t){const e=[];for(const r of t){const i=Gv[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Yv=Aa({prefix:"🚀",name:"base256emoji",encode:Jv,decode:Zv});var Xv=Object.freeze({__proto__:null,base256emoji:Yv}),Qv=vd,qh=128,eb=-128,tb=Math.pow(2,31);function vd(t,e,r){e=e||[],r=r||0;for(var i=r;t>=tb;)e[r++]=t&255|qh,t/=128;for(;t&eb;)e[r++]=t&255|qh,t>>>=7;return e[r]=t|0,vd.bytes=r-i+1,e}var rb=Vo,ib=128,Bh=127;function Vo(t,i){var r=0,i=i||0,s=0,n=i,o,c=t.length;do{if(n>=c)throw Vo.bytes=0,new RangeError("Could not decode varint");o=t[n++],r+=s<28?(o&Bh)<<s:(o&Bh)*Math.pow(2,s),s+=7}while(o>=ib);return Vo.bytes=n-i,r}var nb=Math.pow(2,7),sb=Math.pow(2,14),ab=Math.pow(2,21),ob=Math.pow(2,28),fb=Math.pow(2,35),hb=Math.pow(2,42),cb=Math.pow(2,49),ub=Math.pow(2,56),db=Math.pow(2,63),lb=function(t){return t<nb?1:t<sb?2:t<ab?3:t<ob?4:t<fb?5:t<hb?6:t<cb?7:t<ub?8:t<db?9:10},pb={encode:Qv,decode:rb,encodingLength:lb},bd=pb;const Uh=(t,e,r=0)=>(bd.encode(t,e,r),e),zh=t=>bd.encodingLength(t),Ho=(t,e)=>{const r=e.byteLength,i=zh(t),s=i+zh(r),n=new Uint8Array(s+r);return Uh(t,n,0),Uh(r,n,i),n.set(e,s),new gb(t,r,e,n)};let gb=class{constructor(e,r,i,s){this.code=e,this.size=r,this.digest=i,this.bytes=s}};const md=({name:t,code:e,encode:r})=>new vb(t,e,r);let vb=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Ho(this.code,r):r.then(i=>Ho(this.code,i))}else throw Error("Unknown type, must be binary type")}};const yd=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bb=md({name:"sha2-256",code:18,encode:yd("SHA-256")}),mb=md({name:"sha2-512",code:19,encode:yd("SHA-512")});var yb=Object.freeze({__proto__:null,sha256:bb,sha512:mb});const wd=0,wb="identity",_d=ld,_b=t=>Ho(wd,_d(t)),xb={code:wd,name:wb,encode:_d,digest:_b};var Mb=Object.freeze({__proto__:null,identity:xb});new TextEncoder,new TextDecoder;const kh={...vv,...mv,...wv,...xv,...Sv,...Fv,...qv,...zv,...Hv,...Xv};({...yb,...Mb});function xd(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const jh=xd("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ho=xd("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=ud(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Md={utf8:jh,"utf-8":jh,hex:kh.base16,latin1:ho,ascii:ho,binary:ho,...kh};function Da(t,e="utf8"){const r=Md[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Cn(t,e="utf8"){const r=Md[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mf(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Kh(t){return In(Da(Cn(t,Ia),hd))}function fa(t){return Da(Cn(tn(t),hd),Ia)}function Ed(t){const e=Cn(rv,Lh),r=tv+Da(dd([e,t]),Lh);return[Qg,ev,r].join(Xg)}function Eb(t){return Da(t,Ia)}function Sb(t){return Cn(t,Ia)}function Ib(t){return Cn([fa(t.header),fa(t.payload)].join(oa),cd)}function Ab(t){return[fa(t.header),fa(t.payload),Eb(t.signature)].join(oa)}function Wo(t){const e=t.split(oa),r=Kh(e[0]),i=Kh(e[1]),s=Sb(e[2]),n=Cn(e.slice(0,2).join(oa),cd);return{header:r,payload:i,signature:s,data:n}}function Vh(t=Xu(iv)){const e=fd.getPublicKey(t);return{secretKey:dd([t,e]),publicKey:e}}async function Db(t,e,r,i,s=W.fromMiliseconds(Date.now())){const n={alg:Zg,typ:Yg},o=Ed(i.publicKey),c=s+r,p={iss:o,sub:t,aud:e,iat:s,exp:c},b=Ib({header:n,payload:p}),w=fd.sign(b,i.secretKey.slice(0,32));return Ab({header:n,payload:p,signature:w})}var Hh=function(t,e,r){if(r||arguments.length===2)for(var i=0,s=e.length,n;i<s;i++)(n||!(i in e))&&(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},Ob=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),Pb=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Rb=function(){function t(e,r,i,s){this.name=e,this.version=r,this.os=i,this.bot=s,this.type="bot-device"}return t}(),Nb=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),$b=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Tb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Fb=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Wh=3,Cb=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Tb]],Gh=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Lb(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new $b:typeof navigator<"u"?Bb(navigator.userAgent):zb()}function qb(t){return t!==""&&Cb.reduce(function(e,r){var i=r[0],s=r[1];if(e)return e;var n=s.exec(t);return!!n&&[i,n]},!1)}function Bb(t){var e=qb(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Nb;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<Wh&&(s=Hh(Hh([],s,!0),kb(Wh-s.length),!0)):s=[];var n=s.join("."),o=Ub(t),c=Fb.exec(t);return c&&c[1]?new Rb(r,n,o,c[1]):new Ob(r,n,o)}function Ub(t){for(var e=0,r=Gh.length;e<r;e++){var i=Gh[e],s=i[0],n=i[1],o=n.exec(t);if(o)return s}return null}function zb(){var t=typeof process<"u"&&process.version;return t?new Pb(process.version.slice(1)):null}function kb(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot.getLocalStorage=ot.getLocalStorageOrThrow=ot.getCrypto=ot.getCryptoOrThrow=Sd=ot.getLocation=ot.getLocationOrThrow=Ef=ot.getNavigator=ot.getNavigatorOrThrow=_s=ot.getDocument=ot.getDocumentOrThrow=ot.getFromWindowOrThrow=ot.getFromWindow=void 0;function fn(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}ot.getFromWindow=fn;function Ln(t){const e=fn(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}ot.getFromWindowOrThrow=Ln;function jb(){return Ln("document")}ot.getDocumentOrThrow=jb;function Kb(){return fn("document")}var _s=ot.getDocument=Kb;function Vb(){return Ln("navigator")}ot.getNavigatorOrThrow=Vb;function Hb(){return fn("navigator")}var Ef=ot.getNavigator=Hb;function Wb(){return Ln("location")}ot.getLocationOrThrow=Wb;function Gb(){return fn("location")}var Sd=ot.getLocation=Gb;function Jb(){return Ln("crypto")}ot.getCryptoOrThrow=Jb;function Zb(){return fn("crypto")}ot.getCrypto=Zb;function Yb(){return Ln("localStorage")}ot.getLocalStorageOrThrow=Yb;function Xb(){return fn("localStorage")}ot.getLocalStorage=Xb;var Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});var Id=Sf.getWindowMetadata=void 0;const Jh=ot;function Qb(){let t,e;try{t=Jh.getDocumentOrThrow(),e=Jh.getLocationOrThrow()}catch{return null}function r(){const x=t.getElementsByTagName("link"),E=[];for(let I=0;I<x.length;I++){const S=x[I],D=S.getAttribute("rel");if(D&&D.toLowerCase().indexOf("icon")>-1){const P=S.getAttribute("href");if(P)if(P.toLowerCase().indexOf("https:")===-1&&P.toLowerCase().indexOf("http:")===-1&&P.indexOf("//")!==0){let R=e.protocol+"//"+e.host;if(P.indexOf("/")===0)R+=P;else{const N=e.pathname.split("/");N.pop();const C=N.join("/");R+=C+"/"+P}E.push(R)}else if(P.indexOf("//")===0){const R=e.protocol+P;E.push(R)}else E.push(P)}}return E}function i(...x){const E=t.getElementsByTagName("meta");for(let I=0;I<E.length;I++){const S=E[I],D=["itemprop","property","name"].map(P=>S.getAttribute(P)).filter(P=>P?x.includes(P):!1);if(D.length&&D){const P=S.getAttribute("content");if(P)return P}}return""}function s(){let x=i("name","og:site_name","og:title","twitter:title");return x||(x=t.title),x}function n(){return i("description","og:description","twitter:description","keywords")}const o=s(),c=n(),p=e.origin,b=r();return{description:c,url:p,icons:b,name:o}}Id=Sf.getWindowMetadata=Qb;const em="logger/5.7.0";let Zh=!1,Yh=!1;const Xs={debug:1,default:2,info:2,warning:3,error:4,off:5};let Xh=Xs.default,co=null;function tm(){try{const t=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{t.push(e)}}),t.length)throw new Error("missing "+t.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(t){return t.message}return null}const Qh=tm();var Go;(function(t){t.DEBUG="DEBUG",t.INFO="INFO",t.WARNING="WARNING",t.ERROR="ERROR",t.OFF="OFF"})(Go||(Go={}));var Br;(function(t){t.UNKNOWN_ERROR="UNKNOWN_ERROR",t.NOT_IMPLEMENTED="NOT_IMPLEMENTED",t.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.TIMEOUT="TIMEOUT",t.BUFFER_OVERRUN="BUFFER_OVERRUN",t.NUMERIC_FAULT="NUMERIC_FAULT",t.MISSING_NEW="MISSING_NEW",t.INVALID_ARGUMENT="INVALID_ARGUMENT",t.MISSING_ARGUMENT="MISSING_ARGUMENT",t.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",t.CALL_EXCEPTION="CALL_EXCEPTION",t.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",t.NONCE_EXPIRED="NONCE_EXPIRED",t.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",t.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",t.TRANSACTION_REPLACED="TRANSACTION_REPLACED",t.ACTION_REJECTED="ACTION_REJECTED"})(Br||(Br={}));const ec="0123456789abcdef";class ct{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,r){const i=e.toLowerCase();Xs[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Xh>Xs[i])&&console.log.apply(console,r)}debug(...e){this._log(ct.levels.DEBUG,e)}info(...e){this._log(ct.levels.INFO,e)}warn(...e){this._log(ct.levels.WARNING,e)}makeError(e,r,i){if(Yh)return this.makeError("censored error",r,{});r||(r=ct.errors.UNKNOWN_ERROR),i||(i={});const s=[];Object.keys(i).forEach(p=>{const b=i[p];try{if(b instanceof Uint8Array){let w="";for(let x=0;x<b.length;x++)w+=ec[b[x]>>4],w+=ec[b[x]&15];s.push(p+"=Uint8Array(0x"+w+")")}else s.push(p+"="+JSON.stringify(b))}catch{s.push(p+"="+JSON.stringify(i[p].toString()))}}),s.push(`code=${r}`),s.push(`version=${this.version}`);const n=e;let o="";switch(r){case Br.NUMERIC_FAULT:{o="NUMERIC_FAULT";const p=e;switch(p){case"overflow":case"underflow":case"division-by-zero":o+="-"+p;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result";break}break}case Br.CALL_EXCEPTION:case Br.INSUFFICIENT_FUNDS:case Br.MISSING_NEW:case Br.NONCE_EXPIRED:case Br.REPLACEMENT_UNDERPRICED:case Br.TRANSACTION_REPLACED:case Br.UNPREDICTABLE_GAS_LIMIT:o=r;break}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),s.length&&(e+=" ("+s.join(", ")+")");const c=new Error(e);return c.reason=n,c.code=r,Object.keys(i).forEach(function(p){c[p]=i[p]}),c}throwError(e,r,i){throw this.makeError(e,r,i)}throwArgumentError(e,r,i){return this.throwError(e,ct.errors.INVALID_ARGUMENT,{argument:r,value:i})}assert(e,r,i,s){e||this.throwError(r,i,s)}assertArgument(e,r,i,s){e||this.throwArgumentError(r,i,s)}checkNormalize(e){Qh&&this.throwError("platform missing String.prototype.normalize",ct.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Qh})}checkSafeUint53(e,r){typeof e=="number"&&(r==null&&(r="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(r,ct.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(r,ct.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,r,i){i?i=": "+i:i="",e<r&&this.throwError("missing argument"+i,ct.errors.MISSING_ARGUMENT,{count:e,expectedCount:r}),e>r&&this.throwError("too many arguments"+i,ct.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:r})}checkNew(e,r){(e===Object||e==null)&&this.throwError("missing new",ct.errors.MISSING_NEW,{name:r.name})}checkAbstract(e,r){e===r?this.throwError("cannot instantiate abstract class "+JSON.stringify(r.name)+" directly; use a sub-class",ct.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",ct.errors.MISSING_NEW,{name:r.name})}static globalLogger(){return co||(co=new ct(em)),co}static setCensorship(e,r){if(!e&&r&&this.globalLogger().throwError("cannot permanently disable censorship",ct.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Zh){if(!e)return;this.globalLogger().throwError("error censorship permanent",ct.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Yh=!!e,Zh=!!r}static setLogLevel(e){const r=Xs[e.toLowerCase()];if(r==null){ct.globalLogger().warn("invalid log level - "+e);return}Xh=r}static from(e){return new ct(e)}}ct.errors=Br;ct.levels=Go;const rm="bytes/5.7.0",gt=new ct(rm);function Ad(t){return!!t.toHexString}function hs(t){return t.slice||(t.slice=function(){const e=Array.prototype.slice.call(arguments);return hs(new Uint8Array(Array.prototype.slice.apply(t,e)))}),t}function im(t){return Zr(t)&&!(t.length%2)||If(t)}function tc(t){return typeof t=="number"&&t==t&&t%1===0}function If(t){if(t==null)return!1;if(t.constructor===Uint8Array)return!0;if(typeof t=="string"||!tc(t.length)||t.length<0)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(!tc(r)||r<0||r>=256)return!1}return!0}function St(t,e){if(e||(e={}),typeof t=="number"){gt.checkSafeUint53(t,"invalid arrayify value");const r=[];for(;t;)r.unshift(t&255),t=parseInt(String(t/256));return r.length===0&&r.push(0),hs(new Uint8Array(r))}if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Ad(t)&&(t=t.toHexString()),Zr(t)){let r=t.substring(2);r.length%2&&(e.hexPad==="left"?r="0"+r:e.hexPad==="right"?r+="0":gt.throwArgumentError("hex data is odd-length","value",t));const i=[];for(let s=0;s<r.length;s+=2)i.push(parseInt(r.substring(s,s+2),16));return hs(new Uint8Array(i))}return If(t)?hs(new Uint8Array(t)):gt.throwArgumentError("invalid arrayify value","value",t)}function nm(t,e){t=St(t),t.length>e&&gt.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(e);return r.set(t,e-t.length),hs(r)}function Zr(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||e&&t.length!==2+2*e)}const uo="0123456789abcdef";function gr(t,e){if(e||(e={}),typeof t=="number"){gt.checkSafeUint53(t,"invalid hexlify value");let r="";for(;t;)r=uo[t&15]+r,t=Math.floor(t/16);return r.length?(r.length%2&&(r="0"+r),"0x"+r):"0x00"}if(typeof t=="bigint")return t=t.toString(16),t.length%2?"0x0"+t:"0x"+t;if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Ad(t))return t.toHexString();if(Zr(t))return t.length%2&&(e.hexPad==="left"?t="0x0"+t.substring(2):e.hexPad==="right"?t+="0":gt.throwArgumentError("hex data is odd-length","value",t)),t.toLowerCase();if(If(t)){let r="0x";for(let i=0;i<t.length;i++){let s=t[i];r+=uo[(s&240)>>4]+uo[s&15]}return r}return gt.throwArgumentError("invalid hexlify value","value",t)}function sm(t){if(typeof t!="string")t=gr(t);else if(!Zr(t)||t.length%2)return null;return(t.length-2)/2}function rc(t,e,r){return typeof t!="string"?t=gr(t):(!Zr(t)||t.length%2)&&gt.throwArgumentError("invalid hexData","value",t),e=2+2*e,"0x"+t.substring(e)}function Sn(t,e){for(typeof t!="string"?t=gr(t):Zr(t)||gt.throwArgumentError("invalid hex string","value",t),t.length>2*e+2&&gt.throwArgumentError("value out of range","value",arguments[1]);t.length<2*e+2;)t="0x0"+t.substring(2);return t}function Dd(t){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(im(t)){let r=St(t);r.length===64?(e.v=27+(r[32]>>7),r[32]&=127,e.r=gr(r.slice(0,32)),e.s=gr(r.slice(32,64))):r.length===65?(e.r=gr(r.slice(0,32)),e.s=gr(r.slice(32,64)),e.v=r[64]):gt.throwArgumentError("invalid signature string","signature",t),e.v<27&&(e.v===0||e.v===1?e.v+=27:gt.throwArgumentError("signature invalid v byte","signature",t)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(r[32]|=128),e._vs=gr(r.slice(32,64))}else{if(e.r=t.r,e.s=t.s,e.v=t.v,e.recoveryParam=t.recoveryParam,e._vs=t._vs,e._vs!=null){const s=nm(St(e._vs),32);e._vs=gr(s);const n=s[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=n:e.recoveryParam!==n&&gt.throwArgumentError("signature recoveryParam mismatch _vs","signature",t),s[0]&=127;const o=gr(s);e.s==null?e.s=o:e.s!==o&&gt.throwArgumentError("signature v mismatch _vs","signature",t)}if(e.recoveryParam==null)e.v==null?gt.throwArgumentError("signature missing v and recoveryParam","signature",t):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const s=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==s&&gt.throwArgumentError("signature recoveryParam mismatch v","signature",t)}e.r==null||!Zr(e.r)?gt.throwArgumentError("signature missing or invalid r","signature",t):e.r=Sn(e.r,32),e.s==null||!Zr(e.s)?gt.throwArgumentError("signature missing or invalid s","signature",t):e.s=Sn(e.s,32);const r=St(e.s);r[0]>=128&&gt.throwArgumentError("signature s out of range","signature",t),e.recoveryParam&&(r[0]|=128);const i=gr(r);e._vs&&(Zr(e._vs)||gt.throwArgumentError("signature invalid _vs","signature",t),e._vs=Sn(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&gt.throwArgumentError("signature _vs mismatch v and s","signature",t)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}var Af={exports:{}};Af.exports;(function(t){(function(e,r){function i(d,a){if(!d)throw new Error(a||"Assertion failed")}function s(d,a){d.super_=a;var f=function(){};f.prototype=a.prototype,d.prototype=new f,d.prototype.constructor=d}function n(d,a,f){if(n.isBN(d))return d;this.negative=0,this.words=null,this.length=0,this.red=null,d!==null&&((a==="le"||a==="be")&&(f=a,a=10),this._init(d||0,a||10,f||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=_a.Buffer}catch{}n.isBN=function(a){return a instanceof n?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===n.wordSize&&Array.isArray(a.words)},n.max=function(a,f){return a.cmp(f)>0?a:f},n.min=function(a,f){return a.cmp(f)<0?a:f},n.prototype._init=function(a,f,u){if(typeof a=="number")return this._initNumber(a,f,u);if(typeof a=="object")return this._initArray(a,f,u);f==="hex"&&(f=16),i(f===(f|0)&&f>=2&&f<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(f===16?this._parseHex(a,v,u):(this._parseBase(a,f,v),u==="le"&&this._initArray(this.toArray(),f,u)))},n.prototype._initNumber=function(a,f,u){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(i(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),u==="le"&&this._initArray(this.toArray(),f,u)},n.prototype._initArray=function(a,f,u){if(i(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y,m,l=0;if(u==="be")for(v=a.length-1,y=0;v>=0;v-=3)m=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);else if(u==="le")for(v=0,y=0;v<a.length;v+=3)m=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);return this._strip()};function c(d,a){var f=d.charCodeAt(a);if(f>=48&&f<=57)return f-48;if(f>=65&&f<=70)return f-55;if(f>=97&&f<=102)return f-87;i(!1,"Invalid character in "+d)}function p(d,a,f){var u=c(d,f);return f-1>=a&&(u|=c(d,f-1)<<4),u}n.prototype._parseHex=function(a,f,u){this.length=Math.ceil((a.length-f)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y=0,m=0,l;if(u==="be")for(v=a.length-1;v>=f;v-=2)l=p(a,f,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8;else{var g=a.length-f;for(v=g%2===0?f+1:f;v<a.length;v+=2)l=p(a,f,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8}this._strip()};function b(d,a,f,u){for(var v=0,y=0,m=Math.min(d.length,f),l=a;l<m;l++){var g=d.charCodeAt(l)-48;v*=u,g>=49?y=g-49+10:g>=17?y=g-17+10:y=g,i(g>=0&&y<u,"Invalid character"),v+=y}return v}n.prototype._parseBase=function(a,f,u){this.words=[0],this.length=1;for(var v=0,y=1;y<=67108863;y*=f)v++;v--,y=y/f|0;for(var m=a.length-u,l=m%v,g=Math.min(m,m-l)+u,h=0,M=u;M<g;M+=v)h=b(a,M,M+v,f),this.imuln(y),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(l!==0){var T=1;for(h=b(a,M,a.length,f),M=0;M<l;M++)T*=f;this.imuln(T),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this._strip()},n.prototype.copy=function(a){a.words=new Array(this.length);for(var f=0;f<this.length;f++)a.words[f]=this.words[f];a.length=this.length,a.negative=this.negative,a.red=this.red};function w(d,a){d.words=a.words,d.length=a.length,d.negative=a.negative,d.red=a.red}if(n.prototype._move=function(a){w(a,this)},n.prototype.clone=function(){var a=new n(null);return this.copy(a),a},n.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{n.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{n.prototype.inspect=x}else n.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var E=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],S=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(a,f){a=a||10,f=f|0||1;var u;if(a===16||a==="hex"){u="";for(var v=0,y=0,m=0;m<this.length;m++){var l=this.words[m],g=((l<<v|y)&16777215).toString(16);y=l>>>24-v&16777215,v+=2,v>=26&&(v-=26,m--),y!==0||m!==this.length-1?u=E[6-g.length]+g+u:u=g+u}for(y!==0&&(u=y.toString(16)+u);u.length%f!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}if(a===(a|0)&&a>=2&&a<=36){var h=I[a],M=S[a];u="";var T=this.clone();for(T.negative=0;!T.isZero();){var $=T.modrn(M).toString(a);T=T.idivn(M),T.isZero()?u=$+u:u=E[h-$.length]+$+u}for(this.isZero()&&(u="0"+u);u.length%f!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},n.prototype.toJSON=function(){return this.toString(16,2)},o&&(n.prototype.toBuffer=function(a,f){return this.toArrayLike(o,a,f)}),n.prototype.toArray=function(a,f){return this.toArrayLike(Array,a,f)};var D=function(a,f){return a.allocUnsafe?a.allocUnsafe(f):new a(f)};n.prototype.toArrayLike=function(a,f,u){this._strip();var v=this.byteLength(),y=u||Math.max(1,v);i(v<=y,"byte array longer than desired length"),i(y>0,"Requested array length <= 0");var m=D(a,y),l=f==="le"?"LE":"BE";return this["_toArrayLike"+l](m,v),m},n.prototype._toArrayLikeLE=function(a,f){for(var u=0,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[u++]=l&255,u<a.length&&(a[u++]=l>>8&255),u<a.length&&(a[u++]=l>>16&255),m===6?(u<a.length&&(a[u++]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(u<a.length)for(a[u++]=v;u<a.length;)a[u++]=0},n.prototype._toArrayLikeBE=function(a,f){for(var u=a.length-1,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[u--]=l&255,u>=0&&(a[u--]=l>>8&255),u>=0&&(a[u--]=l>>16&255),m===6?(u>=0&&(a[u--]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(u>=0)for(a[u--]=v;u>=0;)a[u--]=0},Math.clz32?n.prototype._countBits=function(a){return 32-Math.clz32(a)}:n.prototype._countBits=function(a){var f=a,u=0;return f>=4096&&(u+=13,f>>>=13),f>=64&&(u+=7,f>>>=7),f>=8&&(u+=4,f>>>=4),f>=2&&(u+=2,f>>>=2),u+f},n.prototype._zeroBits=function(a){if(a===0)return 26;var f=a,u=0;return f&8191||(u+=13,f>>>=13),f&127||(u+=7,f>>>=7),f&15||(u+=4,f>>>=4),f&3||(u+=2,f>>>=2),f&1||u++,u},n.prototype.bitLength=function(){var a=this.words[this.length-1],f=this._countBits(a);return(this.length-1)*26+f};function P(d){for(var a=new Array(d.bitLength()),f=0;f<a.length;f++){var u=f/26|0,v=f%26;a[f]=d.words[u]>>>v&1}return a}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,f=0;f<this.length;f++){var u=this._zeroBits(this.words[f]);if(a+=u,u!==26)break}return a},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},n.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var f=0;f<a.length;f++)this.words[f]=this.words[f]|a.words[f];return this._strip()},n.prototype.ior=function(a){return i((this.negative|a.negative)===0),this.iuor(a)},n.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},n.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},n.prototype.iuand=function(a){var f;this.length>a.length?f=a:f=this;for(var u=0;u<f.length;u++)this.words[u]=this.words[u]&a.words[u];return this.length=f.length,this._strip()},n.prototype.iand=function(a){return i((this.negative|a.negative)===0),this.iuand(a)},n.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},n.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},n.prototype.iuxor=function(a){var f,u;this.length>a.length?(f=this,u=a):(f=a,u=this);for(var v=0;v<u.length;v++)this.words[v]=f.words[v]^u.words[v];if(this!==f)for(;v<f.length;v++)this.words[v]=f.words[v];return this.length=f.length,this._strip()},n.prototype.ixor=function(a){return i((this.negative|a.negative)===0),this.iuxor(a)},n.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},n.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},n.prototype.inotn=function(a){i(typeof a=="number"&&a>=0);var f=Math.ceil(a/26)|0,u=a%26;this._expand(f),u>0&&f--;for(var v=0;v<f;v++)this.words[v]=~this.words[v]&67108863;return u>0&&(this.words[v]=~this.words[v]&67108863>>26-u),this._strip()},n.prototype.notn=function(a){return this.clone().inotn(a)},n.prototype.setn=function(a,f){i(typeof a=="number"&&a>=0);var u=a/26|0,v=a%26;return this._expand(u+1),f?this.words[u]=this.words[u]|1<<v:this.words[u]=this.words[u]&~(1<<v),this._strip()},n.prototype.iadd=function(a){var f;if(this.negative!==0&&a.negative===0)return this.negative=0,f=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,f=this.isub(a),a.negative=1,f._normSign();var u,v;this.length>a.length?(u=this,v=a):(u=a,v=this);for(var y=0,m=0;m<v.length;m++)f=(u.words[m]|0)+(v.words[m]|0)+y,this.words[m]=f&67108863,y=f>>>26;for(;y!==0&&m<u.length;m++)f=(u.words[m]|0)+y,this.words[m]=f&67108863,y=f>>>26;if(this.length=u.length,y!==0)this.words[this.length]=y,this.length++;else if(u!==this)for(;m<u.length;m++)this.words[m]=u.words[m];return this},n.prototype.add=function(a){var f;return a.negative!==0&&this.negative===0?(a.negative=0,f=this.sub(a),a.negative^=1,f):a.negative===0&&this.negative!==0?(this.negative=0,f=a.sub(this),this.negative=1,f):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},n.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var f=this.iadd(a);return a.negative=1,f._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var u=this.cmp(a);if(u===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,y;u>0?(v=this,y=a):(v=a,y=this);for(var m=0,l=0;l<y.length;l++)f=(v.words[l]|0)-(y.words[l]|0)+m,m=f>>26,this.words[l]=f&67108863;for(;m!==0&&l<v.length;l++)f=(v.words[l]|0)+m,m=f>>26,this.words[l]=f&67108863;if(m===0&&l<v.length&&v!==this)for(;l<v.length;l++)this.words[l]=v.words[l];return this.length=Math.max(this.length,l),v!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(a){return this.clone().isub(a)};function R(d,a,f){f.negative=a.negative^d.negative;var u=d.length+a.length|0;f.length=u,u=u-1|0;var v=d.words[0]|0,y=a.words[0]|0,m=v*y,l=m&67108863,g=m/67108864|0;f.words[0]=l;for(var h=1;h<u;h++){for(var M=g>>>26,T=g&67108863,$=Math.min(h,a.length-1),q=Math.max(0,h-d.length+1);q<=$;q++){var G=h-q|0;v=d.words[G]|0,y=a.words[q]|0,m=v*y+T,M+=m/67108864|0,T=m&67108863}f.words[h]=T|0,g=M|0}return g!==0?f.words[h]=g|0:f.length--,f._strip()}var N=function(a,f,u){var v=a.words,y=f.words,m=u.words,l=0,g,h,M,T=v[0]|0,$=T&8191,q=T>>>13,G=v[1]|0,H=G&8191,V=G>>>13,Oe=v[2]|0,ge=Oe&8191,Y=Oe>>>13,Be=v[3]|0,be=Be&8191,ie=Be>>>13,He=v[4]|0,Se=He&8191,ne=He>>>13,je=v[5]|0,we=je&8191,ee=je>>>13,Ke=v[6]|0,_e=Ke&8191,re=Ke>>>13,Ve=v[7]|0,xe=Ve&8191,Q=Ve>>>13,ze=v[8]|0,Me=ze&8191,Z=ze>>>13,Ze=v[9]|0,Ae=Ze&8191,he=Ze>>>13,Ye=y[0]|0,Ee=Ye&8191,oe=Ye>>>13,Xe=y[1]|0,Pe=Xe&8191,X=Xe>>>13,Qe=y[2]|0,Re=Qe&8191,ce=Qe>>>13,We=y[3]|0,ye=We&8191,se=We>>>13,Ge=y[4]|0,Ie=Ge&8191,te=Ge>>>13,et=y[5]|0,Ne=et&8191,ue=et>>>13,tt=y[6]|0,$e=tt&8191,fe=tt>>>13,Je=y[7]|0,me=Je&8191,de=Je>>>13,rt=y[8]|0,Te=rt&8191,le=rt>>>13,it=y[9]|0,ve=it&8191,De=it>>>13;u.negative=a.negative^f.negative,u.length=19,g=Math.imul($,Ee),h=Math.imul($,oe),h=h+Math.imul(q,Ee)|0,M=Math.imul(q,oe);var Qt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,g=Math.imul(H,Ee),h=Math.imul(H,oe),h=h+Math.imul(V,Ee)|0,M=Math.imul(V,oe),g=g+Math.imul($,Pe)|0,h=h+Math.imul($,X)|0,h=h+Math.imul(q,Pe)|0,M=M+Math.imul(q,X)|0;var er=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(er>>>26)|0,er&=67108863,g=Math.imul(ge,Ee),h=Math.imul(ge,oe),h=h+Math.imul(Y,Ee)|0,M=Math.imul(Y,oe),g=g+Math.imul(H,Pe)|0,h=h+Math.imul(H,X)|0,h=h+Math.imul(V,Pe)|0,M=M+Math.imul(V,X)|0,g=g+Math.imul($,Re)|0,h=h+Math.imul($,ce)|0,h=h+Math.imul(q,Re)|0,M=M+Math.imul(q,ce)|0;var tr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(tr>>>26)|0,tr&=67108863,g=Math.imul(be,Ee),h=Math.imul(be,oe),h=h+Math.imul(ie,Ee)|0,M=Math.imul(ie,oe),g=g+Math.imul(ge,Pe)|0,h=h+Math.imul(ge,X)|0,h=h+Math.imul(Y,Pe)|0,M=M+Math.imul(Y,X)|0,g=g+Math.imul(H,Re)|0,h=h+Math.imul(H,ce)|0,h=h+Math.imul(V,Re)|0,M=M+Math.imul(V,ce)|0,g=g+Math.imul($,ye)|0,h=h+Math.imul($,se)|0,h=h+Math.imul(q,ye)|0,M=M+Math.imul(q,se)|0;var rr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(rr>>>26)|0,rr&=67108863,g=Math.imul(Se,Ee),h=Math.imul(Se,oe),h=h+Math.imul(ne,Ee)|0,M=Math.imul(ne,oe),g=g+Math.imul(be,Pe)|0,h=h+Math.imul(be,X)|0,h=h+Math.imul(ie,Pe)|0,M=M+Math.imul(ie,X)|0,g=g+Math.imul(ge,Re)|0,h=h+Math.imul(ge,ce)|0,h=h+Math.imul(Y,Re)|0,M=M+Math.imul(Y,ce)|0,g=g+Math.imul(H,ye)|0,h=h+Math.imul(H,se)|0,h=h+Math.imul(V,ye)|0,M=M+Math.imul(V,se)|0,g=g+Math.imul($,Ie)|0,h=h+Math.imul($,te)|0,h=h+Math.imul(q,Ie)|0,M=M+Math.imul(q,te)|0;var yt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(yt>>>26)|0,yt&=67108863,g=Math.imul(we,Ee),h=Math.imul(we,oe),h=h+Math.imul(ee,Ee)|0,M=Math.imul(ee,oe),g=g+Math.imul(Se,Pe)|0,h=h+Math.imul(Se,X)|0,h=h+Math.imul(ne,Pe)|0,M=M+Math.imul(ne,X)|0,g=g+Math.imul(be,Re)|0,h=h+Math.imul(be,ce)|0,h=h+Math.imul(ie,Re)|0,M=M+Math.imul(ie,ce)|0,g=g+Math.imul(ge,ye)|0,h=h+Math.imul(ge,se)|0,h=h+Math.imul(Y,ye)|0,M=M+Math.imul(Y,se)|0,g=g+Math.imul(H,Ie)|0,h=h+Math.imul(H,te)|0,h=h+Math.imul(V,Ie)|0,M=M+Math.imul(V,te)|0,g=g+Math.imul($,Ne)|0,h=h+Math.imul($,ue)|0,h=h+Math.imul(q,Ne)|0,M=M+Math.imul(q,ue)|0;var ir=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ir>>>26)|0,ir&=67108863,g=Math.imul(_e,Ee),h=Math.imul(_e,oe),h=h+Math.imul(re,Ee)|0,M=Math.imul(re,oe),g=g+Math.imul(we,Pe)|0,h=h+Math.imul(we,X)|0,h=h+Math.imul(ee,Pe)|0,M=M+Math.imul(ee,X)|0,g=g+Math.imul(Se,Re)|0,h=h+Math.imul(Se,ce)|0,h=h+Math.imul(ne,Re)|0,M=M+Math.imul(ne,ce)|0,g=g+Math.imul(be,ye)|0,h=h+Math.imul(be,se)|0,h=h+Math.imul(ie,ye)|0,M=M+Math.imul(ie,se)|0,g=g+Math.imul(ge,Ie)|0,h=h+Math.imul(ge,te)|0,h=h+Math.imul(Y,Ie)|0,M=M+Math.imul(Y,te)|0,g=g+Math.imul(H,Ne)|0,h=h+Math.imul(H,ue)|0,h=h+Math.imul(V,Ne)|0,M=M+Math.imul(V,ue)|0,g=g+Math.imul($,$e)|0,h=h+Math.imul($,fe)|0,h=h+Math.imul(q,$e)|0,M=M+Math.imul(q,fe)|0;var nr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(nr>>>26)|0,nr&=67108863,g=Math.imul(xe,Ee),h=Math.imul(xe,oe),h=h+Math.imul(Q,Ee)|0,M=Math.imul(Q,oe),g=g+Math.imul(_e,Pe)|0,h=h+Math.imul(_e,X)|0,h=h+Math.imul(re,Pe)|0,M=M+Math.imul(re,X)|0,g=g+Math.imul(we,Re)|0,h=h+Math.imul(we,ce)|0,h=h+Math.imul(ee,Re)|0,M=M+Math.imul(ee,ce)|0,g=g+Math.imul(Se,ye)|0,h=h+Math.imul(Se,se)|0,h=h+Math.imul(ne,ye)|0,M=M+Math.imul(ne,se)|0,g=g+Math.imul(be,Ie)|0,h=h+Math.imul(be,te)|0,h=h+Math.imul(ie,Ie)|0,M=M+Math.imul(ie,te)|0,g=g+Math.imul(ge,Ne)|0,h=h+Math.imul(ge,ue)|0,h=h+Math.imul(Y,Ne)|0,M=M+Math.imul(Y,ue)|0,g=g+Math.imul(H,$e)|0,h=h+Math.imul(H,fe)|0,h=h+Math.imul(V,$e)|0,M=M+Math.imul(V,fe)|0,g=g+Math.imul($,me)|0,h=h+Math.imul($,de)|0,h=h+Math.imul(q,me)|0,M=M+Math.imul(q,de)|0;var sr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(sr>>>26)|0,sr&=67108863,g=Math.imul(Me,Ee),h=Math.imul(Me,oe),h=h+Math.imul(Z,Ee)|0,M=Math.imul(Z,oe),g=g+Math.imul(xe,Pe)|0,h=h+Math.imul(xe,X)|0,h=h+Math.imul(Q,Pe)|0,M=M+Math.imul(Q,X)|0,g=g+Math.imul(_e,Re)|0,h=h+Math.imul(_e,ce)|0,h=h+Math.imul(re,Re)|0,M=M+Math.imul(re,ce)|0,g=g+Math.imul(we,ye)|0,h=h+Math.imul(we,se)|0,h=h+Math.imul(ee,ye)|0,M=M+Math.imul(ee,se)|0,g=g+Math.imul(Se,Ie)|0,h=h+Math.imul(Se,te)|0,h=h+Math.imul(ne,Ie)|0,M=M+Math.imul(ne,te)|0,g=g+Math.imul(be,Ne)|0,h=h+Math.imul(be,ue)|0,h=h+Math.imul(ie,Ne)|0,M=M+Math.imul(ie,ue)|0,g=g+Math.imul(ge,$e)|0,h=h+Math.imul(ge,fe)|0,h=h+Math.imul(Y,$e)|0,M=M+Math.imul(Y,fe)|0,g=g+Math.imul(H,me)|0,h=h+Math.imul(H,de)|0,h=h+Math.imul(V,me)|0,M=M+Math.imul(V,de)|0,g=g+Math.imul($,Te)|0,h=h+Math.imul($,le)|0,h=h+Math.imul(q,Te)|0,M=M+Math.imul(q,le)|0;var ar=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ar>>>26)|0,ar&=67108863,g=Math.imul(Ae,Ee),h=Math.imul(Ae,oe),h=h+Math.imul(he,Ee)|0,M=Math.imul(he,oe),g=g+Math.imul(Me,Pe)|0,h=h+Math.imul(Me,X)|0,h=h+Math.imul(Z,Pe)|0,M=M+Math.imul(Z,X)|0,g=g+Math.imul(xe,Re)|0,h=h+Math.imul(xe,ce)|0,h=h+Math.imul(Q,Re)|0,M=M+Math.imul(Q,ce)|0,g=g+Math.imul(_e,ye)|0,h=h+Math.imul(_e,se)|0,h=h+Math.imul(re,ye)|0,M=M+Math.imul(re,se)|0,g=g+Math.imul(we,Ie)|0,h=h+Math.imul(we,te)|0,h=h+Math.imul(ee,Ie)|0,M=M+Math.imul(ee,te)|0,g=g+Math.imul(Se,Ne)|0,h=h+Math.imul(Se,ue)|0,h=h+Math.imul(ne,Ne)|0,M=M+Math.imul(ne,ue)|0,g=g+Math.imul(be,$e)|0,h=h+Math.imul(be,fe)|0,h=h+Math.imul(ie,$e)|0,M=M+Math.imul(ie,fe)|0,g=g+Math.imul(ge,me)|0,h=h+Math.imul(ge,de)|0,h=h+Math.imul(Y,me)|0,M=M+Math.imul(Y,de)|0,g=g+Math.imul(H,Te)|0,h=h+Math.imul(H,le)|0,h=h+Math.imul(V,Te)|0,M=M+Math.imul(V,le)|0,g=g+Math.imul($,ve)|0,h=h+Math.imul($,De)|0,h=h+Math.imul(q,ve)|0,M=M+Math.imul(q,De)|0;var or=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(or>>>26)|0,or&=67108863,g=Math.imul(Ae,Pe),h=Math.imul(Ae,X),h=h+Math.imul(he,Pe)|0,M=Math.imul(he,X),g=g+Math.imul(Me,Re)|0,h=h+Math.imul(Me,ce)|0,h=h+Math.imul(Z,Re)|0,M=M+Math.imul(Z,ce)|0,g=g+Math.imul(xe,ye)|0,h=h+Math.imul(xe,se)|0,h=h+Math.imul(Q,ye)|0,M=M+Math.imul(Q,se)|0,g=g+Math.imul(_e,Ie)|0,h=h+Math.imul(_e,te)|0,h=h+Math.imul(re,Ie)|0,M=M+Math.imul(re,te)|0,g=g+Math.imul(we,Ne)|0,h=h+Math.imul(we,ue)|0,h=h+Math.imul(ee,Ne)|0,M=M+Math.imul(ee,ue)|0,g=g+Math.imul(Se,$e)|0,h=h+Math.imul(Se,fe)|0,h=h+Math.imul(ne,$e)|0,M=M+Math.imul(ne,fe)|0,g=g+Math.imul(be,me)|0,h=h+Math.imul(be,de)|0,h=h+Math.imul(ie,me)|0,M=M+Math.imul(ie,de)|0,g=g+Math.imul(ge,Te)|0,h=h+Math.imul(ge,le)|0,h=h+Math.imul(Y,Te)|0,M=M+Math.imul(Y,le)|0,g=g+Math.imul(H,ve)|0,h=h+Math.imul(H,De)|0,h=h+Math.imul(V,ve)|0,M=M+Math.imul(V,De)|0;var Bt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,g=Math.imul(Ae,Re),h=Math.imul(Ae,ce),h=h+Math.imul(he,Re)|0,M=Math.imul(he,ce),g=g+Math.imul(Me,ye)|0,h=h+Math.imul(Me,se)|0,h=h+Math.imul(Z,ye)|0,M=M+Math.imul(Z,se)|0,g=g+Math.imul(xe,Ie)|0,h=h+Math.imul(xe,te)|0,h=h+Math.imul(Q,Ie)|0,M=M+Math.imul(Q,te)|0,g=g+Math.imul(_e,Ne)|0,h=h+Math.imul(_e,ue)|0,h=h+Math.imul(re,Ne)|0,M=M+Math.imul(re,ue)|0,g=g+Math.imul(we,$e)|0,h=h+Math.imul(we,fe)|0,h=h+Math.imul(ee,$e)|0,M=M+Math.imul(ee,fe)|0,g=g+Math.imul(Se,me)|0,h=h+Math.imul(Se,de)|0,h=h+Math.imul(ne,me)|0,M=M+Math.imul(ne,de)|0,g=g+Math.imul(be,Te)|0,h=h+Math.imul(be,le)|0,h=h+Math.imul(ie,Te)|0,M=M+Math.imul(ie,le)|0,g=g+Math.imul(ge,ve)|0,h=h+Math.imul(ge,De)|0,h=h+Math.imul(Y,ve)|0,M=M+Math.imul(Y,De)|0;var fr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(fr>>>26)|0,fr&=67108863,g=Math.imul(Ae,ye),h=Math.imul(Ae,se),h=h+Math.imul(he,ye)|0,M=Math.imul(he,se),g=g+Math.imul(Me,Ie)|0,h=h+Math.imul(Me,te)|0,h=h+Math.imul(Z,Ie)|0,M=M+Math.imul(Z,te)|0,g=g+Math.imul(xe,Ne)|0,h=h+Math.imul(xe,ue)|0,h=h+Math.imul(Q,Ne)|0,M=M+Math.imul(Q,ue)|0,g=g+Math.imul(_e,$e)|0,h=h+Math.imul(_e,fe)|0,h=h+Math.imul(re,$e)|0,M=M+Math.imul(re,fe)|0,g=g+Math.imul(we,me)|0,h=h+Math.imul(we,de)|0,h=h+Math.imul(ee,me)|0,M=M+Math.imul(ee,de)|0,g=g+Math.imul(Se,Te)|0,h=h+Math.imul(Se,le)|0,h=h+Math.imul(ne,Te)|0,M=M+Math.imul(ne,le)|0,g=g+Math.imul(be,ve)|0,h=h+Math.imul(be,De)|0,h=h+Math.imul(ie,ve)|0,M=M+Math.imul(ie,De)|0;var hr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(hr>>>26)|0,hr&=67108863,g=Math.imul(Ae,Ie),h=Math.imul(Ae,te),h=h+Math.imul(he,Ie)|0,M=Math.imul(he,te),g=g+Math.imul(Me,Ne)|0,h=h+Math.imul(Me,ue)|0,h=h+Math.imul(Z,Ne)|0,M=M+Math.imul(Z,ue)|0,g=g+Math.imul(xe,$e)|0,h=h+Math.imul(xe,fe)|0,h=h+Math.imul(Q,$e)|0,M=M+Math.imul(Q,fe)|0,g=g+Math.imul(_e,me)|0,h=h+Math.imul(_e,de)|0,h=h+Math.imul(re,me)|0,M=M+Math.imul(re,de)|0,g=g+Math.imul(we,Te)|0,h=h+Math.imul(we,le)|0,h=h+Math.imul(ee,Te)|0,M=M+Math.imul(ee,le)|0,g=g+Math.imul(Se,ve)|0,h=h+Math.imul(Se,De)|0,h=h+Math.imul(ne,ve)|0,M=M+Math.imul(ne,De)|0;var mt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(mt>>>26)|0,mt&=67108863,g=Math.imul(Ae,Ne),h=Math.imul(Ae,ue),h=h+Math.imul(he,Ne)|0,M=Math.imul(he,ue),g=g+Math.imul(Me,$e)|0,h=h+Math.imul(Me,fe)|0,h=h+Math.imul(Z,$e)|0,M=M+Math.imul(Z,fe)|0,g=g+Math.imul(xe,me)|0,h=h+Math.imul(xe,de)|0,h=h+Math.imul(Q,me)|0,M=M+Math.imul(Q,de)|0,g=g+Math.imul(_e,Te)|0,h=h+Math.imul(_e,le)|0,h=h+Math.imul(re,Te)|0,M=M+Math.imul(re,le)|0,g=g+Math.imul(we,ve)|0,h=h+Math.imul(we,De)|0,h=h+Math.imul(ee,ve)|0,M=M+Math.imul(ee,De)|0;var cr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(cr>>>26)|0,cr&=67108863,g=Math.imul(Ae,$e),h=Math.imul(Ae,fe),h=h+Math.imul(he,$e)|0,M=Math.imul(he,fe),g=g+Math.imul(Me,me)|0,h=h+Math.imul(Me,de)|0,h=h+Math.imul(Z,me)|0,M=M+Math.imul(Z,de)|0,g=g+Math.imul(xe,Te)|0,h=h+Math.imul(xe,le)|0,h=h+Math.imul(Q,Te)|0,M=M+Math.imul(Q,le)|0,g=g+Math.imul(_e,ve)|0,h=h+Math.imul(_e,De)|0,h=h+Math.imul(re,ve)|0,M=M+Math.imul(re,De)|0;var ur=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ur>>>26)|0,ur&=67108863,g=Math.imul(Ae,me),h=Math.imul(Ae,de),h=h+Math.imul(he,me)|0,M=Math.imul(he,de),g=g+Math.imul(Me,Te)|0,h=h+Math.imul(Me,le)|0,h=h+Math.imul(Z,Te)|0,M=M+Math.imul(Z,le)|0,g=g+Math.imul(xe,ve)|0,h=h+Math.imul(xe,De)|0,h=h+Math.imul(Q,ve)|0,M=M+Math.imul(Q,De)|0;var dr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(dr>>>26)|0,dr&=67108863,g=Math.imul(Ae,Te),h=Math.imul(Ae,le),h=h+Math.imul(he,Te)|0,M=Math.imul(he,le),g=g+Math.imul(Me,ve)|0,h=h+Math.imul(Me,De)|0,h=h+Math.imul(Z,ve)|0,M=M+Math.imul(Z,De)|0;var ai=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ai>>>26)|0,ai&=67108863,g=Math.imul(Ae,ve),h=Math.imul(Ae,De),h=h+Math.imul(he,ve)|0,M=Math.imul(he,De);var oi=(l+g|0)+((h&8191)<<13)|0;return l=(M+(h>>>13)|0)+(oi>>>26)|0,oi&=67108863,m[0]=Qt,m[1]=er,m[2]=tr,m[3]=rr,m[4]=yt,m[5]=ir,m[6]=nr,m[7]=sr,m[8]=ar,m[9]=or,m[10]=Bt,m[11]=fr,m[12]=hr,m[13]=mt,m[14]=cr,m[15]=ur,m[16]=dr,m[17]=ai,m[18]=oi,l!==0&&(m[19]=l,u.length++),u};Math.imul||(N=R);function C(d,a,f){f.negative=a.negative^d.negative,f.length=d.length+a.length;for(var u=0,v=0,y=0;y<f.length-1;y++){var m=v;v=0;for(var l=u&67108863,g=Math.min(y,a.length-1),h=Math.max(0,y-d.length+1);h<=g;h++){var M=y-h,T=d.words[M]|0,$=a.words[h]|0,q=T*$,G=q&67108863;m=m+(q/67108864|0)|0,G=G+l|0,l=G&67108863,m=m+(G>>>26)|0,v+=m>>>26,m&=67108863}f.words[y]=l,u=m,m=v}return u!==0?f.words[y]=u:f.length--,f._strip()}function L(d,a,f){return C(d,a,f)}n.prototype.mulTo=function(a,f){var u,v=this.length+a.length;return this.length===10&&a.length===10?u=N(this,a,f):v<63?u=R(this,a,f):v<1024?u=C(this,a,f):u=L(this,a,f),u},n.prototype.mul=function(a){var f=new n(null);return f.words=new Array(this.length+a.length),this.mulTo(a,f)},n.prototype.mulf=function(a){var f=new n(null);return f.words=new Array(this.length+a.length),L(this,a,f)},n.prototype.imul=function(a){return this.clone().mulTo(a,this)},n.prototype.imuln=function(a){var f=a<0;f&&(a=-a),i(typeof a=="number"),i(a<67108864);for(var u=0,v=0;v<this.length;v++){var y=(this.words[v]|0)*a,m=(y&67108863)+(u&67108863);u>>=26,u+=y/67108864|0,u+=m>>>26,this.words[v]=m&67108863}return u!==0&&(this.words[v]=u,this.length++),f?this.ineg():this},n.prototype.muln=function(a){return this.clone().imuln(a)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(a){var f=P(a);if(f.length===0)return new n(1);for(var u=this,v=0;v<f.length&&f[v]===0;v++,u=u.sqr());if(++v<f.length)for(var y=u.sqr();v<f.length;v++,y=y.sqr())f[v]!==0&&(u=u.mul(y));return u},n.prototype.iushln=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26,v=67108863>>>26-f<<26-f,y;if(f!==0){var m=0;for(y=0;y<this.length;y++){var l=this.words[y]&v,g=(this.words[y]|0)-l<<f;this.words[y]=g|m,m=l>>>26-f}m&&(this.words[y]=m,this.length++)}if(u!==0){for(y=this.length-1;y>=0;y--)this.words[y+u]=this.words[y];for(y=0;y<u;y++)this.words[y]=0;this.length+=u}return this._strip()},n.prototype.ishln=function(a){return i(this.negative===0),this.iushln(a)},n.prototype.iushrn=function(a,f,u){i(typeof a=="number"&&a>=0);var v;f?v=(f-f%26)/26:v=0;var y=a%26,m=Math.min((a-y)/26,this.length),l=67108863^67108863>>>y<<y,g=u;if(v-=m,v=Math.max(0,v),g){for(var h=0;h<m;h++)g.words[h]=this.words[h];g.length=m}if(m!==0)if(this.length>m)for(this.length-=m,h=0;h<this.length;h++)this.words[h]=this.words[h+m];else this.words[0]=0,this.length=1;var M=0;for(h=this.length-1;h>=0&&(M!==0||h>=v);h--){var T=this.words[h]|0;this.words[h]=M<<26-y|T>>>y,M=T&l}return g&&M!==0&&(g.words[g.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(a,f,u){return i(this.negative===0),this.iushrn(a,f,u)},n.prototype.shln=function(a){return this.clone().ishln(a)},n.prototype.ushln=function(a){return this.clone().iushln(a)},n.prototype.shrn=function(a){return this.clone().ishrn(a)},n.prototype.ushrn=function(a){return this.clone().iushrn(a)},n.prototype.testn=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26,v=1<<f;if(this.length<=u)return!1;var y=this.words[u];return!!(y&v)},n.prototype.imaskn=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=u)return this;if(f!==0&&u++,this.length=Math.min(u,this.length),f!==0){var v=67108863^67108863>>>f<<f;this.words[this.length-1]&=v}return this._strip()},n.prototype.maskn=function(a){return this.clone().imaskn(a)},n.prototype.iaddn=function(a){return i(typeof a=="number"),i(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<=a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},n.prototype._iaddn=function(a){this.words[0]+=a;for(var f=0;f<this.length&&this.words[f]>=67108864;f++)this.words[f]-=67108864,f===this.length-1?this.words[f+1]=1:this.words[f+1]++;return this.length=Math.max(this.length,f+1),this},n.prototype.isubn=function(a){if(i(typeof a=="number"),i(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var f=0;f<this.length&&this.words[f]<0;f++)this.words[f]+=67108864,this.words[f+1]-=1;return this._strip()},n.prototype.addn=function(a){return this.clone().iaddn(a)},n.prototype.subn=function(a){return this.clone().isubn(a)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(a,f,u){var v=a.length+u,y;this._expand(v);var m,l=0;for(y=0;y<a.length;y++){m=(this.words[y+u]|0)+l;var g=(a.words[y]|0)*f;m-=g&67108863,l=(m>>26)-(g/67108864|0),this.words[y+u]=m&67108863}for(;y<this.length-u;y++)m=(this.words[y+u]|0)+l,l=m>>26,this.words[y+u]=m&67108863;if(l===0)return this._strip();for(i(l===-1),l=0,y=0;y<this.length;y++)m=-(this.words[y]|0)+l,l=m>>26,this.words[y]=m&67108863;return this.negative=1,this._strip()},n.prototype._wordDiv=function(a,f){var u=this.length-a.length,v=this.clone(),y=a,m=y.words[y.length-1]|0,l=this._countBits(m);u=26-l,u!==0&&(y=y.ushln(u),v.iushln(u),m=y.words[y.length-1]|0);var g=v.length-y.length,h;if(f!=="mod"){h=new n(null),h.length=g+1,h.words=new Array(h.length);for(var M=0;M<h.length;M++)h.words[M]=0}var T=v.clone()._ishlnsubmul(y,1,g);T.negative===0&&(v=T,h&&(h.words[g]=1));for(var $=g-1;$>=0;$--){var q=(v.words[y.length+$]|0)*67108864+(v.words[y.length+$-1]|0);for(q=Math.min(q/m|0,67108863),v._ishlnsubmul(y,q,$);v.negative!==0;)q--,v.negative=0,v._ishlnsubmul(y,1,$),v.isZero()||(v.negative^=1);h&&(h.words[$]=q)}return h&&h._strip(),v._strip(),f!=="div"&&u!==0&&v.iushrn(u),{div:h||null,mod:v}},n.prototype.divmod=function(a,f,u){if(i(!a.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var v,y,m;return this.negative!==0&&a.negative===0?(m=this.neg().divmod(a,f),f!=="mod"&&(v=m.div.neg()),f!=="div"&&(y=m.mod.neg(),u&&y.negative!==0&&y.iadd(a)),{div:v,mod:y}):this.negative===0&&a.negative!==0?(m=this.divmod(a.neg(),f),f!=="mod"&&(v=m.div.neg()),{div:v,mod:m.mod}):this.negative&a.negative?(m=this.neg().divmod(a.neg(),f),f!=="div"&&(y=m.mod.neg(),u&&y.negative!==0&&y.isub(a)),{div:m.div,mod:y}):a.length>this.length||this.cmp(a)<0?{div:new n(0),mod:this}:a.length===1?f==="div"?{div:this.divn(a.words[0]),mod:null}:f==="mod"?{div:null,mod:new n(this.modrn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new n(this.modrn(a.words[0]))}:this._wordDiv(a,f)},n.prototype.div=function(a){return this.divmod(a,"div",!1).div},n.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},n.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},n.prototype.divRound=function(a){var f=this.divmod(a);if(f.mod.isZero())return f.div;var u=f.div.negative!==0?f.mod.isub(a):f.mod,v=a.ushrn(1),y=a.andln(1),m=u.cmp(v);return m<0||y===1&&m===0?f.div:f.div.negative!==0?f.div.isubn(1):f.div.iaddn(1)},n.prototype.modrn=function(a){var f=a<0;f&&(a=-a),i(a<=67108863);for(var u=(1<<26)%a,v=0,y=this.length-1;y>=0;y--)v=(u*v+(this.words[y]|0))%a;return f?-v:v},n.prototype.modn=function(a){return this.modrn(a)},n.prototype.idivn=function(a){var f=a<0;f&&(a=-a),i(a<=67108863);for(var u=0,v=this.length-1;v>=0;v--){var y=(this.words[v]|0)+u*67108864;this.words[v]=y/a|0,u=y%a}return this._strip(),f?this.ineg():this},n.prototype.divn=function(a){return this.clone().idivn(a)},n.prototype.egcd=function(a){i(a.negative===0),i(!a.isZero());var f=this,u=a.clone();f.negative!==0?f=f.umod(a):f=f.clone();for(var v=new n(1),y=new n(0),m=new n(0),l=new n(1),g=0;f.isEven()&&u.isEven();)f.iushrn(1),u.iushrn(1),++g;for(var h=u.clone(),M=f.clone();!f.isZero();){for(var T=0,$=1;!(f.words[0]&$)&&T<26;++T,$<<=1);if(T>0)for(f.iushrn(T);T-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(h),y.isub(M)),v.iushrn(1),y.iushrn(1);for(var q=0,G=1;!(u.words[0]&G)&&q<26;++q,G<<=1);if(q>0)for(u.iushrn(q);q-- >0;)(m.isOdd()||l.isOdd())&&(m.iadd(h),l.isub(M)),m.iushrn(1),l.iushrn(1);f.cmp(u)>=0?(f.isub(u),v.isub(m),y.isub(l)):(u.isub(f),m.isub(v),l.isub(y))}return{a:m,b:l,gcd:u.iushln(g)}},n.prototype._invmp=function(a){i(a.negative===0),i(!a.isZero());var f=this,u=a.clone();f.negative!==0?f=f.umod(a):f=f.clone();for(var v=new n(1),y=new n(0),m=u.clone();f.cmpn(1)>0&&u.cmpn(1)>0;){for(var l=0,g=1;!(f.words[0]&g)&&l<26;++l,g<<=1);if(l>0)for(f.iushrn(l);l-- >0;)v.isOdd()&&v.iadd(m),v.iushrn(1);for(var h=0,M=1;!(u.words[0]&M)&&h<26;++h,M<<=1);if(h>0)for(u.iushrn(h);h-- >0;)y.isOdd()&&y.iadd(m),y.iushrn(1);f.cmp(u)>=0?(f.isub(u),v.isub(y)):(u.isub(f),y.isub(v))}var T;return f.cmpn(1)===0?T=v:T=y,T.cmpn(0)<0&&T.iadd(a),T},n.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var f=this.clone(),u=a.clone();f.negative=0,u.negative=0;for(var v=0;f.isEven()&&u.isEven();v++)f.iushrn(1),u.iushrn(1);do{for(;f.isEven();)f.iushrn(1);for(;u.isEven();)u.iushrn(1);var y=f.cmp(u);if(y<0){var m=f;f=u,u=m}else if(y===0||u.cmpn(1)===0)break;f.isub(u)}while(!0);return u.iushln(v)},n.prototype.invm=function(a){return this.egcd(a).a.umod(a)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(a){return this.words[0]&a},n.prototype.bincn=function(a){i(typeof a=="number");var f=a%26,u=(a-f)/26,v=1<<f;if(this.length<=u)return this._expand(u+1),this.words[u]|=v,this;for(var y=v,m=u;y!==0&&m<this.length;m++){var l=this.words[m]|0;l+=y,y=l>>>26,l&=67108863,this.words[m]=l}return y!==0&&(this.words[m]=y,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(a){var f=a<0;if(this.negative!==0&&!f)return-1;if(this.negative===0&&f)return 1;this._strip();var u;if(this.length>1)u=1;else{f&&(a=-a),i(a<=67108863,"Number is too big");var v=this.words[0]|0;u=v===a?0:v<a?-1:1}return this.negative!==0?-u|0:u},n.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var f=this.ucmp(a);return this.negative!==0?-f|0:f},n.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var f=0,u=this.length-1;u>=0;u--){var v=this.words[u]|0,y=a.words[u]|0;if(v!==y){v<y?f=-1:v>y&&(f=1);break}}return f},n.prototype.gtn=function(a){return this.cmpn(a)===1},n.prototype.gt=function(a){return this.cmp(a)===1},n.prototype.gten=function(a){return this.cmpn(a)>=0},n.prototype.gte=function(a){return this.cmp(a)>=0},n.prototype.ltn=function(a){return this.cmpn(a)===-1},n.prototype.lt=function(a){return this.cmp(a)===-1},n.prototype.lten=function(a){return this.cmpn(a)<=0},n.prototype.lte=function(a){return this.cmp(a)<=0},n.prototype.eqn=function(a){return this.cmpn(a)===0},n.prototype.eq=function(a){return this.cmp(a)===0},n.red=function(a){return new A(a)},n.prototype.toRed=function(a){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(a){return this.red=a,this},n.prototype.forceRed=function(a){return i(!this.red,"Already a number in reduction context"),this._forceRed(a)},n.prototype.redAdd=function(a){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},n.prototype.redIAdd=function(a){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},n.prototype.redSub=function(a){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},n.prototype.redISub=function(a){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},n.prototype.redShl=function(a){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},n.prototype.redMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},n.prototype.redIMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(a){return i(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var B={k256:null,p224:null,p192:null,p25519:null};function U(d,a){this.name=d,this.p=new n(a,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}U.prototype._tmp=function(){var a=new n(null);return a.words=new Array(Math.ceil(this.n/13)),a},U.prototype.ireduce=function(a){var f=a,u;do this.split(f,this.tmp),f=this.imulK(f),f=f.iadd(this.tmp),u=f.bitLength();while(u>this.n);var v=u<this.n?-1:f.ucmp(this.p);return v===0?(f.words[0]=0,f.length=1):v>0?f.isub(this.p):f.strip!==void 0?f.strip():f._strip(),f},U.prototype.split=function(a,f){a.iushrn(this.n,0,f)},U.prototype.imulK=function(a){return a.imul(this.k)};function K(){U.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(K,U),K.prototype.split=function(a,f){for(var u=4194303,v=Math.min(a.length,9),y=0;y<v;y++)f.words[y]=a.words[y];if(f.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var m=a.words[9];for(f.words[f.length++]=m&u,y=10;y<a.length;y++){var l=a.words[y]|0;a.words[y-10]=(l&u)<<4|m>>>22,m=l}m>>>=22,a.words[y-10]=m,m===0&&a.length>10?a.length-=10:a.length-=9},K.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var f=0,u=0;u<a.length;u++){var v=a.words[u]|0;f+=v*977,a.words[u]=f&67108863,f=v*64+(f/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function k(){U.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(k,U);function z(){U.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(z,U);function pe(){U.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(pe,U),pe.prototype.imulK=function(a){for(var f=0,u=0;u<a.length;u++){var v=(a.words[u]|0)*19+f,y=v&67108863;v>>>=26,a.words[u]=y,f=v}return f!==0&&(a.words[a.length++]=f),a},n._prime=function(a){if(B[a])return B[a];var f;if(a==="k256")f=new K;else if(a==="p224")f=new k;else if(a==="p192")f=new z;else if(a==="p25519")f=new pe;else throw new Error("Unknown prime "+a);return B[a]=f,f};function A(d){if(typeof d=="string"){var a=n._prime(d);this.m=a.p,this.prime=a}else i(d.gtn(1),"modulus must be greater than 1"),this.m=d,this.prime=null}A.prototype._verify1=function(a){i(a.negative===0,"red works only with positives"),i(a.red,"red works only with red numbers")},A.prototype._verify2=function(a,f){i((a.negative|f.negative)===0,"red works only with positives"),i(a.red&&a.red===f.red,"red works only with red numbers")},A.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(w(a,a.umod(this.m)._forceRed(this)),a)},A.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},A.prototype.add=function(a,f){this._verify2(a,f);var u=a.add(f);return u.cmp(this.m)>=0&&u.isub(this.m),u._forceRed(this)},A.prototype.iadd=function(a,f){this._verify2(a,f);var u=a.iadd(f);return u.cmp(this.m)>=0&&u.isub(this.m),u},A.prototype.sub=function(a,f){this._verify2(a,f);var u=a.sub(f);return u.cmpn(0)<0&&u.iadd(this.m),u._forceRed(this)},A.prototype.isub=function(a,f){this._verify2(a,f);var u=a.isub(f);return u.cmpn(0)<0&&u.iadd(this.m),u},A.prototype.shl=function(a,f){return this._verify1(a),this.imod(a.ushln(f))},A.prototype.imul=function(a,f){return this._verify2(a,f),this.imod(a.imul(f))},A.prototype.mul=function(a,f){return this._verify2(a,f),this.imod(a.mul(f))},A.prototype.isqr=function(a){return this.imul(a,a.clone())},A.prototype.sqr=function(a){return this.mul(a,a)},A.prototype.sqrt=function(a){if(a.isZero())return a.clone();var f=this.m.andln(3);if(i(f%2===1),f===3){var u=this.m.add(new n(1)).iushrn(2);return this.pow(a,u)}for(var v=this.m.subn(1),y=0;!v.isZero()&&v.andln(1)===0;)y++,v.iushrn(1);i(!v.isZero());var m=new n(1).toRed(this),l=m.redNeg(),g=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new n(2*h*h).toRed(this);this.pow(h,g).cmp(l)!==0;)h.redIAdd(l);for(var M=this.pow(h,v),T=this.pow(a,v.addn(1).iushrn(1)),$=this.pow(a,v),q=y;$.cmp(m)!==0;){for(var G=$,H=0;G.cmp(m)!==0;H++)G=G.redSqr();i(H<q);var V=this.pow(M,new n(1).iushln(q-H-1));T=T.redMul(V),M=V.redSqr(),$=$.redMul(M),q=H}return T},A.prototype.invm=function(a){var f=a._invmp(this.m);return f.negative!==0?(f.negative=0,this.imod(f).redNeg()):this.imod(f)},A.prototype.pow=function(a,f){if(f.isZero())return new n(1).toRed(this);if(f.cmpn(1)===0)return a.clone();var u=4,v=new Array(1<<u);v[0]=new n(1).toRed(this),v[1]=a;for(var y=2;y<v.length;y++)v[y]=this.mul(v[y-1],a);var m=v[0],l=0,g=0,h=f.bitLength()%26;for(h===0&&(h=26),y=f.length-1;y>=0;y--){for(var M=f.words[y],T=h-1;T>=0;T--){var $=M>>T&1;if(m!==v[0]&&(m=this.sqr(m)),$===0&&l===0){g=0;continue}l<<=1,l|=$,g++,!(g!==u&&(y!==0||T!==0))&&(m=this.mul(m,v[l]),g=0,l=0)}h=26}return m},A.prototype.convertTo=function(a){var f=a.umod(this.m);return f===a?f.clone():f},A.prototype.convertFrom=function(a){var f=a.clone();return f.red=null,f},n.mont=function(a){return new _(a)};function _(d){A.call(this,d),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(_,A),_.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},_.prototype.convertFrom=function(a){var f=this.imod(a.mul(this.rinv));return f.red=null,f},_.prototype.imul=function(a,f){if(a.isZero()||f.isZero())return a.words[0]=0,a.length=1,a;var u=a.imul(f),v=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=u.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},_.prototype.mul=function(a,f){if(a.isZero()||f.isZero())return new n(0)._forceRed(this);var u=a.mul(f),v=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=u.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},_.prototype.invm=function(a){var f=this.imod(a._invmp(this.m).mul(this.r2));return f._forceRed(this)}})(t,Zi)})(Af);var am=Af.exports;const om=Tn(am);var fm=om.BN;function hm(t){return new fm(t,36).toString(16)}function Od(t){return"0x"+$0.keccak_256(St(t))}const cm="address/5.7.0",os=new ct(cm);function ic(t){Zr(t,20)||os.throwArgumentError("invalid address","address",t),t=t.toLowerCase();const e=t.substring(2).split(""),r=new Uint8Array(40);for(let s=0;s<40;s++)r[s]=e[s].charCodeAt(0);const i=St(Od(r));for(let s=0;s<40;s+=2)i[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(i[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const um=9007199254740991;function dm(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10}const Df={};for(let t=0;t<10;t++)Df[String(t)]=String(t);for(let t=0;t<26;t++)Df[String.fromCharCode(65+t)]=String(10+t);const nc=Math.floor(dm(um));function lm(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(i=>Df[i]).join("");for(;e.length>=nc;){let i=e.substring(0,nc);e=parseInt(i,10)%97+e.substring(i.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}function pm(t){let e=null;if(typeof t!="string"&&os.throwArgumentError("invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/))t.substring(0,2)!=="0x"&&(t="0x"+t),e=ic(t),t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==t&&os.throwArgumentError("bad address checksum","address",t);else if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(t.substring(2,4)!==lm(t)&&os.throwArgumentError("bad icap checksum","address",t),e=hm(t.substring(4));e.length<40;)e="0"+e;e=ic("0x"+e)}else os.throwArgumentError("invalid address","address",t);return e}function Yn(t,e,r){Object.defineProperty(t,e,{enumerable:!0,value:r,writable:!1})}var Of={exports:{}};Of.exports;(function(t){(function(e,r){function i(d,a){if(!d)throw new Error(a||"Assertion failed")}function s(d,a){d.super_=a;var f=function(){};f.prototype=a.prototype,d.prototype=new f,d.prototype.constructor=d}function n(d,a,f){if(n.isBN(d))return d;this.negative=0,this.words=null,this.length=0,this.red=null,d!==null&&((a==="le"||a==="be")&&(f=a,a=10),this._init(d||0,a||10,f||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=_a.Buffer}catch{}n.isBN=function(a){return a instanceof n?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===n.wordSize&&Array.isArray(a.words)},n.max=function(a,f){return a.cmp(f)>0?a:f},n.min=function(a,f){return a.cmp(f)<0?a:f},n.prototype._init=function(a,f,u){if(typeof a=="number")return this._initNumber(a,f,u);if(typeof a=="object")return this._initArray(a,f,u);f==="hex"&&(f=16),i(f===(f|0)&&f>=2&&f<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(f===16?this._parseHex(a,v,u):(this._parseBase(a,f,v),u==="le"&&this._initArray(this.toArray(),f,u)))},n.prototype._initNumber=function(a,f,u){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(i(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),u==="le"&&this._initArray(this.toArray(),f,u)},n.prototype._initArray=function(a,f,u){if(i(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y,m,l=0;if(u==="be")for(v=a.length-1,y=0;v>=0;v-=3)m=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);else if(u==="le")for(v=0,y=0;v<a.length;v+=3)m=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[y]|=m<<l&67108863,this.words[y+1]=m>>>26-l&67108863,l+=24,l>=26&&(l-=26,y++);return this._strip()};function c(d,a){var f=d.charCodeAt(a);if(f>=48&&f<=57)return f-48;if(f>=65&&f<=70)return f-55;if(f>=97&&f<=102)return f-87;i(!1,"Invalid character in "+d)}function p(d,a,f){var u=c(d,f);return f-1>=a&&(u|=c(d,f-1)<<4),u}n.prototype._parseHex=function(a,f,u){this.length=Math.ceil((a.length-f)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var y=0,m=0,l;if(u==="be")for(v=a.length-1;v>=f;v-=2)l=p(a,f,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8;else{var g=a.length-f;for(v=g%2===0?f+1:f;v<a.length;v+=2)l=p(a,f,v)<<y,this.words[m]|=l&67108863,y>=18?(y-=18,m+=1,this.words[m]|=l>>>26):y+=8}this._strip()};function b(d,a,f,u){for(var v=0,y=0,m=Math.min(d.length,f),l=a;l<m;l++){var g=d.charCodeAt(l)-48;v*=u,g>=49?y=g-49+10:g>=17?y=g-17+10:y=g,i(g>=0&&y<u,"Invalid character"),v+=y}return v}n.prototype._parseBase=function(a,f,u){this.words=[0],this.length=1;for(var v=0,y=1;y<=67108863;y*=f)v++;v--,y=y/f|0;for(var m=a.length-u,l=m%v,g=Math.min(m,m-l)+u,h=0,M=u;M<g;M+=v)h=b(a,M,M+v,f),this.imuln(y),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(l!==0){var T=1;for(h=b(a,M,a.length,f),M=0;M<l;M++)T*=f;this.imuln(T),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this._strip()},n.prototype.copy=function(a){a.words=new Array(this.length);for(var f=0;f<this.length;f++)a.words[f]=this.words[f];a.length=this.length,a.negative=this.negative,a.red=this.red};function w(d,a){d.words=a.words,d.length=a.length,d.negative=a.negative,d.red=a.red}if(n.prototype._move=function(a){w(a,this)},n.prototype.clone=function(){var a=new n(null);return this.copy(a),a},n.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{n.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{n.prototype.inspect=x}else n.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var E=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],I=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],S=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(a,f){a=a||10,f=f|0||1;var u;if(a===16||a==="hex"){u="";for(var v=0,y=0,m=0;m<this.length;m++){var l=this.words[m],g=((l<<v|y)&16777215).toString(16);y=l>>>24-v&16777215,v+=2,v>=26&&(v-=26,m--),y!==0||m!==this.length-1?u=E[6-g.length]+g+u:u=g+u}for(y!==0&&(u=y.toString(16)+u);u.length%f!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}if(a===(a|0)&&a>=2&&a<=36){var h=I[a],M=S[a];u="";var T=this.clone();for(T.negative=0;!T.isZero();){var $=T.modrn(M).toString(a);T=T.idivn(M),T.isZero()?u=$+u:u=E[h-$.length]+$+u}for(this.isZero()&&(u="0"+u);u.length%f!==0;)u="0"+u;return this.negative!==0&&(u="-"+u),u}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},n.prototype.toJSON=function(){return this.toString(16,2)},o&&(n.prototype.toBuffer=function(a,f){return this.toArrayLike(o,a,f)}),n.prototype.toArray=function(a,f){return this.toArrayLike(Array,a,f)};var D=function(a,f){return a.allocUnsafe?a.allocUnsafe(f):new a(f)};n.prototype.toArrayLike=function(a,f,u){this._strip();var v=this.byteLength(),y=u||Math.max(1,v);i(v<=y,"byte array longer than desired length"),i(y>0,"Requested array length <= 0");var m=D(a,y),l=f==="le"?"LE":"BE";return this["_toArrayLike"+l](m,v),m},n.prototype._toArrayLikeLE=function(a,f){for(var u=0,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[u++]=l&255,u<a.length&&(a[u++]=l>>8&255),u<a.length&&(a[u++]=l>>16&255),m===6?(u<a.length&&(a[u++]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(u<a.length)for(a[u++]=v;u<a.length;)a[u++]=0},n.prototype._toArrayLikeBE=function(a,f){for(var u=a.length-1,v=0,y=0,m=0;y<this.length;y++){var l=this.words[y]<<m|v;a[u--]=l&255,u>=0&&(a[u--]=l>>8&255),u>=0&&(a[u--]=l>>16&255),m===6?(u>=0&&(a[u--]=l>>24&255),v=0,m=0):(v=l>>>24,m+=2)}if(u>=0)for(a[u--]=v;u>=0;)a[u--]=0},Math.clz32?n.prototype._countBits=function(a){return 32-Math.clz32(a)}:n.prototype._countBits=function(a){var f=a,u=0;return f>=4096&&(u+=13,f>>>=13),f>=64&&(u+=7,f>>>=7),f>=8&&(u+=4,f>>>=4),f>=2&&(u+=2,f>>>=2),u+f},n.prototype._zeroBits=function(a){if(a===0)return 26;var f=a,u=0;return f&8191||(u+=13,f>>>=13),f&127||(u+=7,f>>>=7),f&15||(u+=4,f>>>=4),f&3||(u+=2,f>>>=2),f&1||u++,u},n.prototype.bitLength=function(){var a=this.words[this.length-1],f=this._countBits(a);return(this.length-1)*26+f};function P(d){for(var a=new Array(d.bitLength()),f=0;f<a.length;f++){var u=f/26|0,v=f%26;a[f]=d.words[u]>>>v&1}return a}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,f=0;f<this.length;f++){var u=this._zeroBits(this.words[f]);if(a+=u,u!==26)break}return a},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},n.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var f=0;f<a.length;f++)this.words[f]=this.words[f]|a.words[f];return this._strip()},n.prototype.ior=function(a){return i((this.negative|a.negative)===0),this.iuor(a)},n.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},n.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},n.prototype.iuand=function(a){var f;this.length>a.length?f=a:f=this;for(var u=0;u<f.length;u++)this.words[u]=this.words[u]&a.words[u];return this.length=f.length,this._strip()},n.prototype.iand=function(a){return i((this.negative|a.negative)===0),this.iuand(a)},n.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},n.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},n.prototype.iuxor=function(a){var f,u;this.length>a.length?(f=this,u=a):(f=a,u=this);for(var v=0;v<u.length;v++)this.words[v]=f.words[v]^u.words[v];if(this!==f)for(;v<f.length;v++)this.words[v]=f.words[v];return this.length=f.length,this._strip()},n.prototype.ixor=function(a){return i((this.negative|a.negative)===0),this.iuxor(a)},n.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},n.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},n.prototype.inotn=function(a){i(typeof a=="number"&&a>=0);var f=Math.ceil(a/26)|0,u=a%26;this._expand(f),u>0&&f--;for(var v=0;v<f;v++)this.words[v]=~this.words[v]&67108863;return u>0&&(this.words[v]=~this.words[v]&67108863>>26-u),this._strip()},n.prototype.notn=function(a){return this.clone().inotn(a)},n.prototype.setn=function(a,f){i(typeof a=="number"&&a>=0);var u=a/26|0,v=a%26;return this._expand(u+1),f?this.words[u]=this.words[u]|1<<v:this.words[u]=this.words[u]&~(1<<v),this._strip()},n.prototype.iadd=function(a){var f;if(this.negative!==0&&a.negative===0)return this.negative=0,f=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,f=this.isub(a),a.negative=1,f._normSign();var u,v;this.length>a.length?(u=this,v=a):(u=a,v=this);for(var y=0,m=0;m<v.length;m++)f=(u.words[m]|0)+(v.words[m]|0)+y,this.words[m]=f&67108863,y=f>>>26;for(;y!==0&&m<u.length;m++)f=(u.words[m]|0)+y,this.words[m]=f&67108863,y=f>>>26;if(this.length=u.length,y!==0)this.words[this.length]=y,this.length++;else if(u!==this)for(;m<u.length;m++)this.words[m]=u.words[m];return this},n.prototype.add=function(a){var f;return a.negative!==0&&this.negative===0?(a.negative=0,f=this.sub(a),a.negative^=1,f):a.negative===0&&this.negative!==0?(this.negative=0,f=a.sub(this),this.negative=1,f):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},n.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var f=this.iadd(a);return a.negative=1,f._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var u=this.cmp(a);if(u===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,y;u>0?(v=this,y=a):(v=a,y=this);for(var m=0,l=0;l<y.length;l++)f=(v.words[l]|0)-(y.words[l]|0)+m,m=f>>26,this.words[l]=f&67108863;for(;m!==0&&l<v.length;l++)f=(v.words[l]|0)+m,m=f>>26,this.words[l]=f&67108863;if(m===0&&l<v.length&&v!==this)for(;l<v.length;l++)this.words[l]=v.words[l];return this.length=Math.max(this.length,l),v!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(a){return this.clone().isub(a)};function R(d,a,f){f.negative=a.negative^d.negative;var u=d.length+a.length|0;f.length=u,u=u-1|0;var v=d.words[0]|0,y=a.words[0]|0,m=v*y,l=m&67108863,g=m/67108864|0;f.words[0]=l;for(var h=1;h<u;h++){for(var M=g>>>26,T=g&67108863,$=Math.min(h,a.length-1),q=Math.max(0,h-d.length+1);q<=$;q++){var G=h-q|0;v=d.words[G]|0,y=a.words[q]|0,m=v*y+T,M+=m/67108864|0,T=m&67108863}f.words[h]=T|0,g=M|0}return g!==0?f.words[h]=g|0:f.length--,f._strip()}var N=function(a,f,u){var v=a.words,y=f.words,m=u.words,l=0,g,h,M,T=v[0]|0,$=T&8191,q=T>>>13,G=v[1]|0,H=G&8191,V=G>>>13,Oe=v[2]|0,ge=Oe&8191,Y=Oe>>>13,Be=v[3]|0,be=Be&8191,ie=Be>>>13,He=v[4]|0,Se=He&8191,ne=He>>>13,je=v[5]|0,we=je&8191,ee=je>>>13,Ke=v[6]|0,_e=Ke&8191,re=Ke>>>13,Ve=v[7]|0,xe=Ve&8191,Q=Ve>>>13,ze=v[8]|0,Me=ze&8191,Z=ze>>>13,Ze=v[9]|0,Ae=Ze&8191,he=Ze>>>13,Ye=y[0]|0,Ee=Ye&8191,oe=Ye>>>13,Xe=y[1]|0,Pe=Xe&8191,X=Xe>>>13,Qe=y[2]|0,Re=Qe&8191,ce=Qe>>>13,We=y[3]|0,ye=We&8191,se=We>>>13,Ge=y[4]|0,Ie=Ge&8191,te=Ge>>>13,et=y[5]|0,Ne=et&8191,ue=et>>>13,tt=y[6]|0,$e=tt&8191,fe=tt>>>13,Je=y[7]|0,me=Je&8191,de=Je>>>13,rt=y[8]|0,Te=rt&8191,le=rt>>>13,it=y[9]|0,ve=it&8191,De=it>>>13;u.negative=a.negative^f.negative,u.length=19,g=Math.imul($,Ee),h=Math.imul($,oe),h=h+Math.imul(q,Ee)|0,M=Math.imul(q,oe);var Qt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,g=Math.imul(H,Ee),h=Math.imul(H,oe),h=h+Math.imul(V,Ee)|0,M=Math.imul(V,oe),g=g+Math.imul($,Pe)|0,h=h+Math.imul($,X)|0,h=h+Math.imul(q,Pe)|0,M=M+Math.imul(q,X)|0;var er=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(er>>>26)|0,er&=67108863,g=Math.imul(ge,Ee),h=Math.imul(ge,oe),h=h+Math.imul(Y,Ee)|0,M=Math.imul(Y,oe),g=g+Math.imul(H,Pe)|0,h=h+Math.imul(H,X)|0,h=h+Math.imul(V,Pe)|0,M=M+Math.imul(V,X)|0,g=g+Math.imul($,Re)|0,h=h+Math.imul($,ce)|0,h=h+Math.imul(q,Re)|0,M=M+Math.imul(q,ce)|0;var tr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(tr>>>26)|0,tr&=67108863,g=Math.imul(be,Ee),h=Math.imul(be,oe),h=h+Math.imul(ie,Ee)|0,M=Math.imul(ie,oe),g=g+Math.imul(ge,Pe)|0,h=h+Math.imul(ge,X)|0,h=h+Math.imul(Y,Pe)|0,M=M+Math.imul(Y,X)|0,g=g+Math.imul(H,Re)|0,h=h+Math.imul(H,ce)|0,h=h+Math.imul(V,Re)|0,M=M+Math.imul(V,ce)|0,g=g+Math.imul($,ye)|0,h=h+Math.imul($,se)|0,h=h+Math.imul(q,ye)|0,M=M+Math.imul(q,se)|0;var rr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(rr>>>26)|0,rr&=67108863,g=Math.imul(Se,Ee),h=Math.imul(Se,oe),h=h+Math.imul(ne,Ee)|0,M=Math.imul(ne,oe),g=g+Math.imul(be,Pe)|0,h=h+Math.imul(be,X)|0,h=h+Math.imul(ie,Pe)|0,M=M+Math.imul(ie,X)|0,g=g+Math.imul(ge,Re)|0,h=h+Math.imul(ge,ce)|0,h=h+Math.imul(Y,Re)|0,M=M+Math.imul(Y,ce)|0,g=g+Math.imul(H,ye)|0,h=h+Math.imul(H,se)|0,h=h+Math.imul(V,ye)|0,M=M+Math.imul(V,se)|0,g=g+Math.imul($,Ie)|0,h=h+Math.imul($,te)|0,h=h+Math.imul(q,Ie)|0,M=M+Math.imul(q,te)|0;var yt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(yt>>>26)|0,yt&=67108863,g=Math.imul(we,Ee),h=Math.imul(we,oe),h=h+Math.imul(ee,Ee)|0,M=Math.imul(ee,oe),g=g+Math.imul(Se,Pe)|0,h=h+Math.imul(Se,X)|0,h=h+Math.imul(ne,Pe)|0,M=M+Math.imul(ne,X)|0,g=g+Math.imul(be,Re)|0,h=h+Math.imul(be,ce)|0,h=h+Math.imul(ie,Re)|0,M=M+Math.imul(ie,ce)|0,g=g+Math.imul(ge,ye)|0,h=h+Math.imul(ge,se)|0,h=h+Math.imul(Y,ye)|0,M=M+Math.imul(Y,se)|0,g=g+Math.imul(H,Ie)|0,h=h+Math.imul(H,te)|0,h=h+Math.imul(V,Ie)|0,M=M+Math.imul(V,te)|0,g=g+Math.imul($,Ne)|0,h=h+Math.imul($,ue)|0,h=h+Math.imul(q,Ne)|0,M=M+Math.imul(q,ue)|0;var ir=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ir>>>26)|0,ir&=67108863,g=Math.imul(_e,Ee),h=Math.imul(_e,oe),h=h+Math.imul(re,Ee)|0,M=Math.imul(re,oe),g=g+Math.imul(we,Pe)|0,h=h+Math.imul(we,X)|0,h=h+Math.imul(ee,Pe)|0,M=M+Math.imul(ee,X)|0,g=g+Math.imul(Se,Re)|0,h=h+Math.imul(Se,ce)|0,h=h+Math.imul(ne,Re)|0,M=M+Math.imul(ne,ce)|0,g=g+Math.imul(be,ye)|0,h=h+Math.imul(be,se)|0,h=h+Math.imul(ie,ye)|0,M=M+Math.imul(ie,se)|0,g=g+Math.imul(ge,Ie)|0,h=h+Math.imul(ge,te)|0,h=h+Math.imul(Y,Ie)|0,M=M+Math.imul(Y,te)|0,g=g+Math.imul(H,Ne)|0,h=h+Math.imul(H,ue)|0,h=h+Math.imul(V,Ne)|0,M=M+Math.imul(V,ue)|0,g=g+Math.imul($,$e)|0,h=h+Math.imul($,fe)|0,h=h+Math.imul(q,$e)|0,M=M+Math.imul(q,fe)|0;var nr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(nr>>>26)|0,nr&=67108863,g=Math.imul(xe,Ee),h=Math.imul(xe,oe),h=h+Math.imul(Q,Ee)|0,M=Math.imul(Q,oe),g=g+Math.imul(_e,Pe)|0,h=h+Math.imul(_e,X)|0,h=h+Math.imul(re,Pe)|0,M=M+Math.imul(re,X)|0,g=g+Math.imul(we,Re)|0,h=h+Math.imul(we,ce)|0,h=h+Math.imul(ee,Re)|0,M=M+Math.imul(ee,ce)|0,g=g+Math.imul(Se,ye)|0,h=h+Math.imul(Se,se)|0,h=h+Math.imul(ne,ye)|0,M=M+Math.imul(ne,se)|0,g=g+Math.imul(be,Ie)|0,h=h+Math.imul(be,te)|0,h=h+Math.imul(ie,Ie)|0,M=M+Math.imul(ie,te)|0,g=g+Math.imul(ge,Ne)|0,h=h+Math.imul(ge,ue)|0,h=h+Math.imul(Y,Ne)|0,M=M+Math.imul(Y,ue)|0,g=g+Math.imul(H,$e)|0,h=h+Math.imul(H,fe)|0,h=h+Math.imul(V,$e)|0,M=M+Math.imul(V,fe)|0,g=g+Math.imul($,me)|0,h=h+Math.imul($,de)|0,h=h+Math.imul(q,me)|0,M=M+Math.imul(q,de)|0;var sr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(sr>>>26)|0,sr&=67108863,g=Math.imul(Me,Ee),h=Math.imul(Me,oe),h=h+Math.imul(Z,Ee)|0,M=Math.imul(Z,oe),g=g+Math.imul(xe,Pe)|0,h=h+Math.imul(xe,X)|0,h=h+Math.imul(Q,Pe)|0,M=M+Math.imul(Q,X)|0,g=g+Math.imul(_e,Re)|0,h=h+Math.imul(_e,ce)|0,h=h+Math.imul(re,Re)|0,M=M+Math.imul(re,ce)|0,g=g+Math.imul(we,ye)|0,h=h+Math.imul(we,se)|0,h=h+Math.imul(ee,ye)|0,M=M+Math.imul(ee,se)|0,g=g+Math.imul(Se,Ie)|0,h=h+Math.imul(Se,te)|0,h=h+Math.imul(ne,Ie)|0,M=M+Math.imul(ne,te)|0,g=g+Math.imul(be,Ne)|0,h=h+Math.imul(be,ue)|0,h=h+Math.imul(ie,Ne)|0,M=M+Math.imul(ie,ue)|0,g=g+Math.imul(ge,$e)|0,h=h+Math.imul(ge,fe)|0,h=h+Math.imul(Y,$e)|0,M=M+Math.imul(Y,fe)|0,g=g+Math.imul(H,me)|0,h=h+Math.imul(H,de)|0,h=h+Math.imul(V,me)|0,M=M+Math.imul(V,de)|0,g=g+Math.imul($,Te)|0,h=h+Math.imul($,le)|0,h=h+Math.imul(q,Te)|0,M=M+Math.imul(q,le)|0;var ar=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ar>>>26)|0,ar&=67108863,g=Math.imul(Ae,Ee),h=Math.imul(Ae,oe),h=h+Math.imul(he,Ee)|0,M=Math.imul(he,oe),g=g+Math.imul(Me,Pe)|0,h=h+Math.imul(Me,X)|0,h=h+Math.imul(Z,Pe)|0,M=M+Math.imul(Z,X)|0,g=g+Math.imul(xe,Re)|0,h=h+Math.imul(xe,ce)|0,h=h+Math.imul(Q,Re)|0,M=M+Math.imul(Q,ce)|0,g=g+Math.imul(_e,ye)|0,h=h+Math.imul(_e,se)|0,h=h+Math.imul(re,ye)|0,M=M+Math.imul(re,se)|0,g=g+Math.imul(we,Ie)|0,h=h+Math.imul(we,te)|0,h=h+Math.imul(ee,Ie)|0,M=M+Math.imul(ee,te)|0,g=g+Math.imul(Se,Ne)|0,h=h+Math.imul(Se,ue)|0,h=h+Math.imul(ne,Ne)|0,M=M+Math.imul(ne,ue)|0,g=g+Math.imul(be,$e)|0,h=h+Math.imul(be,fe)|0,h=h+Math.imul(ie,$e)|0,M=M+Math.imul(ie,fe)|0,g=g+Math.imul(ge,me)|0,h=h+Math.imul(ge,de)|0,h=h+Math.imul(Y,me)|0,M=M+Math.imul(Y,de)|0,g=g+Math.imul(H,Te)|0,h=h+Math.imul(H,le)|0,h=h+Math.imul(V,Te)|0,M=M+Math.imul(V,le)|0,g=g+Math.imul($,ve)|0,h=h+Math.imul($,De)|0,h=h+Math.imul(q,ve)|0,M=M+Math.imul(q,De)|0;var or=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(or>>>26)|0,or&=67108863,g=Math.imul(Ae,Pe),h=Math.imul(Ae,X),h=h+Math.imul(he,Pe)|0,M=Math.imul(he,X),g=g+Math.imul(Me,Re)|0,h=h+Math.imul(Me,ce)|0,h=h+Math.imul(Z,Re)|0,M=M+Math.imul(Z,ce)|0,g=g+Math.imul(xe,ye)|0,h=h+Math.imul(xe,se)|0,h=h+Math.imul(Q,ye)|0,M=M+Math.imul(Q,se)|0,g=g+Math.imul(_e,Ie)|0,h=h+Math.imul(_e,te)|0,h=h+Math.imul(re,Ie)|0,M=M+Math.imul(re,te)|0,g=g+Math.imul(we,Ne)|0,h=h+Math.imul(we,ue)|0,h=h+Math.imul(ee,Ne)|0,M=M+Math.imul(ee,ue)|0,g=g+Math.imul(Se,$e)|0,h=h+Math.imul(Se,fe)|0,h=h+Math.imul(ne,$e)|0,M=M+Math.imul(ne,fe)|0,g=g+Math.imul(be,me)|0,h=h+Math.imul(be,de)|0,h=h+Math.imul(ie,me)|0,M=M+Math.imul(ie,de)|0,g=g+Math.imul(ge,Te)|0,h=h+Math.imul(ge,le)|0,h=h+Math.imul(Y,Te)|0,M=M+Math.imul(Y,le)|0,g=g+Math.imul(H,ve)|0,h=h+Math.imul(H,De)|0,h=h+Math.imul(V,ve)|0,M=M+Math.imul(V,De)|0;var Bt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,g=Math.imul(Ae,Re),h=Math.imul(Ae,ce),h=h+Math.imul(he,Re)|0,M=Math.imul(he,ce),g=g+Math.imul(Me,ye)|0,h=h+Math.imul(Me,se)|0,h=h+Math.imul(Z,ye)|0,M=M+Math.imul(Z,se)|0,g=g+Math.imul(xe,Ie)|0,h=h+Math.imul(xe,te)|0,h=h+Math.imul(Q,Ie)|0,M=M+Math.imul(Q,te)|0,g=g+Math.imul(_e,Ne)|0,h=h+Math.imul(_e,ue)|0,h=h+Math.imul(re,Ne)|0,M=M+Math.imul(re,ue)|0,g=g+Math.imul(we,$e)|0,h=h+Math.imul(we,fe)|0,h=h+Math.imul(ee,$e)|0,M=M+Math.imul(ee,fe)|0,g=g+Math.imul(Se,me)|0,h=h+Math.imul(Se,de)|0,h=h+Math.imul(ne,me)|0,M=M+Math.imul(ne,de)|0,g=g+Math.imul(be,Te)|0,h=h+Math.imul(be,le)|0,h=h+Math.imul(ie,Te)|0,M=M+Math.imul(ie,le)|0,g=g+Math.imul(ge,ve)|0,h=h+Math.imul(ge,De)|0,h=h+Math.imul(Y,ve)|0,M=M+Math.imul(Y,De)|0;var fr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(fr>>>26)|0,fr&=67108863,g=Math.imul(Ae,ye),h=Math.imul(Ae,se),h=h+Math.imul(he,ye)|0,M=Math.imul(he,se),g=g+Math.imul(Me,Ie)|0,h=h+Math.imul(Me,te)|0,h=h+Math.imul(Z,Ie)|0,M=M+Math.imul(Z,te)|0,g=g+Math.imul(xe,Ne)|0,h=h+Math.imul(xe,ue)|0,h=h+Math.imul(Q,Ne)|0,M=M+Math.imul(Q,ue)|0,g=g+Math.imul(_e,$e)|0,h=h+Math.imul(_e,fe)|0,h=h+Math.imul(re,$e)|0,M=M+Math.imul(re,fe)|0,g=g+Math.imul(we,me)|0,h=h+Math.imul(we,de)|0,h=h+Math.imul(ee,me)|0,M=M+Math.imul(ee,de)|0,g=g+Math.imul(Se,Te)|0,h=h+Math.imul(Se,le)|0,h=h+Math.imul(ne,Te)|0,M=M+Math.imul(ne,le)|0,g=g+Math.imul(be,ve)|0,h=h+Math.imul(be,De)|0,h=h+Math.imul(ie,ve)|0,M=M+Math.imul(ie,De)|0;var hr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(hr>>>26)|0,hr&=67108863,g=Math.imul(Ae,Ie),h=Math.imul(Ae,te),h=h+Math.imul(he,Ie)|0,M=Math.imul(he,te),g=g+Math.imul(Me,Ne)|0,h=h+Math.imul(Me,ue)|0,h=h+Math.imul(Z,Ne)|0,M=M+Math.imul(Z,ue)|0,g=g+Math.imul(xe,$e)|0,h=h+Math.imul(xe,fe)|0,h=h+Math.imul(Q,$e)|0,M=M+Math.imul(Q,fe)|0,g=g+Math.imul(_e,me)|0,h=h+Math.imul(_e,de)|0,h=h+Math.imul(re,me)|0,M=M+Math.imul(re,de)|0,g=g+Math.imul(we,Te)|0,h=h+Math.imul(we,le)|0,h=h+Math.imul(ee,Te)|0,M=M+Math.imul(ee,le)|0,g=g+Math.imul(Se,ve)|0,h=h+Math.imul(Se,De)|0,h=h+Math.imul(ne,ve)|0,M=M+Math.imul(ne,De)|0;var mt=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(mt>>>26)|0,mt&=67108863,g=Math.imul(Ae,Ne),h=Math.imul(Ae,ue),h=h+Math.imul(he,Ne)|0,M=Math.imul(he,ue),g=g+Math.imul(Me,$e)|0,h=h+Math.imul(Me,fe)|0,h=h+Math.imul(Z,$e)|0,M=M+Math.imul(Z,fe)|0,g=g+Math.imul(xe,me)|0,h=h+Math.imul(xe,de)|0,h=h+Math.imul(Q,me)|0,M=M+Math.imul(Q,de)|0,g=g+Math.imul(_e,Te)|0,h=h+Math.imul(_e,le)|0,h=h+Math.imul(re,Te)|0,M=M+Math.imul(re,le)|0,g=g+Math.imul(we,ve)|0,h=h+Math.imul(we,De)|0,h=h+Math.imul(ee,ve)|0,M=M+Math.imul(ee,De)|0;var cr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(cr>>>26)|0,cr&=67108863,g=Math.imul(Ae,$e),h=Math.imul(Ae,fe),h=h+Math.imul(he,$e)|0,M=Math.imul(he,fe),g=g+Math.imul(Me,me)|0,h=h+Math.imul(Me,de)|0,h=h+Math.imul(Z,me)|0,M=M+Math.imul(Z,de)|0,g=g+Math.imul(xe,Te)|0,h=h+Math.imul(xe,le)|0,h=h+Math.imul(Q,Te)|0,M=M+Math.imul(Q,le)|0,g=g+Math.imul(_e,ve)|0,h=h+Math.imul(_e,De)|0,h=h+Math.imul(re,ve)|0,M=M+Math.imul(re,De)|0;var ur=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ur>>>26)|0,ur&=67108863,g=Math.imul(Ae,me),h=Math.imul(Ae,de),h=h+Math.imul(he,me)|0,M=Math.imul(he,de),g=g+Math.imul(Me,Te)|0,h=h+Math.imul(Me,le)|0,h=h+Math.imul(Z,Te)|0,M=M+Math.imul(Z,le)|0,g=g+Math.imul(xe,ve)|0,h=h+Math.imul(xe,De)|0,h=h+Math.imul(Q,ve)|0,M=M+Math.imul(Q,De)|0;var dr=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(dr>>>26)|0,dr&=67108863,g=Math.imul(Ae,Te),h=Math.imul(Ae,le),h=h+Math.imul(he,Te)|0,M=Math.imul(he,le),g=g+Math.imul(Me,ve)|0,h=h+Math.imul(Me,De)|0,h=h+Math.imul(Z,ve)|0,M=M+Math.imul(Z,De)|0;var ai=(l+g|0)+((h&8191)<<13)|0;l=(M+(h>>>13)|0)+(ai>>>26)|0,ai&=67108863,g=Math.imul(Ae,ve),h=Math.imul(Ae,De),h=h+Math.imul(he,ve)|0,M=Math.imul(he,De);var oi=(l+g|0)+((h&8191)<<13)|0;return l=(M+(h>>>13)|0)+(oi>>>26)|0,oi&=67108863,m[0]=Qt,m[1]=er,m[2]=tr,m[3]=rr,m[4]=yt,m[5]=ir,m[6]=nr,m[7]=sr,m[8]=ar,m[9]=or,m[10]=Bt,m[11]=fr,m[12]=hr,m[13]=mt,m[14]=cr,m[15]=ur,m[16]=dr,m[17]=ai,m[18]=oi,l!==0&&(m[19]=l,u.length++),u};Math.imul||(N=R);function C(d,a,f){f.negative=a.negative^d.negative,f.length=d.length+a.length;for(var u=0,v=0,y=0;y<f.length-1;y++){var m=v;v=0;for(var l=u&67108863,g=Math.min(y,a.length-1),h=Math.max(0,y-d.length+1);h<=g;h++){var M=y-h,T=d.words[M]|0,$=a.words[h]|0,q=T*$,G=q&67108863;m=m+(q/67108864|0)|0,G=G+l|0,l=G&67108863,m=m+(G>>>26)|0,v+=m>>>26,m&=67108863}f.words[y]=l,u=m,m=v}return u!==0?f.words[y]=u:f.length--,f._strip()}function L(d,a,f){return C(d,a,f)}n.prototype.mulTo=function(a,f){var u,v=this.length+a.length;return this.length===10&&a.length===10?u=N(this,a,f):v<63?u=R(this,a,f):v<1024?u=C(this,a,f):u=L(this,a,f),u},n.prototype.mul=function(a){var f=new n(null);return f.words=new Array(this.length+a.length),this.mulTo(a,f)},n.prototype.mulf=function(a){var f=new n(null);return f.words=new Array(this.length+a.length),L(this,a,f)},n.prototype.imul=function(a){return this.clone().mulTo(a,this)},n.prototype.imuln=function(a){var f=a<0;f&&(a=-a),i(typeof a=="number"),i(a<67108864);for(var u=0,v=0;v<this.length;v++){var y=(this.words[v]|0)*a,m=(y&67108863)+(u&67108863);u>>=26,u+=y/67108864|0,u+=m>>>26,this.words[v]=m&67108863}return u!==0&&(this.words[v]=u,this.length++),f?this.ineg():this},n.prototype.muln=function(a){return this.clone().imuln(a)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(a){var f=P(a);if(f.length===0)return new n(1);for(var u=this,v=0;v<f.length&&f[v]===0;v++,u=u.sqr());if(++v<f.length)for(var y=u.sqr();v<f.length;v++,y=y.sqr())f[v]!==0&&(u=u.mul(y));return u},n.prototype.iushln=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26,v=67108863>>>26-f<<26-f,y;if(f!==0){var m=0;for(y=0;y<this.length;y++){var l=this.words[y]&v,g=(this.words[y]|0)-l<<f;this.words[y]=g|m,m=l>>>26-f}m&&(this.words[y]=m,this.length++)}if(u!==0){for(y=this.length-1;y>=0;y--)this.words[y+u]=this.words[y];for(y=0;y<u;y++)this.words[y]=0;this.length+=u}return this._strip()},n.prototype.ishln=function(a){return i(this.negative===0),this.iushln(a)},n.prototype.iushrn=function(a,f,u){i(typeof a=="number"&&a>=0);var v;f?v=(f-f%26)/26:v=0;var y=a%26,m=Math.min((a-y)/26,this.length),l=67108863^67108863>>>y<<y,g=u;if(v-=m,v=Math.max(0,v),g){for(var h=0;h<m;h++)g.words[h]=this.words[h];g.length=m}if(m!==0)if(this.length>m)for(this.length-=m,h=0;h<this.length;h++)this.words[h]=this.words[h+m];else this.words[0]=0,this.length=1;var M=0;for(h=this.length-1;h>=0&&(M!==0||h>=v);h--){var T=this.words[h]|0;this.words[h]=M<<26-y|T>>>y,M=T&l}return g&&M!==0&&(g.words[g.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(a,f,u){return i(this.negative===0),this.iushrn(a,f,u)},n.prototype.shln=function(a){return this.clone().ishln(a)},n.prototype.ushln=function(a){return this.clone().iushln(a)},n.prototype.shrn=function(a){return this.clone().ishrn(a)},n.prototype.ushrn=function(a){return this.clone().iushrn(a)},n.prototype.testn=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26,v=1<<f;if(this.length<=u)return!1;var y=this.words[u];return!!(y&v)},n.prototype.imaskn=function(a){i(typeof a=="number"&&a>=0);var f=a%26,u=(a-f)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=u)return this;if(f!==0&&u++,this.length=Math.min(u,this.length),f!==0){var v=67108863^67108863>>>f<<f;this.words[this.length-1]&=v}return this._strip()},n.prototype.maskn=function(a){return this.clone().imaskn(a)},n.prototype.iaddn=function(a){return i(typeof a=="number"),i(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<=a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},n.prototype._iaddn=function(a){this.words[0]+=a;for(var f=0;f<this.length&&this.words[f]>=67108864;f++)this.words[f]-=67108864,f===this.length-1?this.words[f+1]=1:this.words[f+1]++;return this.length=Math.max(this.length,f+1),this},n.prototype.isubn=function(a){if(i(typeof a=="number"),i(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var f=0;f<this.length&&this.words[f]<0;f++)this.words[f]+=67108864,this.words[f+1]-=1;return this._strip()},n.prototype.addn=function(a){return this.clone().iaddn(a)},n.prototype.subn=function(a){return this.clone().isubn(a)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(a,f,u){var v=a.length+u,y;this._expand(v);var m,l=0;for(y=0;y<a.length;y++){m=(this.words[y+u]|0)+l;var g=(a.words[y]|0)*f;m-=g&67108863,l=(m>>26)-(g/67108864|0),this.words[y+u]=m&67108863}for(;y<this.length-u;y++)m=(this.words[y+u]|0)+l,l=m>>26,this.words[y+u]=m&67108863;if(l===0)return this._strip();for(i(l===-1),l=0,y=0;y<this.length;y++)m=-(this.words[y]|0)+l,l=m>>26,this.words[y]=m&67108863;return this.negative=1,this._strip()},n.prototype._wordDiv=function(a,f){var u=this.length-a.length,v=this.clone(),y=a,m=y.words[y.length-1]|0,l=this._countBits(m);u=26-l,u!==0&&(y=y.ushln(u),v.iushln(u),m=y.words[y.length-1]|0);var g=v.length-y.length,h;if(f!=="mod"){h=new n(null),h.length=g+1,h.words=new Array(h.length);for(var M=0;M<h.length;M++)h.words[M]=0}var T=v.clone()._ishlnsubmul(y,1,g);T.negative===0&&(v=T,h&&(h.words[g]=1));for(var $=g-1;$>=0;$--){var q=(v.words[y.length+$]|0)*67108864+(v.words[y.length+$-1]|0);for(q=Math.min(q/m|0,67108863),v._ishlnsubmul(y,q,$);v.negative!==0;)q--,v.negative=0,v._ishlnsubmul(y,1,$),v.isZero()||(v.negative^=1);h&&(h.words[$]=q)}return h&&h._strip(),v._strip(),f!=="div"&&u!==0&&v.iushrn(u),{div:h||null,mod:v}},n.prototype.divmod=function(a,f,u){if(i(!a.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var v,y,m;return this.negative!==0&&a.negative===0?(m=this.neg().divmod(a,f),f!=="mod"&&(v=m.div.neg()),f!=="div"&&(y=m.mod.neg(),u&&y.negative!==0&&y.iadd(a)),{div:v,mod:y}):this.negative===0&&a.negative!==0?(m=this.divmod(a.neg(),f),f!=="mod"&&(v=m.div.neg()),{div:v,mod:m.mod}):this.negative&a.negative?(m=this.neg().divmod(a.neg(),f),f!=="div"&&(y=m.mod.neg(),u&&y.negative!==0&&y.isub(a)),{div:m.div,mod:y}):a.length>this.length||this.cmp(a)<0?{div:new n(0),mod:this}:a.length===1?f==="div"?{div:this.divn(a.words[0]),mod:null}:f==="mod"?{div:null,mod:new n(this.modrn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new n(this.modrn(a.words[0]))}:this._wordDiv(a,f)},n.prototype.div=function(a){return this.divmod(a,"div",!1).div},n.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},n.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},n.prototype.divRound=function(a){var f=this.divmod(a);if(f.mod.isZero())return f.div;var u=f.div.negative!==0?f.mod.isub(a):f.mod,v=a.ushrn(1),y=a.andln(1),m=u.cmp(v);return m<0||y===1&&m===0?f.div:f.div.negative!==0?f.div.isubn(1):f.div.iaddn(1)},n.prototype.modrn=function(a){var f=a<0;f&&(a=-a),i(a<=67108863);for(var u=(1<<26)%a,v=0,y=this.length-1;y>=0;y--)v=(u*v+(this.words[y]|0))%a;return f?-v:v},n.prototype.modn=function(a){return this.modrn(a)},n.prototype.idivn=function(a){var f=a<0;f&&(a=-a),i(a<=67108863);for(var u=0,v=this.length-1;v>=0;v--){var y=(this.words[v]|0)+u*67108864;this.words[v]=y/a|0,u=y%a}return this._strip(),f?this.ineg():this},n.prototype.divn=function(a){return this.clone().idivn(a)},n.prototype.egcd=function(a){i(a.negative===0),i(!a.isZero());var f=this,u=a.clone();f.negative!==0?f=f.umod(a):f=f.clone();for(var v=new n(1),y=new n(0),m=new n(0),l=new n(1),g=0;f.isEven()&&u.isEven();)f.iushrn(1),u.iushrn(1),++g;for(var h=u.clone(),M=f.clone();!f.isZero();){for(var T=0,$=1;!(f.words[0]&$)&&T<26;++T,$<<=1);if(T>0)for(f.iushrn(T);T-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(h),y.isub(M)),v.iushrn(1),y.iushrn(1);for(var q=0,G=1;!(u.words[0]&G)&&q<26;++q,G<<=1);if(q>0)for(u.iushrn(q);q-- >0;)(m.isOdd()||l.isOdd())&&(m.iadd(h),l.isub(M)),m.iushrn(1),l.iushrn(1);f.cmp(u)>=0?(f.isub(u),v.isub(m),y.isub(l)):(u.isub(f),m.isub(v),l.isub(y))}return{a:m,b:l,gcd:u.iushln(g)}},n.prototype._invmp=function(a){i(a.negative===0),i(!a.isZero());var f=this,u=a.clone();f.negative!==0?f=f.umod(a):f=f.clone();for(var v=new n(1),y=new n(0),m=u.clone();f.cmpn(1)>0&&u.cmpn(1)>0;){for(var l=0,g=1;!(f.words[0]&g)&&l<26;++l,g<<=1);if(l>0)for(f.iushrn(l);l-- >0;)v.isOdd()&&v.iadd(m),v.iushrn(1);for(var h=0,M=1;!(u.words[0]&M)&&h<26;++h,M<<=1);if(h>0)for(u.iushrn(h);h-- >0;)y.isOdd()&&y.iadd(m),y.iushrn(1);f.cmp(u)>=0?(f.isub(u),v.isub(y)):(u.isub(f),y.isub(v))}var T;return f.cmpn(1)===0?T=v:T=y,T.cmpn(0)<0&&T.iadd(a),T},n.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var f=this.clone(),u=a.clone();f.negative=0,u.negative=0;for(var v=0;f.isEven()&&u.isEven();v++)f.iushrn(1),u.iushrn(1);do{for(;f.isEven();)f.iushrn(1);for(;u.isEven();)u.iushrn(1);var y=f.cmp(u);if(y<0){var m=f;f=u,u=m}else if(y===0||u.cmpn(1)===0)break;f.isub(u)}while(!0);return u.iushln(v)},n.prototype.invm=function(a){return this.egcd(a).a.umod(a)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(a){return this.words[0]&a},n.prototype.bincn=function(a){i(typeof a=="number");var f=a%26,u=(a-f)/26,v=1<<f;if(this.length<=u)return this._expand(u+1),this.words[u]|=v,this;for(var y=v,m=u;y!==0&&m<this.length;m++){var l=this.words[m]|0;l+=y,y=l>>>26,l&=67108863,this.words[m]=l}return y!==0&&(this.words[m]=y,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(a){var f=a<0;if(this.negative!==0&&!f)return-1;if(this.negative===0&&f)return 1;this._strip();var u;if(this.length>1)u=1;else{f&&(a=-a),i(a<=67108863,"Number is too big");var v=this.words[0]|0;u=v===a?0:v<a?-1:1}return this.negative!==0?-u|0:u},n.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var f=this.ucmp(a);return this.negative!==0?-f|0:f},n.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var f=0,u=this.length-1;u>=0;u--){var v=this.words[u]|0,y=a.words[u]|0;if(v!==y){v<y?f=-1:v>y&&(f=1);break}}return f},n.prototype.gtn=function(a){return this.cmpn(a)===1},n.prototype.gt=function(a){return this.cmp(a)===1},n.prototype.gten=function(a){return this.cmpn(a)>=0},n.prototype.gte=function(a){return this.cmp(a)>=0},n.prototype.ltn=function(a){return this.cmpn(a)===-1},n.prototype.lt=function(a){return this.cmp(a)===-1},n.prototype.lten=function(a){return this.cmpn(a)<=0},n.prototype.lte=function(a){return this.cmp(a)<=0},n.prototype.eqn=function(a){return this.cmpn(a)===0},n.prototype.eq=function(a){return this.cmp(a)===0},n.red=function(a){return new A(a)},n.prototype.toRed=function(a){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(a){return this.red=a,this},n.prototype.forceRed=function(a){return i(!this.red,"Already a number in reduction context"),this._forceRed(a)},n.prototype.redAdd=function(a){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},n.prototype.redIAdd=function(a){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},n.prototype.redSub=function(a){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},n.prototype.redISub=function(a){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},n.prototype.redShl=function(a){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},n.prototype.redMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},n.prototype.redIMul=function(a){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(a){return i(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var B={k256:null,p224:null,p192:null,p25519:null};function U(d,a){this.name=d,this.p=new n(a,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}U.prototype._tmp=function(){var a=new n(null);return a.words=new Array(Math.ceil(this.n/13)),a},U.prototype.ireduce=function(a){var f=a,u;do this.split(f,this.tmp),f=this.imulK(f),f=f.iadd(this.tmp),u=f.bitLength();while(u>this.n);var v=u<this.n?-1:f.ucmp(this.p);return v===0?(f.words[0]=0,f.length=1):v>0?f.isub(this.p):f.strip!==void 0?f.strip():f._strip(),f},U.prototype.split=function(a,f){a.iushrn(this.n,0,f)},U.prototype.imulK=function(a){return a.imul(this.k)};function K(){U.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(K,U),K.prototype.split=function(a,f){for(var u=4194303,v=Math.min(a.length,9),y=0;y<v;y++)f.words[y]=a.words[y];if(f.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var m=a.words[9];for(f.words[f.length++]=m&u,y=10;y<a.length;y++){var l=a.words[y]|0;a.words[y-10]=(l&u)<<4|m>>>22,m=l}m>>>=22,a.words[y-10]=m,m===0&&a.length>10?a.length-=10:a.length-=9},K.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var f=0,u=0;u<a.length;u++){var v=a.words[u]|0;f+=v*977,a.words[u]=f&67108863,f=v*64+(f/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function k(){U.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(k,U);function z(){U.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(z,U);function pe(){U.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(pe,U),pe.prototype.imulK=function(a){for(var f=0,u=0;u<a.length;u++){var v=(a.words[u]|0)*19+f,y=v&67108863;v>>>=26,a.words[u]=y,f=v}return f!==0&&(a.words[a.length++]=f),a},n._prime=function(a){if(B[a])return B[a];var f;if(a==="k256")f=new K;else if(a==="p224")f=new k;else if(a==="p192")f=new z;else if(a==="p25519")f=new pe;else throw new Error("Unknown prime "+a);return B[a]=f,f};function A(d){if(typeof d=="string"){var a=n._prime(d);this.m=a.p,this.prime=a}else i(d.gtn(1),"modulus must be greater than 1"),this.m=d,this.prime=null}A.prototype._verify1=function(a){i(a.negative===0,"red works only with positives"),i(a.red,"red works only with red numbers")},A.prototype._verify2=function(a,f){i((a.negative|f.negative)===0,"red works only with positives"),i(a.red&&a.red===f.red,"red works only with red numbers")},A.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(w(a,a.umod(this.m)._forceRed(this)),a)},A.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},A.prototype.add=function(a,f){this._verify2(a,f);var u=a.add(f);return u.cmp(this.m)>=0&&u.isub(this.m),u._forceRed(this)},A.prototype.iadd=function(a,f){this._verify2(a,f);var u=a.iadd(f);return u.cmp(this.m)>=0&&u.isub(this.m),u},A.prototype.sub=function(a,f){this._verify2(a,f);var u=a.sub(f);return u.cmpn(0)<0&&u.iadd(this.m),u._forceRed(this)},A.prototype.isub=function(a,f){this._verify2(a,f);var u=a.isub(f);return u.cmpn(0)<0&&u.iadd(this.m),u},A.prototype.shl=function(a,f){return this._verify1(a),this.imod(a.ushln(f))},A.prototype.imul=function(a,f){return this._verify2(a,f),this.imod(a.imul(f))},A.prototype.mul=function(a,f){return this._verify2(a,f),this.imod(a.mul(f))},A.prototype.isqr=function(a){return this.imul(a,a.clone())},A.prototype.sqr=function(a){return this.mul(a,a)},A.prototype.sqrt=function(a){if(a.isZero())return a.clone();var f=this.m.andln(3);if(i(f%2===1),f===3){var u=this.m.add(new n(1)).iushrn(2);return this.pow(a,u)}for(var v=this.m.subn(1),y=0;!v.isZero()&&v.andln(1)===0;)y++,v.iushrn(1);i(!v.isZero());var m=new n(1).toRed(this),l=m.redNeg(),g=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new n(2*h*h).toRed(this);this.pow(h,g).cmp(l)!==0;)h.redIAdd(l);for(var M=this.pow(h,v),T=this.pow(a,v.addn(1).iushrn(1)),$=this.pow(a,v),q=y;$.cmp(m)!==0;){for(var G=$,H=0;G.cmp(m)!==0;H++)G=G.redSqr();i(H<q);var V=this.pow(M,new n(1).iushln(q-H-1));T=T.redMul(V),M=V.redSqr(),$=$.redMul(M),q=H}return T},A.prototype.invm=function(a){var f=a._invmp(this.m);return f.negative!==0?(f.negative=0,this.imod(f).redNeg()):this.imod(f)},A.prototype.pow=function(a,f){if(f.isZero())return new n(1).toRed(this);if(f.cmpn(1)===0)return a.clone();var u=4,v=new Array(1<<u);v[0]=new n(1).toRed(this),v[1]=a;for(var y=2;y<v.length;y++)v[y]=this.mul(v[y-1],a);var m=v[0],l=0,g=0,h=f.bitLength()%26;for(h===0&&(h=26),y=f.length-1;y>=0;y--){for(var M=f.words[y],T=h-1;T>=0;T--){var $=M>>T&1;if(m!==v[0]&&(m=this.sqr(m)),$===0&&l===0){g=0;continue}l<<=1,l|=$,g++,!(g!==u&&(y!==0||T!==0))&&(m=this.mul(m,v[l]),g=0,l=0)}h=26}return m},A.prototype.convertTo=function(a){var f=a.umod(this.m);return f===a?f.clone():f},A.prototype.convertFrom=function(a){var f=a.clone();return f.red=null,f},n.mont=function(a){return new _(a)};function _(d){A.call(this,d),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(_,A),_.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},_.prototype.convertFrom=function(a){var f=this.imod(a.mul(this.rinv));return f.red=null,f},_.prototype.imul=function(a,f){if(a.isZero()||f.isZero())return a.words[0]=0,a.length=1,a;var u=a.imul(f),v=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=u.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},_.prototype.mul=function(a,f){if(a.isZero()||f.isZero())return new n(0)._forceRed(this);var u=a.mul(f),v=u.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=u.isub(v).iushrn(this.shift),m=y;return y.cmp(this.m)>=0?m=y.isub(this.m):y.cmpn(0)<0&&(m=y.iadd(this.m)),m._forceRed(this)},_.prototype.invm=function(a){var f=this.imod(a._invmp(this.m).mul(this.r2));return f._forceRed(this)}})(t,Zi)})(Of);var gm=Of.exports;const Fe=Tn(gm);var xs={},Ue={},hn=Pd;function Pd(t,e){if(!t)throw new Error(e||"Assertion failed")}Pd.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var Jo={exports:{}};typeof Object.create=="function"?Jo.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Jo.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}};var Oa=Jo.exports,vm=hn,bm=Oa;Ue.inherits=bm;function mm(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function ym(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),s=0;s<t.length;s+=2)r.push(parseInt(t[s]+t[s+1],16))}else for(var i=0,s=0;s<t.length;s++){var n=t.charCodeAt(s);n<128?r[i++]=n:n<2048?(r[i++]=n>>6|192,r[i++]=n&63|128):mm(t,s)?(n=65536+((n&1023)<<10)+(t.charCodeAt(++s)&1023),r[i++]=n>>18|240,r[i++]=n>>12&63|128,r[i++]=n>>6&63|128,r[i++]=n&63|128):(r[i++]=n>>12|224,r[i++]=n>>6&63|128,r[i++]=n&63|128)}else for(s=0;s<t.length;s++)r[s]=t[s]|0;return r}Ue.toArray=ym;function wm(t){for(var e="",r=0;r<t.length;r++)e+=Nd(t[r].toString(16));return e}Ue.toHex=wm;function Rd(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Ue.htonl=Rd;function _m(t,e){for(var r="",i=0;i<t.length;i++){var s=t[i];e==="little"&&(s=Rd(s)),r+=$d(s.toString(16))}return r}Ue.toHex32=_m;function Nd(t){return t.length===1?"0"+t:t}Ue.zero2=Nd;function $d(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Ue.zero8=$d;function xm(t,e,r,i){var s=r-e;vm(s%4===0);for(var n=new Array(s/4),o=0,c=e;o<n.length;o++,c+=4){var p;i==="big"?p=t[c]<<24|t[c+1]<<16|t[c+2]<<8|t[c+3]:p=t[c+3]<<24|t[c+2]<<16|t[c+1]<<8|t[c],n[o]=p>>>0}return n}Ue.join32=xm;function Mm(t,e){for(var r=new Array(t.length*4),i=0,s=0;i<t.length;i++,s+=4){var n=t[i];e==="big"?(r[s]=n>>>24,r[s+1]=n>>>16&255,r[s+2]=n>>>8&255,r[s+3]=n&255):(r[s+3]=n>>>24,r[s+2]=n>>>16&255,r[s+1]=n>>>8&255,r[s]=n&255)}return r}Ue.split32=Mm;function Em(t,e){return t>>>e|t<<32-e}Ue.rotr32=Em;function Sm(t,e){return t<<e|t>>>32-e}Ue.rotl32=Sm;function Im(t,e){return t+e>>>0}Ue.sum32=Im;function Am(t,e,r){return t+e+r>>>0}Ue.sum32_3=Am;function Dm(t,e,r,i){return t+e+r+i>>>0}Ue.sum32_4=Dm;function Om(t,e,r,i,s){return t+e+r+i+s>>>0}Ue.sum32_5=Om;function Pm(t,e,r,i){var s=t[e],n=t[e+1],o=i+n>>>0,c=(o<i?1:0)+r+s;t[e]=c>>>0,t[e+1]=o}Ue.sum64=Pm;function Rm(t,e,r,i){var s=e+i>>>0,n=(s<e?1:0)+t+r;return n>>>0}Ue.sum64_hi=Rm;function Nm(t,e,r,i){var s=e+i;return s>>>0}Ue.sum64_lo=Nm;function $m(t,e,r,i,s,n,o,c){var p=0,b=e;b=b+i>>>0,p+=b<e?1:0,b=b+n>>>0,p+=b<n?1:0,b=b+c>>>0,p+=b<c?1:0;var w=t+r+s+o+p;return w>>>0}Ue.sum64_4_hi=$m;function Tm(t,e,r,i,s,n,o,c){var p=e+i+n+c;return p>>>0}Ue.sum64_4_lo=Tm;function Fm(t,e,r,i,s,n,o,c,p,b){var w=0,x=e;x=x+i>>>0,w+=x<e?1:0,x=x+n>>>0,w+=x<n?1:0,x=x+c>>>0,w+=x<c?1:0,x=x+b>>>0,w+=x<b?1:0;var E=t+r+s+o+p+w;return E>>>0}Ue.sum64_5_hi=Fm;function Cm(t,e,r,i,s,n,o,c,p,b){var w=e+i+n+c+b;return w>>>0}Ue.sum64_5_lo=Cm;function Lm(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}Ue.rotr64_hi=Lm;function qm(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Ue.rotr64_lo=qm;function Bm(t,e,r){return t>>>r}Ue.shr64_hi=Bm;function Um(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}Ue.shr64_lo=Um;var qn={},sc=Ue,zm=hn;function Pa(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}qn.BlockHash=Pa;Pa.prototype.update=function(e,r){if(e=sc.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=sc.join32(e,0,e.length-i,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this};Pa.prototype.digest=function(e){return this.update(this._pad()),zm(this.pending===null),this._digest(e)};Pa.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,s=new Array(i+this.padLength);s[0]=128;for(var n=1;n<i;n++)s[n]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)s[n++]=0;s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=e>>>24&255,s[n++]=e>>>16&255,s[n++]=e>>>8&255,s[n++]=e&255}else for(s[n++]=e&255,s[n++]=e>>>8&255,s[n++]=e>>>16&255,s[n++]=e>>>24&255,s[n++]=0,s[n++]=0,s[n++]=0,s[n++]=0,o=8;o<this.padLength;o++)s[n++]=0;return s};var Bn={},ni={},km=Ue,Yr=km.rotr32;function jm(t,e,r,i){if(t===0)return Td(e,r,i);if(t===1||t===3)return Cd(e,r,i);if(t===2)return Fd(e,r,i)}ni.ft_1=jm;function Td(t,e,r){return t&e^~t&r}ni.ch32=Td;function Fd(t,e,r){return t&e^t&r^e&r}ni.maj32=Fd;function Cd(t,e,r){return t^e^r}ni.p32=Cd;function Km(t){return Yr(t,2)^Yr(t,13)^Yr(t,22)}ni.s0_256=Km;function Vm(t){return Yr(t,6)^Yr(t,11)^Yr(t,25)}ni.s1_256=Vm;function Hm(t){return Yr(t,7)^Yr(t,18)^t>>>3}ni.g0_256=Hm;function Wm(t){return Yr(t,17)^Yr(t,19)^t>>>10}ni.g1_256=Wm;var An=Ue,Gm=qn,Jm=ni,lo=An.rotl32,Xn=An.sum32,Zm=An.sum32_5,Ym=Jm.ft_1,Ld=Gm.BlockHash,Xm=[1518500249,1859775393,2400959708,3395469782];function ei(){if(!(this instanceof ei))return new ei;Ld.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}An.inherits(ei,Ld);var Qm=ei;ei.blockSize=512;ei.outSize=160;ei.hmacStrength=80;ei.padLength=64;ei.prototype._update=function(e,r){for(var i=this.W,s=0;s<16;s++)i[s]=e[r+s];for(;s<i.length;s++)i[s]=lo(i[s-3]^i[s-8]^i[s-14]^i[s-16],1);var n=this.h[0],o=this.h[1],c=this.h[2],p=this.h[3],b=this.h[4];for(s=0;s<i.length;s++){var w=~~(s/20),x=Zm(lo(n,5),Ym(w,o,c,p),b,i[s],Xm[w]);b=p,p=c,c=lo(o,30),o=n,n=x}this.h[0]=Xn(this.h[0],n),this.h[1]=Xn(this.h[1],o),this.h[2]=Xn(this.h[2],c),this.h[3]=Xn(this.h[3],p),this.h[4]=Xn(this.h[4],b)};ei.prototype._digest=function(e){return e==="hex"?An.toHex32(this.h,"big"):An.split32(this.h,"big")};var Dn=Ue,ey=qn,Un=ni,ty=hn,Tr=Dn.sum32,ry=Dn.sum32_4,iy=Dn.sum32_5,ny=Un.ch32,sy=Un.maj32,ay=Un.s0_256,oy=Un.s1_256,fy=Un.g0_256,hy=Un.g1_256,qd=ey.BlockHash,cy=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ti(){if(!(this instanceof ti))return new ti;qd.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=cy,this.W=new Array(64)}Dn.inherits(ti,qd);var Bd=ti;ti.blockSize=512;ti.outSize=256;ti.hmacStrength=192;ti.padLength=64;ti.prototype._update=function(e,r){for(var i=this.W,s=0;s<16;s++)i[s]=e[r+s];for(;s<i.length;s++)i[s]=ry(hy(i[s-2]),i[s-7],fy(i[s-15]),i[s-16]);var n=this.h[0],o=this.h[1],c=this.h[2],p=this.h[3],b=this.h[4],w=this.h[5],x=this.h[6],E=this.h[7];for(ty(this.k.length===i.length),s=0;s<i.length;s++){var I=iy(E,oy(b),ny(b,w,x),this.k[s],i[s]),S=Tr(ay(n),sy(n,o,c));E=x,x=w,w=b,b=Tr(p,I),p=c,c=o,o=n,n=Tr(I,S)}this.h[0]=Tr(this.h[0],n),this.h[1]=Tr(this.h[1],o),this.h[2]=Tr(this.h[2],c),this.h[3]=Tr(this.h[3],p),this.h[4]=Tr(this.h[4],b),this.h[5]=Tr(this.h[5],w),this.h[6]=Tr(this.h[6],x),this.h[7]=Tr(this.h[7],E)};ti.prototype._digest=function(e){return e==="hex"?Dn.toHex32(this.h,"big"):Dn.split32(this.h,"big")};var Zo=Ue,Ud=Bd;function bi(){if(!(this instanceof bi))return new bi;Ud.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Zo.inherits(bi,Ud);var uy=bi;bi.blockSize=512;bi.outSize=224;bi.hmacStrength=192;bi.padLength=64;bi.prototype._digest=function(e){return e==="hex"?Zo.toHex32(this.h.slice(0,7),"big"):Zo.split32(this.h.slice(0,7),"big")};var Zt=Ue,dy=qn,ly=hn,Xr=Zt.rotr64_hi,Qr=Zt.rotr64_lo,zd=Zt.shr64_hi,kd=Zt.shr64_lo,Ei=Zt.sum64,po=Zt.sum64_hi,go=Zt.sum64_lo,py=Zt.sum64_4_hi,gy=Zt.sum64_4_lo,vy=Zt.sum64_5_hi,by=Zt.sum64_5_lo,jd=dy.BlockHash,my=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function kr(){if(!(this instanceof kr))return new kr;jd.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=my,this.W=new Array(160)}Zt.inherits(kr,jd);var Kd=kr;kr.blockSize=1024;kr.outSize=512;kr.hmacStrength=192;kr.padLength=128;kr.prototype._prepareBlock=function(e,r){for(var i=this.W,s=0;s<32;s++)i[s]=e[r+s];for(;s<i.length;s+=2){var n=Oy(i[s-4],i[s-3]),o=Py(i[s-4],i[s-3]),c=i[s-14],p=i[s-13],b=Ay(i[s-30],i[s-29]),w=Dy(i[s-30],i[s-29]),x=i[s-32],E=i[s-31];i[s]=py(n,o,c,p,b,w,x,E),i[s+1]=gy(n,o,c,p,b,w,x,E)}};kr.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,s=this.h[0],n=this.h[1],o=this.h[2],c=this.h[3],p=this.h[4],b=this.h[5],w=this.h[6],x=this.h[7],E=this.h[8],I=this.h[9],S=this.h[10],D=this.h[11],P=this.h[12],R=this.h[13],N=this.h[14],C=this.h[15];ly(this.k.length===i.length);for(var L=0;L<i.length;L+=2){var B=N,U=C,K=Sy(E,I),k=Iy(E,I),z=yy(E,I,S,D,P),pe=wy(E,I,S,D,P,R),A=this.k[L],_=this.k[L+1],d=i[L],a=i[L+1],f=vy(B,U,K,k,z,pe,A,_,d,a),u=by(B,U,K,k,z,pe,A,_,d,a);B=My(s,n),U=Ey(s,n),K=_y(s,n,o,c,p),k=xy(s,n,o,c,p,b);var v=po(B,U,K,k),y=go(B,U,K,k);N=P,C=R,P=S,R=D,S=E,D=I,E=po(w,x,f,u),I=go(x,x,f,u),w=p,x=b,p=o,b=c,o=s,c=n,s=po(f,u,v,y),n=go(f,u,v,y)}Ei(this.h,0,s,n),Ei(this.h,2,o,c),Ei(this.h,4,p,b),Ei(this.h,6,w,x),Ei(this.h,8,E,I),Ei(this.h,10,S,D),Ei(this.h,12,P,R),Ei(this.h,14,N,C)};kr.prototype._digest=function(e){return e==="hex"?Zt.toHex32(this.h,"big"):Zt.split32(this.h,"big")};function yy(t,e,r,i,s){var n=t&r^~t&s;return n<0&&(n+=4294967296),n}function wy(t,e,r,i,s,n){var o=e&i^~e&n;return o<0&&(o+=4294967296),o}function _y(t,e,r,i,s){var n=t&r^t&s^r&s;return n<0&&(n+=4294967296),n}function xy(t,e,r,i,s,n){var o=e&i^e&n^i&n;return o<0&&(o+=4294967296),o}function My(t,e){var r=Xr(t,e,28),i=Xr(e,t,2),s=Xr(e,t,7),n=r^i^s;return n<0&&(n+=4294967296),n}function Ey(t,e){var r=Qr(t,e,28),i=Qr(e,t,2),s=Qr(e,t,7),n=r^i^s;return n<0&&(n+=4294967296),n}function Sy(t,e){var r=Xr(t,e,14),i=Xr(t,e,18),s=Xr(e,t,9),n=r^i^s;return n<0&&(n+=4294967296),n}function Iy(t,e){var r=Qr(t,e,14),i=Qr(t,e,18),s=Qr(e,t,9),n=r^i^s;return n<0&&(n+=4294967296),n}function Ay(t,e){var r=Xr(t,e,1),i=Xr(t,e,8),s=zd(t,e,7),n=r^i^s;return n<0&&(n+=4294967296),n}function Dy(t,e){var r=Qr(t,e,1),i=Qr(t,e,8),s=kd(t,e,7),n=r^i^s;return n<0&&(n+=4294967296),n}function Oy(t,e){var r=Xr(t,e,19),i=Xr(e,t,29),s=zd(t,e,6),n=r^i^s;return n<0&&(n+=4294967296),n}function Py(t,e){var r=Qr(t,e,19),i=Qr(e,t,29),s=kd(t,e,6),n=r^i^s;return n<0&&(n+=4294967296),n}var Yo=Ue,Vd=Kd;function mi(){if(!(this instanceof mi))return new mi;Vd.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Yo.inherits(mi,Vd);var Ry=mi;mi.blockSize=1024;mi.outSize=384;mi.hmacStrength=192;mi.padLength=128;mi.prototype._digest=function(e){return e==="hex"?Yo.toHex32(this.h.slice(0,12),"big"):Yo.split32(this.h.slice(0,12),"big")};Bn.sha1=Qm;Bn.sha224=uy;Bn.sha256=Bd;Bn.sha384=Ry;Bn.sha512=Kd;var Hd={},rn=Ue,Ny=qn,js=rn.rotl32,ac=rn.sum32,Qn=rn.sum32_3,oc=rn.sum32_4,Wd=Ny.BlockHash;function ri(){if(!(this instanceof ri))return new ri;Wd.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}rn.inherits(ri,Wd);Hd.ripemd160=ri;ri.blockSize=512;ri.outSize=160;ri.hmacStrength=192;ri.padLength=64;ri.prototype._update=function(e,r){for(var i=this.h[0],s=this.h[1],n=this.h[2],o=this.h[3],c=this.h[4],p=i,b=s,w=n,x=o,E=c,I=0;I<80;I++){var S=ac(js(oc(i,fc(I,s,n,o),e[Fy[I]+r],$y(I)),Ly[I]),c);i=c,c=o,o=js(n,10),n=s,s=S,S=ac(js(oc(p,fc(79-I,b,w,x),e[Cy[I]+r],Ty(I)),qy[I]),E),p=E,E=x,x=js(w,10),w=b,b=S}S=Qn(this.h[1],n,x),this.h[1]=Qn(this.h[2],o,E),this.h[2]=Qn(this.h[3],c,p),this.h[3]=Qn(this.h[4],i,b),this.h[4]=Qn(this.h[0],s,w),this.h[0]=S};ri.prototype._digest=function(e){return e==="hex"?rn.toHex32(this.h,"little"):rn.split32(this.h,"little")};function fc(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function $y(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function Ty(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var Fy=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Cy=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Ly=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],qy=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],By=Ue,Uy=hn;function On(t,e,r){if(!(this instanceof On))return new On(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(By.toArray(e,r))}var zy=On;On.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),Uy(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};On.prototype.update=function(e,r){return this.inner.update(e,r),this};On.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(t){var e=t;e.utils=Ue,e.common=qn,e.sha=Bn,e.ripemd=Hd,e.hmac=zy,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(xs);const di=Tn(xs);function zn(t,e,r){return r={path:e,exports:{},require:function(i,s){return ky(i,s??r.path)}},t(r,r.exports),r.exports}function ky(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Pf=Gd;function Gd(t,e){if(!t)throw new Error(e||"Assertion failed")}Gd.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var Ur=zn(function(t,e){var r=e;function i(o,c){if(Array.isArray(o))return o.slice();if(!o)return[];var p=[];if(typeof o!="string"){for(var b=0;b<o.length;b++)p[b]=o[b]|0;return p}if(c==="hex"){o=o.replace(/[^a-z0-9]+/ig,""),o.length%2!==0&&(o="0"+o);for(var b=0;b<o.length;b+=2)p.push(parseInt(o[b]+o[b+1],16))}else for(var b=0;b<o.length;b++){var w=o.charCodeAt(b),x=w>>8,E=w&255;x?p.push(x,E):p.push(E)}return p}r.toArray=i;function s(o){return o.length===1?"0"+o:o}r.zero2=s;function n(o){for(var c="",p=0;p<o.length;p++)c+=s(o[p].toString(16));return c}r.toHex=n,r.encode=function(c,p){return p==="hex"?n(c):c}}),mr=zn(function(t,e){var r=e;r.assert=Pf,r.toArray=Ur.toArray,r.zero2=Ur.zero2,r.toHex=Ur.toHex,r.encode=Ur.encode;function i(p,b,w){var x=new Array(Math.max(p.bitLength(),w)+1);x.fill(0);for(var E=1<<b+1,I=p.clone(),S=0;S<x.length;S++){var D,P=I.andln(E-1);I.isOdd()?(P>(E>>1)-1?D=(E>>1)-P:D=P,I.isubn(D)):D=0,x[S]=D,I.iushrn(1)}return x}r.getNAF=i;function s(p,b){var w=[[],[]];p=p.clone(),b=b.clone();for(var x=0,E=0,I;p.cmpn(-x)>0||b.cmpn(-E)>0;){var S=p.andln(3)+x&3,D=b.andln(3)+E&3;S===3&&(S=-1),D===3&&(D=-1);var P;S&1?(I=p.andln(7)+x&7,(I===3||I===5)&&D===2?P=-S:P=S):P=0,w[0].push(P);var R;D&1?(I=b.andln(7)+E&7,(I===3||I===5)&&S===2?R=-D:R=D):R=0,w[1].push(R),2*x===P+1&&(x=1-x),2*E===R+1&&(E=1-E),p.iushrn(1),b.iushrn(1)}return w}r.getJSF=s;function n(p,b,w){var x="_"+b;p.prototype[b]=function(){return this[x]!==void 0?this[x]:this[x]=w.call(this)}}r.cachedProperty=n;function o(p){return typeof p=="string"?r.toArray(p,"hex"):p}r.parseBytes=o;function c(p){return new Fe(p,"hex","le")}r.intFromLE=c}),ha=mr.getNAF,jy=mr.getJSF,ca=mr.assert;function Fi(t,e){this.type=t,this.p=new Fe(e.p,16),this.red=e.prime?Fe.red(e.prime):Fe.mont(this.p),this.zero=new Fe(0).toRed(this.red),this.one=new Fe(1).toRed(this.red),this.two=new Fe(2).toRed(this.red),this.n=e.n&&new Fe(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var cn=Fi;Fi.prototype.point=function(){throw new Error("Not implemented")};Fi.prototype.validate=function(){throw new Error("Not implemented")};Fi.prototype._fixedNafMul=function(e,r){ca(e.precomputed);var i=e._getDoubles(),s=ha(r,1,this._bitLength),n=(1<<i.step+1)-(i.step%2===0?2:1);n/=3;var o=[],c,p;for(c=0;c<s.length;c+=i.step){p=0;for(var b=c+i.step-1;b>=c;b--)p=(p<<1)+s[b];o.push(p)}for(var w=this.jpoint(null,null,null),x=this.jpoint(null,null,null),E=n;E>0;E--){for(c=0;c<o.length;c++)p=o[c],p===E?x=x.mixedAdd(i.points[c]):p===-E&&(x=x.mixedAdd(i.points[c].neg()));w=w.add(x)}return w.toP()};Fi.prototype._wnafMul=function(e,r){var i=4,s=e._getNAFPoints(i);i=s.wnd;for(var n=s.points,o=ha(r,i,this._bitLength),c=this.jpoint(null,null,null),p=o.length-1;p>=0;p--){for(var b=0;p>=0&&o[p]===0;p--)b++;if(p>=0&&b++,c=c.dblp(b),p<0)break;var w=o[p];ca(w!==0),e.type==="affine"?w>0?c=c.mixedAdd(n[w-1>>1]):c=c.mixedAdd(n[-w-1>>1].neg()):w>0?c=c.add(n[w-1>>1]):c=c.add(n[-w-1>>1].neg())}return e.type==="affine"?c.toP():c};Fi.prototype._wnafMulAdd=function(e,r,i,s,n){var o=this._wnafT1,c=this._wnafT2,p=this._wnafT3,b=0,w,x,E;for(w=0;w<s;w++){E=r[w];var I=E._getNAFPoints(e);o[w]=I.wnd,c[w]=I.points}for(w=s-1;w>=1;w-=2){var S=w-1,D=w;if(o[S]!==1||o[D]!==1){p[S]=ha(i[S],o[S],this._bitLength),p[D]=ha(i[D],o[D],this._bitLength),b=Math.max(p[S].length,b),b=Math.max(p[D].length,b);continue}var P=[r[S],null,null,r[D]];r[S].y.cmp(r[D].y)===0?(P[1]=r[S].add(r[D]),P[2]=r[S].toJ().mixedAdd(r[D].neg())):r[S].y.cmp(r[D].y.redNeg())===0?(P[1]=r[S].toJ().mixedAdd(r[D]),P[2]=r[S].add(r[D].neg())):(P[1]=r[S].toJ().mixedAdd(r[D]),P[2]=r[S].toJ().mixedAdd(r[D].neg()));var R=[-3,-1,-5,-7,0,7,5,1,3],N=jy(i[S],i[D]);for(b=Math.max(N[0].length,b),p[S]=new Array(b),p[D]=new Array(b),x=0;x<b;x++){var C=N[0][x]|0,L=N[1][x]|0;p[S][x]=R[(C+1)*3+(L+1)],p[D][x]=0,c[S]=P}}var B=this.jpoint(null,null,null),U=this._wnafT4;for(w=b;w>=0;w--){for(var K=0;w>=0;){var k=!0;for(x=0;x<s;x++)U[x]=p[x][w]|0,U[x]!==0&&(k=!1);if(!k)break;K++,w--}if(w>=0&&K++,B=B.dblp(K),w<0)break;for(x=0;x<s;x++){var z=U[x];z!==0&&(z>0?E=c[x][z-1>>1]:z<0&&(E=c[x][-z-1>>1].neg()),E.type==="affine"?B=B.mixedAdd(E):B=B.add(E))}}for(w=0;w<s;w++)c[w]=null;return n?B:B.toP()};function Dr(t,e){this.curve=t,this.type=e,this.precomputed=null}Fi.BasePoint=Dr;Dr.prototype.eq=function(){throw new Error("Not implemented")};Dr.prototype.validate=function(){return this.curve.validate(this)};Fi.prototype.decodePoint=function(e,r){e=mr.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?ca(e[e.length-1]%2===0):e[0]===7&&ca(e[e.length-1]%2===1);var s=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return s}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Dr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Dr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};Dr.prototype.encode=function(e,r){return mr.encode(this._encode(r),e)};Dr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Dr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Dr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],s=this,n=0;n<r;n+=e){for(var o=0;o<e;o++)s=s.dbl();i.push(s)}return{step:e,points:i}};Dr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,s=i===1?null:this.dbl(),n=1;n<i;n++)r[n]=r[n-1].add(s);return{wnd:e,points:r}};Dr.prototype._getBeta=function(){return null};Dr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var Rf=zn(function(t){typeof Object.create=="function"?t.exports=function(r,i){i&&(r.super_=i,r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(r,i){if(i){r.super_=i;var s=function(){};s.prototype=i.prototype,r.prototype=new s,r.prototype.constructor=r}}}),Ky=mr.assert;function Or(t){cn.call(this,"short",t),this.a=new Fe(t.a,16).toRed(this.red),this.b=new Fe(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Rf(Or,cn);var Vy=Or;Or.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new Fe(e.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);r=s[0].cmp(s[1])<0?s[0]:s[1],r=r.toRed(this.red)}if(e.lambda)i=new Fe(e.lambda,16);else{var n=this._getEndoRoots(this.n);this.g.mul(n[0]).x.cmp(this.g.x.redMul(r))===0?i=n[0]:(i=n[1],Ky(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(c){return{a:new Fe(c.a,16),b:new Fe(c.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};Or.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Fe.mont(e),i=new Fe(2).toRed(r).redInvm(),s=i.redNeg(),n=new Fe(3).toRed(r).redNeg().redSqrt().redMul(i),o=s.redAdd(n).fromRed(),c=s.redSub(n).fromRed();return[o,c]};Or.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,s=this.n.clone(),n=new Fe(1),o=new Fe(0),c=new Fe(0),p=new Fe(1),b,w,x,E,I,S,D,P=0,R,N;i.cmpn(0)!==0;){var C=s.div(i);R=s.sub(C.mul(i)),N=c.sub(C.mul(n));var L=p.sub(C.mul(o));if(!x&&R.cmp(r)<0)b=D.neg(),w=n,x=R.neg(),E=N;else if(x&&++P===2)break;D=R,s=i,i=R,c=n,n=N,p=o,o=L}I=R.neg(),S=N;var B=x.sqr().add(E.sqr()),U=I.sqr().add(S.sqr());return U.cmp(B)>=0&&(I=b,S=w),x.negative&&(x=x.neg(),E=E.neg()),I.negative&&(I=I.neg(),S=S.neg()),[{a:x,b:E},{a:I,b:S}]};Or.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],s=r[1],n=s.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),c=n.mul(i.a),p=o.mul(s.a),b=n.mul(i.b),w=o.mul(s.b),x=e.sub(c).sub(p),E=b.add(w).neg();return{k1:x,k2:E}};Or.prototype.pointFromX=function(e,r){e=new Fe(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=i.redSqrt();if(s.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var n=s.fromRed().isOdd();return(r&&!n||!r&&n)&&(s=s.redNeg()),this.point(e,s)};Or.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,s=this.a.redMul(r),n=r.redSqr().redMul(r).redIAdd(s).redIAdd(this.b);return i.redSqr().redISub(n).cmpn(0)===0};Or.prototype._endoWnafMulAdd=function(e,r,i){for(var s=this._endoWnafT1,n=this._endoWnafT2,o=0;o<e.length;o++){var c=this._endoSplit(r[o]),p=e[o],b=p._getBeta();c.k1.negative&&(c.k1.ineg(),p=p.neg(!0)),c.k2.negative&&(c.k2.ineg(),b=b.neg(!0)),s[o*2]=p,s[o*2+1]=b,n[o*2]=c.k1,n[o*2+1]=c.k2}for(var w=this._wnafMulAdd(1,s,n,o*2,i),x=0;x<o*2;x++)s[x]=null,n[x]=null;return w};function Pt(t,e,r,i){cn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Fe(e,16),this.y=new Fe(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Rf(Pt,cn.BasePoint);Or.prototype.point=function(e,r,i){return new Pt(this,e,r,i)};Or.prototype.pointFromJSON=function(e,r){return Pt.fromJSON(this,e,r)};Pt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,s=function(n){return i.point(n.x.redMul(i.endo.beta),n.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(s)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(s)}}}return r}};Pt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Pt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var s=e.point(r[0],r[1],i);if(!r[2])return s;function n(c){return e.point(c[0],c[1],i)}var o=r[2];return s.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[s].concat(o.doubles.points.map(n))},naf:o.naf&&{wnd:o.naf.wnd,points:[s].concat(o.naf.points.map(n))}},s};Pt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Pt.prototype.isInfinity=function(){return this.inf};Pt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),s=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)};Pt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),s=e.redInvm(),n=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(s),o=n.redSqr().redISub(this.x.redAdd(this.x)),c=n.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,c)};Pt.prototype.getX=function(){return this.x.fromRed()};Pt.prototype.getY=function(){return this.y.fromRed()};Pt.prototype.mul=function(e){return e=new Fe(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Pt.prototype.mulAdd=function(e,r,i){var s=[this,r],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,n):this.curve._wnafMulAdd(1,s,n,2)};Pt.prototype.jmulAdd=function(e,r,i){var s=[this,r],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,n,!0):this.curve._wnafMulAdd(1,s,n,2,!0)};Pt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Pt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,s=function(n){return n.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(s)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(s)}}}return r};Pt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Ft(t,e,r,i){cn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Fe(0)):(this.x=new Fe(e,16),this.y=new Fe(r,16),this.z=new Fe(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Rf(Ft,cn.BasePoint);Or.prototype.jpoint=function(e,r,i){return new Ft(this,e,r,i)};Ft.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),s=this.y.redMul(r).redMul(e);return this.curve.point(i,s)};Ft.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Ft.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),s=this.x.redMul(r),n=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(i.redMul(this.z)),p=s.redSub(n),b=o.redSub(c);if(p.cmpn(0)===0)return b.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var w=p.redSqr(),x=w.redMul(p),E=s.redMul(w),I=b.redSqr().redIAdd(x).redISub(E).redISub(E),S=b.redMul(E.redISub(I)).redISub(o.redMul(x)),D=this.z.redMul(e.z).redMul(p);return this.curve.jpoint(I,S,D)};Ft.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,s=e.x.redMul(r),n=this.y,o=e.y.redMul(r).redMul(this.z),c=i.redSub(s),p=n.redSub(o);if(c.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=c.redSqr(),w=b.redMul(c),x=i.redMul(b),E=p.redSqr().redIAdd(w).redISub(x).redISub(x),I=p.redMul(x.redISub(E)).redISub(n.redMul(w)),S=this.z.redMul(c);return this.curve.jpoint(E,I,S)};Ft.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var s=this.curve.a,n=this.curve.tinv,o=this.x,c=this.y,p=this.z,b=p.redSqr().redSqr(),w=c.redAdd(c);for(r=0;r<e;r++){var x=o.redSqr(),E=w.redSqr(),I=E.redSqr(),S=x.redAdd(x).redIAdd(x).redIAdd(s.redMul(b)),D=o.redMul(E),P=S.redSqr().redISub(D.redAdd(D)),R=D.redISub(P),N=S.redMul(R);N=N.redIAdd(N).redISub(I);var C=w.redMul(p);r+1<e&&(b=b.redMul(I)),o=P,p=C,w=N}return this.curve.jpoint(o,w.redMul(n),p)};Ft.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Ft.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var s=this.x.redSqr(),n=this.y.redSqr(),o=n.redSqr(),c=this.x.redAdd(n).redSqr().redISub(s).redISub(o);c=c.redIAdd(c);var p=s.redAdd(s).redIAdd(s),b=p.redSqr().redISub(c).redISub(c),w=o.redIAdd(o);w=w.redIAdd(w),w=w.redIAdd(w),e=b,r=p.redMul(c.redISub(b)).redISub(w),i=this.y.redAdd(this.y)}else{var x=this.x.redSqr(),E=this.y.redSqr(),I=E.redSqr(),S=this.x.redAdd(E).redSqr().redISub(x).redISub(I);S=S.redIAdd(S);var D=x.redAdd(x).redIAdd(x),P=D.redSqr(),R=I.redIAdd(I);R=R.redIAdd(R),R=R.redIAdd(R),e=P.redISub(S).redISub(S),r=D.redMul(S.redISub(e)).redISub(R),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};Ft.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var s=this.x.redSqr(),n=this.y.redSqr(),o=n.redSqr(),c=this.x.redAdd(n).redSqr().redISub(s).redISub(o);c=c.redIAdd(c);var p=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),b=p.redSqr().redISub(c).redISub(c);e=b;var w=o.redIAdd(o);w=w.redIAdd(w),w=w.redIAdd(w),r=p.redMul(c.redISub(b)).redISub(w),i=this.y.redAdd(this.y)}else{var x=this.z.redSqr(),E=this.y.redSqr(),I=this.x.redMul(E),S=this.x.redSub(x).redMul(this.x.redAdd(x));S=S.redAdd(S).redIAdd(S);var D=I.redIAdd(I);D=D.redIAdd(D);var P=D.redAdd(D);e=S.redSqr().redISub(P),i=this.y.redAdd(this.z).redSqr().redISub(E).redISub(x);var R=E.redSqr();R=R.redIAdd(R),R=R.redIAdd(R),R=R.redIAdd(R),r=S.redMul(D.redISub(e)).redISub(R)}return this.curve.jpoint(e,r,i)};Ft.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,s=this.z,n=s.redSqr().redSqr(),o=r.redSqr(),c=i.redSqr(),p=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(n)),b=r.redAdd(r);b=b.redIAdd(b);var w=b.redMul(c),x=p.redSqr().redISub(w.redAdd(w)),E=w.redISub(x),I=c.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=p.redMul(E).redISub(I),D=i.redAdd(i).redMul(s);return this.curve.jpoint(x,S,D)};Ft.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),s=r.redSqr(),n=e.redAdd(e).redIAdd(e),o=n.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(s);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(o);var p=c.redSqr(),b=s.redIAdd(s);b=b.redIAdd(b),b=b.redIAdd(b),b=b.redIAdd(b);var w=n.redIAdd(c).redSqr().redISub(o).redISub(p).redISub(b),x=r.redMul(w);x=x.redIAdd(x),x=x.redIAdd(x);var E=this.x.redMul(p).redISub(x);E=E.redIAdd(E),E=E.redIAdd(E);var I=this.y.redMul(w.redMul(b.redISub(w)).redISub(c.redMul(p)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=this.z.redAdd(c).redSqr().redISub(i).redISub(p);return this.curve.jpoint(E,I,S)};Ft.prototype.mul=function(e,r){return e=new Fe(e,r),this.curve._wnafMul(this,e)};Ft.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var s=r.redMul(this.z),n=i.redMul(e.z);return this.y.redMul(n).redISub(e.y.redMul(s)).cmpn(0)===0};Ft.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var s=e.clone(),n=this.curve.redN.redMul(r);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(n),this.x.cmp(i)===0)return!0}};Ft.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Ft.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Qs=zn(function(t,e){var r=e;r.base=cn,r.short=Vy,r.mont=null,r.edwards=null}),ea=zn(function(t,e){var r=e,i=mr.assert;function s(c){c.type==="short"?this.curve=new Qs.short(c):c.type==="edwards"?this.curve=new Qs.edwards(c):this.curve=new Qs.mont(c),this.g=this.curve.g,this.n=this.curve.n,this.hash=c.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=s;function n(c,p){Object.defineProperty(r,c,{configurable:!0,enumerable:!0,get:function(){var b=new s(p);return Object.defineProperty(r,c,{configurable:!0,enumerable:!0,value:b}),b}})}n("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:di.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),n("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:di.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),n("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:di.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),n("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:di.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),n("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:di.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),n("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:di.sha256,gRed:!1,g:["9"]}),n("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:di.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var o;try{o=null.crash()}catch{o=void 0}n("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:di.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})});function $i(t){if(!(this instanceof $i))return new $i(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Ur.toArray(t.entropy,t.entropyEnc||"hex"),r=Ur.toArray(t.nonce,t.nonceEnc||"hex"),i=Ur.toArray(t.pers,t.persEnc||"hex");Pf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var Jd=$i;$i.prototype._init=function(e,r,i){var s=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656};$i.prototype._hmac=function(){return new di.hmac(this.hash,this.K)};$i.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};$i.prototype.reseed=function(e,r,i,s){typeof r!="string"&&(s=i,i=r,r=null),e=Ur.toArray(e,r),i=Ur.toArray(i,s),Pf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};$i.prototype.generate=function(e,r,i,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(s=i,i=r,r=null),i&&(i=Ur.toArray(i,s||"hex"),this._update(i));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var o=n.slice(0,e);return this._update(i),this._reseed++,Ur.encode(o,r)};var Xo=mr.assert;function zt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Nf=zt;zt.fromPublic=function(e,r,i){return r instanceof zt?r:new zt(e,{pub:r,pubEnc:i})};zt.fromPrivate=function(e,r,i){return r instanceof zt?r:new zt(e,{priv:r,privEnc:i})};zt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};zt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};zt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};zt.prototype._importPrivate=function(e,r){this.priv=new Fe(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};zt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?Xo(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Xo(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};zt.prototype.derive=function(e){return e.validate()||Xo(e.validate(),"public point not validated"),e.mul(this.priv).getX()};zt.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};zt.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};zt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Hy=mr.assert;function Ra(t,e){if(t instanceof Ra)return t;this._importDER(t,e)||(Hy(t.r&&t.s,"Signature without r or s"),this.r=new Fe(t.r,16),this.s=new Fe(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var Na=Ra;function Wy(){this.place=0}function vo(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var s=0,n=0,o=e.place;n<i;n++,o++)s<<=8,s|=t[o],s>>>=0;return s<=127?!1:(e.place=o,s)}function hc(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Ra.prototype._importDER=function(e,r){e=mr.toArray(e,r);var i=new Wy;if(e[i.place++]!==48)return!1;var s=vo(e,i);if(s===!1||s+i.place!==e.length||e[i.place++]!==2)return!1;var n=vo(e,i);if(n===!1)return!1;var o=e.slice(i.place,n+i.place);if(i.place+=n,e[i.place++]!==2)return!1;var c=vo(e,i);if(c===!1||e.length!==c+i.place)return!1;var p=e.slice(i.place,c+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(p[0]===0)if(p[1]&128)p=p.slice(1);else return!1;return this.r=new Fe(o),this.s=new Fe(p),this.recoveryParam=null,!0};function bo(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Ra.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=hc(r),i=hc(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var s=[2];bo(s,r.length),s=s.concat(r),s.push(2),bo(s,i.length);var n=s.concat(i),o=[48];return bo(o,n.length),o=o.concat(n),mr.encode(o,e)};var Gy=function(){throw new Error("unsupported")},Zd=mr.assert;function Ir(t){if(!(this instanceof Ir))return new Ir(t);typeof t=="string"&&(Zd(Object.prototype.hasOwnProperty.call(ea,t),"Unknown curve "+t),t=ea[t]),t instanceof ea.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var Jy=Ir;Ir.prototype.keyPair=function(e){return new Nf(this,e)};Ir.prototype.keyFromPrivate=function(e,r){return Nf.fromPrivate(this,e,r)};Ir.prototype.keyFromPublic=function(e,r){return Nf.fromPublic(this,e,r)};Ir.prototype.genKeyPair=function(e){e||(e={});for(var r=new Jd({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Gy(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),s=this.n.sub(new Fe(2));;){var n=new Fe(r.generate(i));if(!(n.cmp(s)>0))return n.iaddn(1),this.keyFromPrivate(n)}};Ir.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Ir.prototype.sign=function(e,r,i,s){typeof i=="object"&&(s=i,i=null),s||(s={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new Fe(e,16));for(var n=this.n.byteLength(),o=r.getPrivate().toArray("be",n),c=e.toArray("be",n),p=new Jd({hash:this.hash,entropy:o,nonce:c,pers:s.pers,persEnc:s.persEnc||"utf8"}),b=this.n.sub(new Fe(1)),w=0;;w++){var x=s.k?s.k(w):new Fe(p.generate(this.n.byteLength()));if(x=this._truncateToN(x,!0),!(x.cmpn(1)<=0||x.cmp(b)>=0)){var E=this.g.mul(x);if(!E.isInfinity()){var I=E.getX(),S=I.umod(this.n);if(S.cmpn(0)!==0){var D=x.invm(this.n).mul(S.mul(r.getPrivate()).iadd(e));if(D=D.umod(this.n),D.cmpn(0)!==0){var P=(E.getY().isOdd()?1:0)|(I.cmp(S)!==0?2:0);return s.canonical&&D.cmp(this.nh)>0&&(D=this.n.sub(D),P^=1),new Na({r:S,s:D,recoveryParam:P})}}}}}};Ir.prototype.verify=function(e,r,i,s){e=this._truncateToN(new Fe(e,16)),i=this.keyFromPublic(i,s),r=new Na(r,"hex");var n=r.r,o=r.s;if(n.cmpn(1)<0||n.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var c=o.invm(this.n),p=c.mul(e).umod(this.n),b=c.mul(n).umod(this.n),w;return this.curve._maxwellTrick?(w=this.g.jmulAdd(p,i.getPublic(),b),w.isInfinity()?!1:w.eqXToP(n)):(w=this.g.mulAdd(p,i.getPublic(),b),w.isInfinity()?!1:w.getX().umod(this.n).cmp(n)===0)};Ir.prototype.recoverPubKey=function(t,e,r,i){Zd((3&r)===r,"The recovery param is more than two bits"),e=new Na(e,i);var s=this.n,n=new Fe(t),o=e.r,c=e.s,p=r&1,b=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&b)throw new Error("Unable to find sencond key candinate");b?o=this.curve.pointFromX(o.add(this.curve.n),p):o=this.curve.pointFromX(o,p);var w=e.r.invm(s),x=s.sub(n).mul(w).umod(s),E=c.mul(w).umod(s);return this.g.mulAdd(x,o,E)};Ir.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new Na(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var s=0;s<4;s++){var n;try{n=this.recoverPubKey(t,e,s)}catch{continue}if(n.eq(r))return s}throw new Error("Unable to find valid recovery factor")};var Zy=zn(function(t,e){var r=e;r.version="6.5.4",r.utils=mr,r.rand=function(){throw new Error("unsupported")},r.curve=Qs,r.curves=ea,r.ec=Jy,r.eddsa=null}),Yy=Zy.ec;const Xy="signing-key/5.7.0",Qo=new ct(Xy);let mo=null;function Ai(){return mo||(mo=new Yy("secp256k1")),mo}class Qy{constructor(e){Yn(this,"curve","secp256k1"),Yn(this,"privateKey",gr(e)),sm(this.privateKey)!==32&&Qo.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const r=Ai().keyFromPrivate(St(this.privateKey));Yn(this,"publicKey","0x"+r.getPublic(!1,"hex")),Yn(this,"compressedPublicKey","0x"+r.getPublic(!0,"hex")),Yn(this,"_isSigningKey",!0)}_addPoint(e){const r=Ai().keyFromPublic(St(this.publicKey)),i=Ai().keyFromPublic(St(e));return"0x"+r.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const r=Ai().keyFromPrivate(St(this.privateKey)),i=St(e);i.length!==32&&Qo.throwArgumentError("bad digest length","digest",e);const s=r.sign(i,{canonical:!0});return Dd({recoveryParam:s.recoveryParam,r:Sn("0x"+s.r.toString(16),32),s:Sn("0x"+s.s.toString(16),32)})}computeSharedSecret(e){const r=Ai().keyFromPrivate(St(this.privateKey)),i=Ai().keyFromPublic(St(Yd(e)));return Sn("0x"+r.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function e2(t,e){const r=Dd(e),i={r:St(r.r),s:St(r.s)};return"0x"+Ai().recoverPubKey(St(t),i,r.recoveryParam).encode("hex",!1)}function Yd(t,e){const r=St(t);return r.length===32?new Qy(r).publicKey:r.length===33?"0x"+Ai().keyFromPublic(r).getPublic(!1,"hex"):r.length===65?gr(r):Qo.throwArgumentError("invalid public or private key","key","[REDACTED]")}var cc;(function(t){t[t.legacy=0]="legacy",t[t.eip2930=1]="eip2930",t[t.eip1559=2]="eip1559"})(cc||(cc={}));function t2(t){const e=Yd(t);return pm(rc(Od(rc(e,1)),12))}function r2(t,e){return t2(e2(St(t),e))}function Xd(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function yo(t,e){e||(e=t.reduce((s,n)=>s+n.length,0));const r=Xd(e);let i=0;for(const s of t)r.set(s,i),i+=s.length;return r}function i2(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<t.length;s++){var n=t.charAt(s),o=n.charCodeAt(0);if(r[o]!==255)throw new TypeError(n+" is ambiguous");r[o]=s}var c=t.length,p=t.charAt(0),b=Math.log(c)/Math.log(256),w=Math.log(256)/Math.log(c);function x(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var D=0,P=0,R=0,N=S.length;R!==N&&S[R]===0;)R++,D++;for(var C=(N-R)*w+1>>>0,L=new Uint8Array(C);R!==N;){for(var B=S[R],U=0,K=C-1;(B!==0||U<P)&&K!==-1;K--,U++)B+=256*L[K]>>>0,L[K]=B%c>>>0,B=B/c>>>0;if(B!==0)throw new Error("Non-zero carry");P=U,R++}for(var k=C-P;k!==C&&L[k]===0;)k++;for(var z=p.repeat(D);k<C;++k)z+=t.charAt(L[k]);return z}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var D=0;if(S[D]!==" "){for(var P=0,R=0;S[D]===p;)P++,D++;for(var N=(S.length-D)*b+1>>>0,C=new Uint8Array(N);S[D];){var L=r[S.charCodeAt(D)];if(L===255)return;for(var B=0,U=N-1;(L!==0||B<R)&&U!==-1;U--,B++)L+=c*C[U]>>>0,C[U]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");R=B,D++}if(S[D]!==" "){for(var K=N-R;K!==N&&C[K]===0;)K++;for(var k=new Uint8Array(P+(N-K)),z=P;K!==N;)k[z++]=C[K++];return k}}}function I(S){var D=E(S);if(D)return D;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:E,decode:I}}var n2=i2,s2=n2;const a2=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},o2=t=>new TextEncoder().encode(t),f2=t=>new TextDecoder().decode(t);class h2{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class c2{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Qd(this,e)}}class u2{constructor(e){this.decoders=e}or(e){return Qd(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Qd=(t,e)=>new u2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class d2{constructor(e,r,i,s){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new h2(e,r,i),this.decoder=new c2(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $a=({name:t,prefix:e,encode:r,decode:i})=>new d2(t,e,r,i),Ms=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:s}=s2(r,e);return $a({prefix:t,name:e,encode:i,decode:n=>a2(s(n))})},l2=(t,e,r,i)=>{const s={};for(let w=0;w<e.length;++w)s[e[w]]=w;let n=t.length;for(;t[n-1]==="=";)--n;const o=new Uint8Array(n*r/8|0);let c=0,p=0,b=0;for(let w=0;w<n;++w){const x=s[t[w]];if(x===void 0)throw new SyntaxError(`Non-${i} character`);p=p<<r|x,c+=r,c>=8&&(c-=8,o[b++]=255&p>>c)}if(c>=r||255&p<<8-c)throw new SyntaxError("Unexpected end of data");return o},p2=(t,e,r)=>{const i=e[e.length-1]==="=",s=(1<<r)-1;let n="",o=0,c=0;for(let p=0;p<t.length;++p)for(c=c<<8|t[p],o+=8;o>r;)o-=r,n+=e[s&c>>o];if(o&&(n+=e[s&c<<r-o]),i)for(;n.length*r&7;)n+="=";return n},Ct=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>$a({prefix:e,name:t,encode(s){return p2(s,i,r)},decode(s){return l2(s,i,r,t)}}),g2=$a({prefix:"\0",name:"identity",encode:t=>f2(t),decode:t=>o2(t)}),v2=Object.freeze(Object.defineProperty({__proto__:null,identity:g2},Symbol.toStringTag,{value:"Module"})),b2=Ct({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),m2=Object.freeze(Object.defineProperty({__proto__:null,base2:b2},Symbol.toStringTag,{value:"Module"})),y2=Ct({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),w2=Object.freeze(Object.defineProperty({__proto__:null,base8:y2},Symbol.toStringTag,{value:"Module"})),_2=Ms({prefix:"9",name:"base10",alphabet:"0123456789"}),x2=Object.freeze(Object.defineProperty({__proto__:null,base10:_2},Symbol.toStringTag,{value:"Module"})),M2=Ct({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),E2=Ct({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),S2=Object.freeze(Object.defineProperty({__proto__:null,base16:M2,base16upper:E2},Symbol.toStringTag,{value:"Module"})),I2=Ct({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A2=Ct({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D2=Ct({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),O2=Ct({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),P2=Ct({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R2=Ct({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),N2=Ct({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$2=Ct({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),T2=Ct({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),F2=Object.freeze(Object.defineProperty({__proto__:null,base32:I2,base32hex:P2,base32hexpad:N2,base32hexpadupper:$2,base32hexupper:R2,base32pad:D2,base32padupper:O2,base32upper:A2,base32z:T2},Symbol.toStringTag,{value:"Module"})),C2=Ms({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),L2=Ms({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),q2=Object.freeze(Object.defineProperty({__proto__:null,base36:C2,base36upper:L2},Symbol.toStringTag,{value:"Module"})),B2=Ms({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),U2=Ms({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),z2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:B2,base58flickr:U2},Symbol.toStringTag,{value:"Module"})),k2=Ct({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),j2=Ct({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),K2=Ct({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),V2=Ct({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),H2=Object.freeze(Object.defineProperty({__proto__:null,base64:k2,base64pad:j2,base64url:K2,base64urlpad:V2},Symbol.toStringTag,{value:"Module"})),el=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),W2=el.reduce((t,e,r)=>(t[r]=e,t),[]),G2=el.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function J2(t){return t.reduce((e,r)=>(e+=W2[r],e),"")}function Z2(t){const e=[];for(const r of t){const i=G2[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Y2=$a({prefix:"🚀",name:"base256emoji",encode:J2,decode:Z2}),X2=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Y2},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const uc={...v2,...m2,...w2,...x2,...S2,...F2,...q2,...z2,...H2,...X2};function tl(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const dc=tl("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),wo=tl("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Xd(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),rl={utf8:dc,"utf-8":dc,hex:uc.base16,latin1:wo,ascii:wo,binary:wo,...uc};function Sr(t,e="utf8"){const r=rl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Vt(t,e="utf8"){const r=rl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var il={};const Q2="elliptic",e3="6.6.1",t3="EC cryptography",r3="lib/elliptic.js",i3=["lib"],n3={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},s3={type:"git",url:"git@github.com:indutny/elliptic"},a3=["EC","Elliptic","curve","Cryptography"],o3="Fedor Indutny <fedor@indutny.com>",f3="MIT",h3={url:"https://github.com/indutny/elliptic/issues"},c3="https://github.com/indutny/elliptic",u3={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},d3={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},l3={name:Q2,version:e3,description:t3,main:r3,files:i3,scripts:n3,repository:s3,keywords:a3,author:o3,license:f3,bugs:h3,homepage:c3,devDependencies:u3,dependencies:d3};var yr={},$f={exports:{}};$f.exports;(function(t){(function(e,r){function i(A,_){if(!A)throw new Error(_||"Assertion failed")}function s(A,_){A.super_=_;var d=function(){};d.prototype=_.prototype,A.prototype=new d,A.prototype.constructor=A}function n(A,_,d){if(n.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((_==="le"||_==="be")&&(d=_,_=10),this._init(A||0,_||10,d||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=_a.Buffer}catch{}n.isBN=function(_){return _ instanceof n?!0:_!==null&&typeof _=="object"&&_.constructor.wordSize===n.wordSize&&Array.isArray(_.words)},n.max=function(_,d){return _.cmp(d)>0?_:d},n.min=function(_,d){return _.cmp(d)<0?_:d},n.prototype._init=function(_,d,a){if(typeof _=="number")return this._initNumber(_,d,a);if(typeof _=="object")return this._initArray(_,d,a);d==="hex"&&(d=16),i(d===(d|0)&&d>=2&&d<=36),_=_.toString().replace(/\s+/g,"");var f=0;_[0]==="-"&&(f++,this.negative=1),f<_.length&&(d===16?this._parseHex(_,f,a):(this._parseBase(_,d,f),a==="le"&&this._initArray(this.toArray(),d,a)))},n.prototype._initNumber=function(_,d,a){_<0&&(this.negative=1,_=-_),_<67108864?(this.words=[_&67108863],this.length=1):_<4503599627370496?(this.words=[_&67108863,_/67108864&67108863],this.length=2):(i(_<9007199254740992),this.words=[_&67108863,_/67108864&67108863,1],this.length=3),a==="le"&&this._initArray(this.toArray(),d,a)},n.prototype._initArray=function(_,d,a){if(i(typeof _.length=="number"),_.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(_.length/3),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var u,v,y=0;if(a==="be")for(f=_.length-1,u=0;f>=0;f-=3)v=_[f]|_[f-1]<<8|_[f-2]<<16,this.words[u]|=v<<y&67108863,this.words[u+1]=v>>>26-y&67108863,y+=24,y>=26&&(y-=26,u++);else if(a==="le")for(f=0,u=0;f<_.length;f+=3)v=_[f]|_[f+1]<<8|_[f+2]<<16,this.words[u]|=v<<y&67108863,this.words[u+1]=v>>>26-y&67108863,y+=24,y>=26&&(y-=26,u++);return this.strip()};function c(A,_){var d=A.charCodeAt(_);return d>=65&&d<=70?d-55:d>=97&&d<=102?d-87:d-48&15}function p(A,_,d){var a=c(A,d);return d-1>=_&&(a|=c(A,d-1)<<4),a}n.prototype._parseHex=function(_,d,a){this.length=Math.ceil((_.length-d)/6),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var u=0,v=0,y;if(a==="be")for(f=_.length-1;f>=d;f-=2)y=p(_,d,f)<<u,this.words[v]|=y&67108863,u>=18?(u-=18,v+=1,this.words[v]|=y>>>26):u+=8;else{var m=_.length-d;for(f=m%2===0?d+1:d;f<_.length;f+=2)y=p(_,d,f)<<u,this.words[v]|=y&67108863,u>=18?(u-=18,v+=1,this.words[v]|=y>>>26):u+=8}this.strip()};function b(A,_,d,a){for(var f=0,u=Math.min(A.length,d),v=_;v<u;v++){var y=A.charCodeAt(v)-48;f*=a,y>=49?f+=y-49+10:y>=17?f+=y-17+10:f+=y}return f}n.prototype._parseBase=function(_,d,a){this.words=[0],this.length=1;for(var f=0,u=1;u<=67108863;u*=d)f++;f--,u=u/d|0;for(var v=_.length-a,y=v%f,m=Math.min(v,v-y)+a,l=0,g=a;g<m;g+=f)l=b(_,g,g+f,d),this.imuln(u),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(y!==0){var h=1;for(l=b(_,g,_.length,d),g=0;g<y;g++)h*=d;this.imuln(h),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},n.prototype.copy=function(_){_.words=new Array(this.length);for(var d=0;d<this.length;d++)_.words[d]=this.words[d];_.length=this.length,_.negative=this.negative,_.red=this.red},n.prototype.clone=function(){var _=new n(null);return this.copy(_),_},n.prototype._expand=function(_){for(;this.length<_;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var w=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(_,d){_=_||10,d=d|0||1;var a;if(_===16||_==="hex"){a="";for(var f=0,u=0,v=0;v<this.length;v++){var y=this.words[v],m=((y<<f|u)&16777215).toString(16);u=y>>>24-f&16777215,f+=2,f>=26&&(f-=26,v--),u!==0||v!==this.length-1?a=w[6-m.length]+m+a:a=m+a}for(u!==0&&(a=u.toString(16)+a);a.length%d!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}if(_===(_|0)&&_>=2&&_<=36){var l=x[_],g=E[_];a="";var h=this.clone();for(h.negative=0;!h.isZero();){var M=h.modn(g).toString(_);h=h.idivn(g),h.isZero()?a=M+a:a=w[l-M.length]+M+a}for(this.isZero()&&(a="0"+a);a.length%d!==0;)a="0"+a;return this.negative!==0&&(a="-"+a),a}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var _=this.words[0];return this.length===2?_+=this.words[1]*67108864:this.length===3&&this.words[2]===1?_+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-_:_},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(_,d){return i(typeof o<"u"),this.toArrayLike(o,_,d)},n.prototype.toArray=function(_,d){return this.toArrayLike(Array,_,d)},n.prototype.toArrayLike=function(_,d,a){var f=this.byteLength(),u=a||Math.max(1,f);i(f<=u,"byte array longer than desired length"),i(u>0,"Requested array length <= 0"),this.strip();var v=d==="le",y=new _(u),m,l,g=this.clone();if(v){for(l=0;!g.isZero();l++)m=g.andln(255),g.iushrn(8),y[l]=m;for(;l<u;l++)y[l]=0}else{for(l=0;l<u-f;l++)y[l]=0;for(l=0;!g.isZero();l++)m=g.andln(255),g.iushrn(8),y[u-l-1]=m}return y},Math.clz32?n.prototype._countBits=function(_){return 32-Math.clz32(_)}:n.prototype._countBits=function(_){var d=_,a=0;return d>=4096&&(a+=13,d>>>=13),d>=64&&(a+=7,d>>>=7),d>=8&&(a+=4,d>>>=4),d>=2&&(a+=2,d>>>=2),a+d},n.prototype._zeroBits=function(_){if(_===0)return 26;var d=_,a=0;return d&8191||(a+=13,d>>>=13),d&127||(a+=7,d>>>=7),d&15||(a+=4,d>>>=4),d&3||(a+=2,d>>>=2),d&1||a++,a},n.prototype.bitLength=function(){var _=this.words[this.length-1],d=this._countBits(_);return(this.length-1)*26+d};function I(A){for(var _=new Array(A.bitLength()),d=0;d<_.length;d++){var a=d/26|0,f=d%26;_[d]=(A.words[a]&1<<f)>>>f}return _}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var _=0,d=0;d<this.length;d++){var a=this._zeroBits(this.words[d]);if(_+=a,a!==26)break}return _},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(_){return this.negative!==0?this.abs().inotn(_).iaddn(1):this.clone()},n.prototype.fromTwos=function(_){return this.testn(_-1)?this.notn(_).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(_){for(;this.length<_.length;)this.words[this.length++]=0;for(var d=0;d<_.length;d++)this.words[d]=this.words[d]|_.words[d];return this.strip()},n.prototype.ior=function(_){return i((this.negative|_.negative)===0),this.iuor(_)},n.prototype.or=function(_){return this.length>_.length?this.clone().ior(_):_.clone().ior(this)},n.prototype.uor=function(_){return this.length>_.length?this.clone().iuor(_):_.clone().iuor(this)},n.prototype.iuand=function(_){var d;this.length>_.length?d=_:d=this;for(var a=0;a<d.length;a++)this.words[a]=this.words[a]&_.words[a];return this.length=d.length,this.strip()},n.prototype.iand=function(_){return i((this.negative|_.negative)===0),this.iuand(_)},n.prototype.and=function(_){return this.length>_.length?this.clone().iand(_):_.clone().iand(this)},n.prototype.uand=function(_){return this.length>_.length?this.clone().iuand(_):_.clone().iuand(this)},n.prototype.iuxor=function(_){var d,a;this.length>_.length?(d=this,a=_):(d=_,a=this);for(var f=0;f<a.length;f++)this.words[f]=d.words[f]^a.words[f];if(this!==d)for(;f<d.length;f++)this.words[f]=d.words[f];return this.length=d.length,this.strip()},n.prototype.ixor=function(_){return i((this.negative|_.negative)===0),this.iuxor(_)},n.prototype.xor=function(_){return this.length>_.length?this.clone().ixor(_):_.clone().ixor(this)},n.prototype.uxor=function(_){return this.length>_.length?this.clone().iuxor(_):_.clone().iuxor(this)},n.prototype.inotn=function(_){i(typeof _=="number"&&_>=0);var d=Math.ceil(_/26)|0,a=_%26;this._expand(d),a>0&&d--;for(var f=0;f<d;f++)this.words[f]=~this.words[f]&67108863;return a>0&&(this.words[f]=~this.words[f]&67108863>>26-a),this.strip()},n.prototype.notn=function(_){return this.clone().inotn(_)},n.prototype.setn=function(_,d){i(typeof _=="number"&&_>=0);var a=_/26|0,f=_%26;return this._expand(a+1),d?this.words[a]=this.words[a]|1<<f:this.words[a]=this.words[a]&~(1<<f),this.strip()},n.prototype.iadd=function(_){var d;if(this.negative!==0&&_.negative===0)return this.negative=0,d=this.isub(_),this.negative^=1,this._normSign();if(this.negative===0&&_.negative!==0)return _.negative=0,d=this.isub(_),_.negative=1,d._normSign();var a,f;this.length>_.length?(a=this,f=_):(a=_,f=this);for(var u=0,v=0;v<f.length;v++)d=(a.words[v]|0)+(f.words[v]|0)+u,this.words[v]=d&67108863,u=d>>>26;for(;u!==0&&v<a.length;v++)d=(a.words[v]|0)+u,this.words[v]=d&67108863,u=d>>>26;if(this.length=a.length,u!==0)this.words[this.length]=u,this.length++;else if(a!==this)for(;v<a.length;v++)this.words[v]=a.words[v];return this},n.prototype.add=function(_){var d;return _.negative!==0&&this.negative===0?(_.negative=0,d=this.sub(_),_.negative^=1,d):_.negative===0&&this.negative!==0?(this.negative=0,d=_.sub(this),this.negative=1,d):this.length>_.length?this.clone().iadd(_):_.clone().iadd(this)},n.prototype.isub=function(_){if(_.negative!==0){_.negative=0;var d=this.iadd(_);return _.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(_),this.negative=1,this._normSign();var a=this.cmp(_);if(a===0)return this.negative=0,this.length=1,this.words[0]=0,this;var f,u;a>0?(f=this,u=_):(f=_,u=this);for(var v=0,y=0;y<u.length;y++)d=(f.words[y]|0)-(u.words[y]|0)+v,v=d>>26,this.words[y]=d&67108863;for(;v!==0&&y<f.length;y++)d=(f.words[y]|0)+v,v=d>>26,this.words[y]=d&67108863;if(v===0&&y<f.length&&f!==this)for(;y<f.length;y++)this.words[y]=f.words[y];return this.length=Math.max(this.length,y),f!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(_){return this.clone().isub(_)};function S(A,_,d){d.negative=_.negative^A.negative;var a=A.length+_.length|0;d.length=a,a=a-1|0;var f=A.words[0]|0,u=_.words[0]|0,v=f*u,y=v&67108863,m=v/67108864|0;d.words[0]=y;for(var l=1;l<a;l++){for(var g=m>>>26,h=m&67108863,M=Math.min(l,_.length-1),T=Math.max(0,l-A.length+1);T<=M;T++){var $=l-T|0;f=A.words[$]|0,u=_.words[T]|0,v=f*u+h,g+=v/67108864|0,h=v&67108863}d.words[l]=h|0,m=g|0}return m!==0?d.words[l]=m|0:d.length--,d.strip()}var D=function(_,d,a){var f=_.words,u=d.words,v=a.words,y=0,m,l,g,h=f[0]|0,M=h&8191,T=h>>>13,$=f[1]|0,q=$&8191,G=$>>>13,H=f[2]|0,V=H&8191,Oe=H>>>13,ge=f[3]|0,Y=ge&8191,Be=ge>>>13,be=f[4]|0,ie=be&8191,He=be>>>13,Se=f[5]|0,ne=Se&8191,je=Se>>>13,we=f[6]|0,ee=we&8191,Ke=we>>>13,_e=f[7]|0,re=_e&8191,Ve=_e>>>13,xe=f[8]|0,Q=xe&8191,ze=xe>>>13,Me=f[9]|0,Z=Me&8191,Ze=Me>>>13,Ae=u[0]|0,he=Ae&8191,Ye=Ae>>>13,Ee=u[1]|0,oe=Ee&8191,Xe=Ee>>>13,Pe=u[2]|0,X=Pe&8191,Qe=Pe>>>13,Re=u[3]|0,ce=Re&8191,We=Re>>>13,ye=u[4]|0,se=ye&8191,Ge=ye>>>13,Ie=u[5]|0,te=Ie&8191,et=Ie>>>13,Ne=u[6]|0,ue=Ne&8191,tt=Ne>>>13,$e=u[7]|0,fe=$e&8191,Je=$e>>>13,me=u[8]|0,de=me&8191,rt=me>>>13,Te=u[9]|0,le=Te&8191,it=Te>>>13;a.negative=_.negative^d.negative,a.length=19,m=Math.imul(M,he),l=Math.imul(M,Ye),l=l+Math.imul(T,he)|0,g=Math.imul(T,Ye);var ve=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(ve>>>26)|0,ve&=67108863,m=Math.imul(q,he),l=Math.imul(q,Ye),l=l+Math.imul(G,he)|0,g=Math.imul(G,Ye),m=m+Math.imul(M,oe)|0,l=l+Math.imul(M,Xe)|0,l=l+Math.imul(T,oe)|0,g=g+Math.imul(T,Xe)|0;var De=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(De>>>26)|0,De&=67108863,m=Math.imul(V,he),l=Math.imul(V,Ye),l=l+Math.imul(Oe,he)|0,g=Math.imul(Oe,Ye),m=m+Math.imul(q,oe)|0,l=l+Math.imul(q,Xe)|0,l=l+Math.imul(G,oe)|0,g=g+Math.imul(G,Xe)|0,m=m+Math.imul(M,X)|0,l=l+Math.imul(M,Qe)|0,l=l+Math.imul(T,X)|0,g=g+Math.imul(T,Qe)|0;var Qt=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,m=Math.imul(Y,he),l=Math.imul(Y,Ye),l=l+Math.imul(Be,he)|0,g=Math.imul(Be,Ye),m=m+Math.imul(V,oe)|0,l=l+Math.imul(V,Xe)|0,l=l+Math.imul(Oe,oe)|0,g=g+Math.imul(Oe,Xe)|0,m=m+Math.imul(q,X)|0,l=l+Math.imul(q,Qe)|0,l=l+Math.imul(G,X)|0,g=g+Math.imul(G,Qe)|0,m=m+Math.imul(M,ce)|0,l=l+Math.imul(M,We)|0,l=l+Math.imul(T,ce)|0,g=g+Math.imul(T,We)|0;var er=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(er>>>26)|0,er&=67108863,m=Math.imul(ie,he),l=Math.imul(ie,Ye),l=l+Math.imul(He,he)|0,g=Math.imul(He,Ye),m=m+Math.imul(Y,oe)|0,l=l+Math.imul(Y,Xe)|0,l=l+Math.imul(Be,oe)|0,g=g+Math.imul(Be,Xe)|0,m=m+Math.imul(V,X)|0,l=l+Math.imul(V,Qe)|0,l=l+Math.imul(Oe,X)|0,g=g+Math.imul(Oe,Qe)|0,m=m+Math.imul(q,ce)|0,l=l+Math.imul(q,We)|0,l=l+Math.imul(G,ce)|0,g=g+Math.imul(G,We)|0,m=m+Math.imul(M,se)|0,l=l+Math.imul(M,Ge)|0,l=l+Math.imul(T,se)|0,g=g+Math.imul(T,Ge)|0;var tr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(tr>>>26)|0,tr&=67108863,m=Math.imul(ne,he),l=Math.imul(ne,Ye),l=l+Math.imul(je,he)|0,g=Math.imul(je,Ye),m=m+Math.imul(ie,oe)|0,l=l+Math.imul(ie,Xe)|0,l=l+Math.imul(He,oe)|0,g=g+Math.imul(He,Xe)|0,m=m+Math.imul(Y,X)|0,l=l+Math.imul(Y,Qe)|0,l=l+Math.imul(Be,X)|0,g=g+Math.imul(Be,Qe)|0,m=m+Math.imul(V,ce)|0,l=l+Math.imul(V,We)|0,l=l+Math.imul(Oe,ce)|0,g=g+Math.imul(Oe,We)|0,m=m+Math.imul(q,se)|0,l=l+Math.imul(q,Ge)|0,l=l+Math.imul(G,se)|0,g=g+Math.imul(G,Ge)|0,m=m+Math.imul(M,te)|0,l=l+Math.imul(M,et)|0,l=l+Math.imul(T,te)|0,g=g+Math.imul(T,et)|0;var rr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(rr>>>26)|0,rr&=67108863,m=Math.imul(ee,he),l=Math.imul(ee,Ye),l=l+Math.imul(Ke,he)|0,g=Math.imul(Ke,Ye),m=m+Math.imul(ne,oe)|0,l=l+Math.imul(ne,Xe)|0,l=l+Math.imul(je,oe)|0,g=g+Math.imul(je,Xe)|0,m=m+Math.imul(ie,X)|0,l=l+Math.imul(ie,Qe)|0,l=l+Math.imul(He,X)|0,g=g+Math.imul(He,Qe)|0,m=m+Math.imul(Y,ce)|0,l=l+Math.imul(Y,We)|0,l=l+Math.imul(Be,ce)|0,g=g+Math.imul(Be,We)|0,m=m+Math.imul(V,se)|0,l=l+Math.imul(V,Ge)|0,l=l+Math.imul(Oe,se)|0,g=g+Math.imul(Oe,Ge)|0,m=m+Math.imul(q,te)|0,l=l+Math.imul(q,et)|0,l=l+Math.imul(G,te)|0,g=g+Math.imul(G,et)|0,m=m+Math.imul(M,ue)|0,l=l+Math.imul(M,tt)|0,l=l+Math.imul(T,ue)|0,g=g+Math.imul(T,tt)|0;var yt=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(yt>>>26)|0,yt&=67108863,m=Math.imul(re,he),l=Math.imul(re,Ye),l=l+Math.imul(Ve,he)|0,g=Math.imul(Ve,Ye),m=m+Math.imul(ee,oe)|0,l=l+Math.imul(ee,Xe)|0,l=l+Math.imul(Ke,oe)|0,g=g+Math.imul(Ke,Xe)|0,m=m+Math.imul(ne,X)|0,l=l+Math.imul(ne,Qe)|0,l=l+Math.imul(je,X)|0,g=g+Math.imul(je,Qe)|0,m=m+Math.imul(ie,ce)|0,l=l+Math.imul(ie,We)|0,l=l+Math.imul(He,ce)|0,g=g+Math.imul(He,We)|0,m=m+Math.imul(Y,se)|0,l=l+Math.imul(Y,Ge)|0,l=l+Math.imul(Be,se)|0,g=g+Math.imul(Be,Ge)|0,m=m+Math.imul(V,te)|0,l=l+Math.imul(V,et)|0,l=l+Math.imul(Oe,te)|0,g=g+Math.imul(Oe,et)|0,m=m+Math.imul(q,ue)|0,l=l+Math.imul(q,tt)|0,l=l+Math.imul(G,ue)|0,g=g+Math.imul(G,tt)|0,m=m+Math.imul(M,fe)|0,l=l+Math.imul(M,Je)|0,l=l+Math.imul(T,fe)|0,g=g+Math.imul(T,Je)|0;var ir=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(ir>>>26)|0,ir&=67108863,m=Math.imul(Q,he),l=Math.imul(Q,Ye),l=l+Math.imul(ze,he)|0,g=Math.imul(ze,Ye),m=m+Math.imul(re,oe)|0,l=l+Math.imul(re,Xe)|0,l=l+Math.imul(Ve,oe)|0,g=g+Math.imul(Ve,Xe)|0,m=m+Math.imul(ee,X)|0,l=l+Math.imul(ee,Qe)|0,l=l+Math.imul(Ke,X)|0,g=g+Math.imul(Ke,Qe)|0,m=m+Math.imul(ne,ce)|0,l=l+Math.imul(ne,We)|0,l=l+Math.imul(je,ce)|0,g=g+Math.imul(je,We)|0,m=m+Math.imul(ie,se)|0,l=l+Math.imul(ie,Ge)|0,l=l+Math.imul(He,se)|0,g=g+Math.imul(He,Ge)|0,m=m+Math.imul(Y,te)|0,l=l+Math.imul(Y,et)|0,l=l+Math.imul(Be,te)|0,g=g+Math.imul(Be,et)|0,m=m+Math.imul(V,ue)|0,l=l+Math.imul(V,tt)|0,l=l+Math.imul(Oe,ue)|0,g=g+Math.imul(Oe,tt)|0,m=m+Math.imul(q,fe)|0,l=l+Math.imul(q,Je)|0,l=l+Math.imul(G,fe)|0,g=g+Math.imul(G,Je)|0,m=m+Math.imul(M,de)|0,l=l+Math.imul(M,rt)|0,l=l+Math.imul(T,de)|0,g=g+Math.imul(T,rt)|0;var nr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(nr>>>26)|0,nr&=67108863,m=Math.imul(Z,he),l=Math.imul(Z,Ye),l=l+Math.imul(Ze,he)|0,g=Math.imul(Ze,Ye),m=m+Math.imul(Q,oe)|0,l=l+Math.imul(Q,Xe)|0,l=l+Math.imul(ze,oe)|0,g=g+Math.imul(ze,Xe)|0,m=m+Math.imul(re,X)|0,l=l+Math.imul(re,Qe)|0,l=l+Math.imul(Ve,X)|0,g=g+Math.imul(Ve,Qe)|0,m=m+Math.imul(ee,ce)|0,l=l+Math.imul(ee,We)|0,l=l+Math.imul(Ke,ce)|0,g=g+Math.imul(Ke,We)|0,m=m+Math.imul(ne,se)|0,l=l+Math.imul(ne,Ge)|0,l=l+Math.imul(je,se)|0,g=g+Math.imul(je,Ge)|0,m=m+Math.imul(ie,te)|0,l=l+Math.imul(ie,et)|0,l=l+Math.imul(He,te)|0,g=g+Math.imul(He,et)|0,m=m+Math.imul(Y,ue)|0,l=l+Math.imul(Y,tt)|0,l=l+Math.imul(Be,ue)|0,g=g+Math.imul(Be,tt)|0,m=m+Math.imul(V,fe)|0,l=l+Math.imul(V,Je)|0,l=l+Math.imul(Oe,fe)|0,g=g+Math.imul(Oe,Je)|0,m=m+Math.imul(q,de)|0,l=l+Math.imul(q,rt)|0,l=l+Math.imul(G,de)|0,g=g+Math.imul(G,rt)|0,m=m+Math.imul(M,le)|0,l=l+Math.imul(M,it)|0,l=l+Math.imul(T,le)|0,g=g+Math.imul(T,it)|0;var sr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(sr>>>26)|0,sr&=67108863,m=Math.imul(Z,oe),l=Math.imul(Z,Xe),l=l+Math.imul(Ze,oe)|0,g=Math.imul(Ze,Xe),m=m+Math.imul(Q,X)|0,l=l+Math.imul(Q,Qe)|0,l=l+Math.imul(ze,X)|0,g=g+Math.imul(ze,Qe)|0,m=m+Math.imul(re,ce)|0,l=l+Math.imul(re,We)|0,l=l+Math.imul(Ve,ce)|0,g=g+Math.imul(Ve,We)|0,m=m+Math.imul(ee,se)|0,l=l+Math.imul(ee,Ge)|0,l=l+Math.imul(Ke,se)|0,g=g+Math.imul(Ke,Ge)|0,m=m+Math.imul(ne,te)|0,l=l+Math.imul(ne,et)|0,l=l+Math.imul(je,te)|0,g=g+Math.imul(je,et)|0,m=m+Math.imul(ie,ue)|0,l=l+Math.imul(ie,tt)|0,l=l+Math.imul(He,ue)|0,g=g+Math.imul(He,tt)|0,m=m+Math.imul(Y,fe)|0,l=l+Math.imul(Y,Je)|0,l=l+Math.imul(Be,fe)|0,g=g+Math.imul(Be,Je)|0,m=m+Math.imul(V,de)|0,l=l+Math.imul(V,rt)|0,l=l+Math.imul(Oe,de)|0,g=g+Math.imul(Oe,rt)|0,m=m+Math.imul(q,le)|0,l=l+Math.imul(q,it)|0,l=l+Math.imul(G,le)|0,g=g+Math.imul(G,it)|0;var ar=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(ar>>>26)|0,ar&=67108863,m=Math.imul(Z,X),l=Math.imul(Z,Qe),l=l+Math.imul(Ze,X)|0,g=Math.imul(Ze,Qe),m=m+Math.imul(Q,ce)|0,l=l+Math.imul(Q,We)|0,l=l+Math.imul(ze,ce)|0,g=g+Math.imul(ze,We)|0,m=m+Math.imul(re,se)|0,l=l+Math.imul(re,Ge)|0,l=l+Math.imul(Ve,se)|0,g=g+Math.imul(Ve,Ge)|0,m=m+Math.imul(ee,te)|0,l=l+Math.imul(ee,et)|0,l=l+Math.imul(Ke,te)|0,g=g+Math.imul(Ke,et)|0,m=m+Math.imul(ne,ue)|0,l=l+Math.imul(ne,tt)|0,l=l+Math.imul(je,ue)|0,g=g+Math.imul(je,tt)|0,m=m+Math.imul(ie,fe)|0,l=l+Math.imul(ie,Je)|0,l=l+Math.imul(He,fe)|0,g=g+Math.imul(He,Je)|0,m=m+Math.imul(Y,de)|0,l=l+Math.imul(Y,rt)|0,l=l+Math.imul(Be,de)|0,g=g+Math.imul(Be,rt)|0,m=m+Math.imul(V,le)|0,l=l+Math.imul(V,it)|0,l=l+Math.imul(Oe,le)|0,g=g+Math.imul(Oe,it)|0;var or=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(or>>>26)|0,or&=67108863,m=Math.imul(Z,ce),l=Math.imul(Z,We),l=l+Math.imul(Ze,ce)|0,g=Math.imul(Ze,We),m=m+Math.imul(Q,se)|0,l=l+Math.imul(Q,Ge)|0,l=l+Math.imul(ze,se)|0,g=g+Math.imul(ze,Ge)|0,m=m+Math.imul(re,te)|0,l=l+Math.imul(re,et)|0,l=l+Math.imul(Ve,te)|0,g=g+Math.imul(Ve,et)|0,m=m+Math.imul(ee,ue)|0,l=l+Math.imul(ee,tt)|0,l=l+Math.imul(Ke,ue)|0,g=g+Math.imul(Ke,tt)|0,m=m+Math.imul(ne,fe)|0,l=l+Math.imul(ne,Je)|0,l=l+Math.imul(je,fe)|0,g=g+Math.imul(je,Je)|0,m=m+Math.imul(ie,de)|0,l=l+Math.imul(ie,rt)|0,l=l+Math.imul(He,de)|0,g=g+Math.imul(He,rt)|0,m=m+Math.imul(Y,le)|0,l=l+Math.imul(Y,it)|0,l=l+Math.imul(Be,le)|0,g=g+Math.imul(Be,it)|0;var Bt=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,m=Math.imul(Z,se),l=Math.imul(Z,Ge),l=l+Math.imul(Ze,se)|0,g=Math.imul(Ze,Ge),m=m+Math.imul(Q,te)|0,l=l+Math.imul(Q,et)|0,l=l+Math.imul(ze,te)|0,g=g+Math.imul(ze,et)|0,m=m+Math.imul(re,ue)|0,l=l+Math.imul(re,tt)|0,l=l+Math.imul(Ve,ue)|0,g=g+Math.imul(Ve,tt)|0,m=m+Math.imul(ee,fe)|0,l=l+Math.imul(ee,Je)|0,l=l+Math.imul(Ke,fe)|0,g=g+Math.imul(Ke,Je)|0,m=m+Math.imul(ne,de)|0,l=l+Math.imul(ne,rt)|0,l=l+Math.imul(je,de)|0,g=g+Math.imul(je,rt)|0,m=m+Math.imul(ie,le)|0,l=l+Math.imul(ie,it)|0,l=l+Math.imul(He,le)|0,g=g+Math.imul(He,it)|0;var fr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(fr>>>26)|0,fr&=67108863,m=Math.imul(Z,te),l=Math.imul(Z,et),l=l+Math.imul(Ze,te)|0,g=Math.imul(Ze,et),m=m+Math.imul(Q,ue)|0,l=l+Math.imul(Q,tt)|0,l=l+Math.imul(ze,ue)|0,g=g+Math.imul(ze,tt)|0,m=m+Math.imul(re,fe)|0,l=l+Math.imul(re,Je)|0,l=l+Math.imul(Ve,fe)|0,g=g+Math.imul(Ve,Je)|0,m=m+Math.imul(ee,de)|0,l=l+Math.imul(ee,rt)|0,l=l+Math.imul(Ke,de)|0,g=g+Math.imul(Ke,rt)|0,m=m+Math.imul(ne,le)|0,l=l+Math.imul(ne,it)|0,l=l+Math.imul(je,le)|0,g=g+Math.imul(je,it)|0;var hr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(hr>>>26)|0,hr&=67108863,m=Math.imul(Z,ue),l=Math.imul(Z,tt),l=l+Math.imul(Ze,ue)|0,g=Math.imul(Ze,tt),m=m+Math.imul(Q,fe)|0,l=l+Math.imul(Q,Je)|0,l=l+Math.imul(ze,fe)|0,g=g+Math.imul(ze,Je)|0,m=m+Math.imul(re,de)|0,l=l+Math.imul(re,rt)|0,l=l+Math.imul(Ve,de)|0,g=g+Math.imul(Ve,rt)|0,m=m+Math.imul(ee,le)|0,l=l+Math.imul(ee,it)|0,l=l+Math.imul(Ke,le)|0,g=g+Math.imul(Ke,it)|0;var mt=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(mt>>>26)|0,mt&=67108863,m=Math.imul(Z,fe),l=Math.imul(Z,Je),l=l+Math.imul(Ze,fe)|0,g=Math.imul(Ze,Je),m=m+Math.imul(Q,de)|0,l=l+Math.imul(Q,rt)|0,l=l+Math.imul(ze,de)|0,g=g+Math.imul(ze,rt)|0,m=m+Math.imul(re,le)|0,l=l+Math.imul(re,it)|0,l=l+Math.imul(Ve,le)|0,g=g+Math.imul(Ve,it)|0;var cr=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(cr>>>26)|0,cr&=67108863,m=Math.imul(Z,de),l=Math.imul(Z,rt),l=l+Math.imul(Ze,de)|0,g=Math.imul(Ze,rt),m=m+Math.imul(Q,le)|0,l=l+Math.imul(Q,it)|0,l=l+Math.imul(ze,le)|0,g=g+Math.imul(ze,it)|0;var ur=(y+m|0)+((l&8191)<<13)|0;y=(g+(l>>>13)|0)+(ur>>>26)|0,ur&=67108863,m=Math.imul(Z,le),l=Math.imul(Z,it),l=l+Math.imul(Ze,le)|0,g=Math.imul(Ze,it);var dr=(y+m|0)+((l&8191)<<13)|0;return y=(g+(l>>>13)|0)+(dr>>>26)|0,dr&=67108863,v[0]=ve,v[1]=De,v[2]=Qt,v[3]=er,v[4]=tr,v[5]=rr,v[6]=yt,v[7]=ir,v[8]=nr,v[9]=sr,v[10]=ar,v[11]=or,v[12]=Bt,v[13]=fr,v[14]=hr,v[15]=mt,v[16]=cr,v[17]=ur,v[18]=dr,y!==0&&(v[19]=y,a.length++),a};Math.imul||(D=S);function P(A,_,d){d.negative=_.negative^A.negative,d.length=A.length+_.length;for(var a=0,f=0,u=0;u<d.length-1;u++){var v=f;f=0;for(var y=a&67108863,m=Math.min(u,_.length-1),l=Math.max(0,u-A.length+1);l<=m;l++){var g=u-l,h=A.words[g]|0,M=_.words[l]|0,T=h*M,$=T&67108863;v=v+(T/67108864|0)|0,$=$+y|0,y=$&67108863,v=v+($>>>26)|0,f+=v>>>26,v&=67108863}d.words[u]=y,a=v,v=f}return a!==0?d.words[u]=a:d.length--,d.strip()}function R(A,_,d){var a=new N;return a.mulp(A,_,d)}n.prototype.mulTo=function(_,d){var a,f=this.length+_.length;return this.length===10&&_.length===10?a=D(this,_,d):f<63?a=S(this,_,d):f<1024?a=P(this,_,d):a=R(this,_,d),a};function N(A,_){this.x=A,this.y=_}N.prototype.makeRBT=function(_){for(var d=new Array(_),a=n.prototype._countBits(_)-1,f=0;f<_;f++)d[f]=this.revBin(f,a,_);return d},N.prototype.revBin=function(_,d,a){if(_===0||_===a-1)return _;for(var f=0,u=0;u<d;u++)f|=(_&1)<<d-u-1,_>>=1;return f},N.prototype.permute=function(_,d,a,f,u,v){for(var y=0;y<v;y++)f[y]=d[_[y]],u[y]=a[_[y]]},N.prototype.transform=function(_,d,a,f,u,v){this.permute(v,_,d,a,f,u);for(var y=1;y<u;y<<=1)for(var m=y<<1,l=Math.cos(2*Math.PI/m),g=Math.sin(2*Math.PI/m),h=0;h<u;h+=m)for(var M=l,T=g,$=0;$<y;$++){var q=a[h+$],G=f[h+$],H=a[h+$+y],V=f[h+$+y],Oe=M*H-T*V;V=M*V+T*H,H=Oe,a[h+$]=q+H,f[h+$]=G+V,a[h+$+y]=q-H,f[h+$+y]=G-V,$!==m&&(Oe=l*M-g*T,T=l*T+g*M,M=Oe)}},N.prototype.guessLen13b=function(_,d){var a=Math.max(d,_)|1,f=a&1,u=0;for(a=a/2|0;a;a=a>>>1)u++;return 1<<u+1+f},N.prototype.conjugate=function(_,d,a){if(!(a<=1))for(var f=0;f<a/2;f++){var u=_[f];_[f]=_[a-f-1],_[a-f-1]=u,u=d[f],d[f]=-d[a-f-1],d[a-f-1]=-u}},N.prototype.normalize13b=function(_,d){for(var a=0,f=0;f<d/2;f++){var u=Math.round(_[2*f+1]/d)*8192+Math.round(_[2*f]/d)+a;_[f]=u&67108863,u<67108864?a=0:a=u/67108864|0}return _},N.prototype.convert13b=function(_,d,a,f){for(var u=0,v=0;v<d;v++)u=u+(_[v]|0),a[2*v]=u&8191,u=u>>>13,a[2*v+1]=u&8191,u=u>>>13;for(v=2*d;v<f;++v)a[v]=0;i(u===0),i((u&-8192)===0)},N.prototype.stub=function(_){for(var d=new Array(_),a=0;a<_;a++)d[a]=0;return d},N.prototype.mulp=function(_,d,a){var f=2*this.guessLen13b(_.length,d.length),u=this.makeRBT(f),v=this.stub(f),y=new Array(f),m=new Array(f),l=new Array(f),g=new Array(f),h=new Array(f),M=new Array(f),T=a.words;T.length=f,this.convert13b(_.words,_.length,y,f),this.convert13b(d.words,d.length,g,f),this.transform(y,v,m,l,f,u),this.transform(g,v,h,M,f,u);for(var $=0;$<f;$++){var q=m[$]*h[$]-l[$]*M[$];l[$]=m[$]*M[$]+l[$]*h[$],m[$]=q}return this.conjugate(m,l,f),this.transform(m,l,T,v,f,u),this.conjugate(T,v,f),this.normalize13b(T,f),a.negative=_.negative^d.negative,a.length=_.length+d.length,a.strip()},n.prototype.mul=function(_){var d=new n(null);return d.words=new Array(this.length+_.length),this.mulTo(_,d)},n.prototype.mulf=function(_){var d=new n(null);return d.words=new Array(this.length+_.length),R(this,_,d)},n.prototype.imul=function(_){return this.clone().mulTo(_,this)},n.prototype.imuln=function(_){i(typeof _=="number"),i(_<67108864);for(var d=0,a=0;a<this.length;a++){var f=(this.words[a]|0)*_,u=(f&67108863)+(d&67108863);d>>=26,d+=f/67108864|0,d+=u>>>26,this.words[a]=u&67108863}return d!==0&&(this.words[a]=d,this.length++),this},n.prototype.muln=function(_){return this.clone().imuln(_)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(_){var d=I(_);if(d.length===0)return new n(1);for(var a=this,f=0;f<d.length&&d[f]===0;f++,a=a.sqr());if(++f<d.length)for(var u=a.sqr();f<d.length;f++,u=u.sqr())d[f]!==0&&(a=a.mul(u));return a},n.prototype.iushln=function(_){i(typeof _=="number"&&_>=0);var d=_%26,a=(_-d)/26,f=67108863>>>26-d<<26-d,u;if(d!==0){var v=0;for(u=0;u<this.length;u++){var y=this.words[u]&f,m=(this.words[u]|0)-y<<d;this.words[u]=m|v,v=y>>>26-d}v&&(this.words[u]=v,this.length++)}if(a!==0){for(u=this.length-1;u>=0;u--)this.words[u+a]=this.words[u];for(u=0;u<a;u++)this.words[u]=0;this.length+=a}return this.strip()},n.prototype.ishln=function(_){return i(this.negative===0),this.iushln(_)},n.prototype.iushrn=function(_,d,a){i(typeof _=="number"&&_>=0);var f;d?f=(d-d%26)/26:f=0;var u=_%26,v=Math.min((_-u)/26,this.length),y=67108863^67108863>>>u<<u,m=a;if(f-=v,f=Math.max(0,f),m){for(var l=0;l<v;l++)m.words[l]=this.words[l];m.length=v}if(v!==0)if(this.length>v)for(this.length-=v,l=0;l<this.length;l++)this.words[l]=this.words[l+v];else this.words[0]=0,this.length=1;var g=0;for(l=this.length-1;l>=0&&(g!==0||l>=f);l--){var h=this.words[l]|0;this.words[l]=g<<26-u|h>>>u,g=h&y}return m&&g!==0&&(m.words[m.length++]=g),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(_,d,a){return i(this.negative===0),this.iushrn(_,d,a)},n.prototype.shln=function(_){return this.clone().ishln(_)},n.prototype.ushln=function(_){return this.clone().iushln(_)},n.prototype.shrn=function(_){return this.clone().ishrn(_)},n.prototype.ushrn=function(_){return this.clone().iushrn(_)},n.prototype.testn=function(_){i(typeof _=="number"&&_>=0);var d=_%26,a=(_-d)/26,f=1<<d;if(this.length<=a)return!1;var u=this.words[a];return!!(u&f)},n.prototype.imaskn=function(_){i(typeof _=="number"&&_>=0);var d=_%26,a=(_-d)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=a)return this;if(d!==0&&a++,this.length=Math.min(a,this.length),d!==0){var f=67108863^67108863>>>d<<d;this.words[this.length-1]&=f}return this.strip()},n.prototype.maskn=function(_){return this.clone().imaskn(_)},n.prototype.iaddn=function(_){return i(typeof _=="number"),i(_<67108864),_<0?this.isubn(-_):this.negative!==0?this.length===1&&(this.words[0]|0)<_?(this.words[0]=_-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(_),this.negative=1,this):this._iaddn(_)},n.prototype._iaddn=function(_){this.words[0]+=_;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},n.prototype.isubn=function(_){if(i(typeof _=="number"),i(_<67108864),_<0)return this.iaddn(-_);if(this.negative!==0)return this.negative=0,this.iaddn(_),this.negative=1,this;if(this.words[0]-=_,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this.strip()},n.prototype.addn=function(_){return this.clone().iaddn(_)},n.prototype.subn=function(_){return this.clone().isubn(_)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(_,d,a){var f=_.length+a,u;this._expand(f);var v,y=0;for(u=0;u<_.length;u++){v=(this.words[u+a]|0)+y;var m=(_.words[u]|0)*d;v-=m&67108863,y=(v>>26)-(m/67108864|0),this.words[u+a]=v&67108863}for(;u<this.length-a;u++)v=(this.words[u+a]|0)+y,y=v>>26,this.words[u+a]=v&67108863;if(y===0)return this.strip();for(i(y===-1),y=0,u=0;u<this.length;u++)v=-(this.words[u]|0)+y,y=v>>26,this.words[u]=v&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(_,d){var a=this.length-_.length,f=this.clone(),u=_,v=u.words[u.length-1]|0,y=this._countBits(v);a=26-y,a!==0&&(u=u.ushln(a),f.iushln(a),v=u.words[u.length-1]|0);var m=f.length-u.length,l;if(d!=="mod"){l=new n(null),l.length=m+1,l.words=new Array(l.length);for(var g=0;g<l.length;g++)l.words[g]=0}var h=f.clone()._ishlnsubmul(u,1,m);h.negative===0&&(f=h,l&&(l.words[m]=1));for(var M=m-1;M>=0;M--){var T=(f.words[u.length+M]|0)*67108864+(f.words[u.length+M-1]|0);for(T=Math.min(T/v|0,67108863),f._ishlnsubmul(u,T,M);f.negative!==0;)T--,f.negative=0,f._ishlnsubmul(u,1,M),f.isZero()||(f.negative^=1);l&&(l.words[M]=T)}return l&&l.strip(),f.strip(),d!=="div"&&a!==0&&f.iushrn(a),{div:l||null,mod:f}},n.prototype.divmod=function(_,d,a){if(i(!_.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var f,u,v;return this.negative!==0&&_.negative===0?(v=this.neg().divmod(_,d),d!=="mod"&&(f=v.div.neg()),d!=="div"&&(u=v.mod.neg(),a&&u.negative!==0&&u.iadd(_)),{div:f,mod:u}):this.negative===0&&_.negative!==0?(v=this.divmod(_.neg(),d),d!=="mod"&&(f=v.div.neg()),{div:f,mod:v.mod}):this.negative&_.negative?(v=this.neg().divmod(_.neg(),d),d!=="div"&&(u=v.mod.neg(),a&&u.negative!==0&&u.isub(_)),{div:v.div,mod:u}):_.length>this.length||this.cmp(_)<0?{div:new n(0),mod:this}:_.length===1?d==="div"?{div:this.divn(_.words[0]),mod:null}:d==="mod"?{div:null,mod:new n(this.modn(_.words[0]))}:{div:this.divn(_.words[0]),mod:new n(this.modn(_.words[0]))}:this._wordDiv(_,d)},n.prototype.div=function(_){return this.divmod(_,"div",!1).div},n.prototype.mod=function(_){return this.divmod(_,"mod",!1).mod},n.prototype.umod=function(_){return this.divmod(_,"mod",!0).mod},n.prototype.divRound=function(_){var d=this.divmod(_);if(d.mod.isZero())return d.div;var a=d.div.negative!==0?d.mod.isub(_):d.mod,f=_.ushrn(1),u=_.andln(1),v=a.cmp(f);return v<0||u===1&&v===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},n.prototype.modn=function(_){i(_<=67108863);for(var d=(1<<26)%_,a=0,f=this.length-1;f>=0;f--)a=(d*a+(this.words[f]|0))%_;return a},n.prototype.idivn=function(_){i(_<=67108863);for(var d=0,a=this.length-1;a>=0;a--){var f=(this.words[a]|0)+d*67108864;this.words[a]=f/_|0,d=f%_}return this.strip()},n.prototype.divn=function(_){return this.clone().idivn(_)},n.prototype.egcd=function(_){i(_.negative===0),i(!_.isZero());var d=this,a=_.clone();d.negative!==0?d=d.umod(_):d=d.clone();for(var f=new n(1),u=new n(0),v=new n(0),y=new n(1),m=0;d.isEven()&&a.isEven();)d.iushrn(1),a.iushrn(1),++m;for(var l=a.clone(),g=d.clone();!d.isZero();){for(var h=0,M=1;!(d.words[0]&M)&&h<26;++h,M<<=1);if(h>0)for(d.iushrn(h);h-- >0;)(f.isOdd()||u.isOdd())&&(f.iadd(l),u.isub(g)),f.iushrn(1),u.iushrn(1);for(var T=0,$=1;!(a.words[0]&$)&&T<26;++T,$<<=1);if(T>0)for(a.iushrn(T);T-- >0;)(v.isOdd()||y.isOdd())&&(v.iadd(l),y.isub(g)),v.iushrn(1),y.iushrn(1);d.cmp(a)>=0?(d.isub(a),f.isub(v),u.isub(y)):(a.isub(d),v.isub(f),y.isub(u))}return{a:v,b:y,gcd:a.iushln(m)}},n.prototype._invmp=function(_){i(_.negative===0),i(!_.isZero());var d=this,a=_.clone();d.negative!==0?d=d.umod(_):d=d.clone();for(var f=new n(1),u=new n(0),v=a.clone();d.cmpn(1)>0&&a.cmpn(1)>0;){for(var y=0,m=1;!(d.words[0]&m)&&y<26;++y,m<<=1);if(y>0)for(d.iushrn(y);y-- >0;)f.isOdd()&&f.iadd(v),f.iushrn(1);for(var l=0,g=1;!(a.words[0]&g)&&l<26;++l,g<<=1);if(l>0)for(a.iushrn(l);l-- >0;)u.isOdd()&&u.iadd(v),u.iushrn(1);d.cmp(a)>=0?(d.isub(a),f.isub(u)):(a.isub(d),u.isub(f))}var h;return d.cmpn(1)===0?h=f:h=u,h.cmpn(0)<0&&h.iadd(_),h},n.prototype.gcd=function(_){if(this.isZero())return _.abs();if(_.isZero())return this.abs();var d=this.clone(),a=_.clone();d.negative=0,a.negative=0;for(var f=0;d.isEven()&&a.isEven();f++)d.iushrn(1),a.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;a.isEven();)a.iushrn(1);var u=d.cmp(a);if(u<0){var v=d;d=a,a=v}else if(u===0||a.cmpn(1)===0)break;d.isub(a)}while(!0);return a.iushln(f)},n.prototype.invm=function(_){return this.egcd(_).a.umod(_)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(_){return this.words[0]&_},n.prototype.bincn=function(_){i(typeof _=="number");var d=_%26,a=(_-d)/26,f=1<<d;if(this.length<=a)return this._expand(a+1),this.words[a]|=f,this;for(var u=f,v=a;u!==0&&v<this.length;v++){var y=this.words[v]|0;y+=u,u=y>>>26,y&=67108863,this.words[v]=y}return u!==0&&(this.words[v]=u,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(_){var d=_<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this.strip();var a;if(this.length>1)a=1;else{d&&(_=-_),i(_<=67108863,"Number is too big");var f=this.words[0]|0;a=f===_?0:f<_?-1:1}return this.negative!==0?-a|0:a},n.prototype.cmp=function(_){if(this.negative!==0&&_.negative===0)return-1;if(this.negative===0&&_.negative!==0)return 1;var d=this.ucmp(_);return this.negative!==0?-d|0:d},n.prototype.ucmp=function(_){if(this.length>_.length)return 1;if(this.length<_.length)return-1;for(var d=0,a=this.length-1;a>=0;a--){var f=this.words[a]|0,u=_.words[a]|0;if(f!==u){f<u?d=-1:f>u&&(d=1);break}}return d},n.prototype.gtn=function(_){return this.cmpn(_)===1},n.prototype.gt=function(_){return this.cmp(_)===1},n.prototype.gten=function(_){return this.cmpn(_)>=0},n.prototype.gte=function(_){return this.cmp(_)>=0},n.prototype.ltn=function(_){return this.cmpn(_)===-1},n.prototype.lt=function(_){return this.cmp(_)===-1},n.prototype.lten=function(_){return this.cmpn(_)<=0},n.prototype.lte=function(_){return this.cmp(_)<=0},n.prototype.eqn=function(_){return this.cmpn(_)===0},n.prototype.eq=function(_){return this.cmp(_)===0},n.red=function(_){return new z(_)},n.prototype.toRed=function(_){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),_.convertTo(this)._forceRed(_)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(_){return this.red=_,this},n.prototype.forceRed=function(_){return i(!this.red,"Already a number in reduction context"),this._forceRed(_)},n.prototype.redAdd=function(_){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,_)},n.prototype.redIAdd=function(_){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,_)},n.prototype.redSub=function(_){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,_)},n.prototype.redISub=function(_){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,_)},n.prototype.redShl=function(_){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,_)},n.prototype.redMul=function(_){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,_),this.red.mul(this,_)},n.prototype.redIMul=function(_){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,_),this.red.imul(this,_)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(_){return i(this.red&&!_.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,_)};var C={k256:null,p224:null,p192:null,p25519:null};function L(A,_){this.name=A,this.p=new n(_,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}L.prototype._tmp=function(){var _=new n(null);return _.words=new Array(Math.ceil(this.n/13)),_},L.prototype.ireduce=function(_){var d=_,a;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),a=d.bitLength();while(a>this.n);var f=a<this.n?-1:d.ucmp(this.p);return f===0?(d.words[0]=0,d.length=1):f>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},L.prototype.split=function(_,d){_.iushrn(this.n,0,d)},L.prototype.imulK=function(_){return _.imul(this.k)};function B(){L.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(B,L),B.prototype.split=function(_,d){for(var a=4194303,f=Math.min(_.length,9),u=0;u<f;u++)d.words[u]=_.words[u];if(d.length=f,_.length<=9){_.words[0]=0,_.length=1;return}var v=_.words[9];for(d.words[d.length++]=v&a,u=10;u<_.length;u++){var y=_.words[u]|0;_.words[u-10]=(y&a)<<4|v>>>22,v=y}v>>>=22,_.words[u-10]=v,v===0&&_.length>10?_.length-=10:_.length-=9},B.prototype.imulK=function(_){_.words[_.length]=0,_.words[_.length+1]=0,_.length+=2;for(var d=0,a=0;a<_.length;a++){var f=_.words[a]|0;d+=f*977,_.words[a]=d&67108863,d=f*64+(d/67108864|0)}return _.words[_.length-1]===0&&(_.length--,_.words[_.length-1]===0&&_.length--),_};function U(){L.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(U,L);function K(){L.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(K,L);function k(){L.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(k,L),k.prototype.imulK=function(_){for(var d=0,a=0;a<_.length;a++){var f=(_.words[a]|0)*19+d,u=f&67108863;f>>>=26,_.words[a]=u,d=f}return d!==0&&(_.words[_.length++]=d),_},n._prime=function(_){if(C[_])return C[_];var d;if(_==="k256")d=new B;else if(_==="p224")d=new U;else if(_==="p192")d=new K;else if(_==="p25519")d=new k;else throw new Error("Unknown prime "+_);return C[_]=d,d};function z(A){if(typeof A=="string"){var _=n._prime(A);this.m=_.p,this.prime=_}else i(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}z.prototype._verify1=function(_){i(_.negative===0,"red works only with positives"),i(_.red,"red works only with red numbers")},z.prototype._verify2=function(_,d){i((_.negative|d.negative)===0,"red works only with positives"),i(_.red&&_.red===d.red,"red works only with red numbers")},z.prototype.imod=function(_){return this.prime?this.prime.ireduce(_)._forceRed(this):_.umod(this.m)._forceRed(this)},z.prototype.neg=function(_){return _.isZero()?_.clone():this.m.sub(_)._forceRed(this)},z.prototype.add=function(_,d){this._verify2(_,d);var a=_.add(d);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},z.prototype.iadd=function(_,d){this._verify2(_,d);var a=_.iadd(d);return a.cmp(this.m)>=0&&a.isub(this.m),a},z.prototype.sub=function(_,d){this._verify2(_,d);var a=_.sub(d);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},z.prototype.isub=function(_,d){this._verify2(_,d);var a=_.isub(d);return a.cmpn(0)<0&&a.iadd(this.m),a},z.prototype.shl=function(_,d){return this._verify1(_),this.imod(_.ushln(d))},z.prototype.imul=function(_,d){return this._verify2(_,d),this.imod(_.imul(d))},z.prototype.mul=function(_,d){return this._verify2(_,d),this.imod(_.mul(d))},z.prototype.isqr=function(_){return this.imul(_,_.clone())},z.prototype.sqr=function(_){return this.mul(_,_)},z.prototype.sqrt=function(_){if(_.isZero())return _.clone();var d=this.m.andln(3);if(i(d%2===1),d===3){var a=this.m.add(new n(1)).iushrn(2);return this.pow(_,a)}for(var f=this.m.subn(1),u=0;!f.isZero()&&f.andln(1)===0;)u++,f.iushrn(1);i(!f.isZero());var v=new n(1).toRed(this),y=v.redNeg(),m=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);this.pow(l,m).cmp(y)!==0;)l.redIAdd(y);for(var g=this.pow(l,f),h=this.pow(_,f.addn(1).iushrn(1)),M=this.pow(_,f),T=u;M.cmp(v)!==0;){for(var $=M,q=0;$.cmp(v)!==0;q++)$=$.redSqr();i(q<T);var G=this.pow(g,new n(1).iushln(T-q-1));h=h.redMul(G),g=G.redSqr(),M=M.redMul(g),T=q}return h},z.prototype.invm=function(_){var d=_._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},z.prototype.pow=function(_,d){if(d.isZero())return new n(1).toRed(this);if(d.cmpn(1)===0)return _.clone();var a=4,f=new Array(1<<a);f[0]=new n(1).toRed(this),f[1]=_;for(var u=2;u<f.length;u++)f[u]=this.mul(f[u-1],_);var v=f[0],y=0,m=0,l=d.bitLength()%26;for(l===0&&(l=26),u=d.length-1;u>=0;u--){for(var g=d.words[u],h=l-1;h>=0;h--){var M=g>>h&1;if(v!==f[0]&&(v=this.sqr(v)),M===0&&y===0){m=0;continue}y<<=1,y|=M,m++,!(m!==a&&(u!==0||h!==0))&&(v=this.mul(v,f[y]),m=0,y=0)}l=26}return v},z.prototype.convertTo=function(_){var d=_.umod(this.m);return d===_?d.clone():d},z.prototype.convertFrom=function(_){var d=_.clone();return d.red=null,d},n.mont=function(_){return new pe(_)};function pe(A){z.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(pe,z),pe.prototype.convertTo=function(_){return this.imod(_.ushln(this.shift))},pe.prototype.convertFrom=function(_){var d=this.imod(_.mul(this.rinv));return d.red=null,d},pe.prototype.imul=function(_,d){if(_.isZero()||d.isZero())return _.words[0]=0,_.length=1,_;var a=_.imul(d),f=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=a.isub(f).iushrn(this.shift),v=u;return u.cmp(this.m)>=0?v=u.isub(this.m):u.cmpn(0)<0&&(v=u.iadd(this.m)),v._forceRed(this)},pe.prototype.mul=function(_,d){if(_.isZero()||d.isZero())return new n(0)._forceRed(this);var a=_.mul(d),f=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=a.isub(f).iushrn(this.shift),v=u;return u.cmp(this.m)>=0?v=u.isub(this.m):u.cmpn(0)<0&&(v=u.iadd(this.m)),v._forceRed(this)},pe.prototype.invm=function(_){var d=this.imod(_._invmp(this.m).mul(this.r2));return d._forceRed(this)}})(t,Zi)})($f);var yi=$f.exports,Tf={};(function(t){var e=t;function r(n,o){if(Array.isArray(n))return n.slice();if(!n)return[];var c=[];if(typeof n!="string"){for(var p=0;p<n.length;p++)c[p]=n[p]|0;return c}if(o==="hex"){n=n.replace(/[^a-z0-9]+/ig,""),n.length%2!==0&&(n="0"+n);for(var p=0;p<n.length;p+=2)c.push(parseInt(n[p]+n[p+1],16))}else for(var p=0;p<n.length;p++){var b=n.charCodeAt(p),w=b>>8,x=b&255;w?c.push(w,x):c.push(x)}return c}e.toArray=r;function i(n){return n.length===1?"0"+n:n}e.zero2=i;function s(n){for(var o="",c=0;c<n.length;c++)o+=i(n[c].toString(16));return o}e.toHex=s,e.encode=function(o,c){return c==="hex"?s(o):o}})(Tf);(function(t){var e=t,r=yi,i=hn,s=Tf;e.assert=i,e.toArray=s.toArray,e.zero2=s.zero2,e.toHex=s.toHex,e.encode=s.encode;function n(w,x,E){var I=new Array(Math.max(w.bitLength(),E)+1),S;for(S=0;S<I.length;S+=1)I[S]=0;var D=1<<x+1,P=w.clone();for(S=0;S<I.length;S++){var R,N=P.andln(D-1);P.isOdd()?(N>(D>>1)-1?R=(D>>1)-N:R=N,P.isubn(R)):R=0,I[S]=R,P.iushrn(1)}return I}e.getNAF=n;function o(w,x){var E=[[],[]];w=w.clone(),x=x.clone();for(var I=0,S=0,D;w.cmpn(-I)>0||x.cmpn(-S)>0;){var P=w.andln(3)+I&3,R=x.andln(3)+S&3;P===3&&(P=-1),R===3&&(R=-1);var N;P&1?(D=w.andln(7)+I&7,(D===3||D===5)&&R===2?N=-P:N=P):N=0,E[0].push(N);var C;R&1?(D=x.andln(7)+S&7,(D===3||D===5)&&P===2?C=-R:C=R):C=0,E[1].push(C),2*I===N+1&&(I=1-I),2*S===C+1&&(S=1-S),w.iushrn(1),x.iushrn(1)}return E}e.getJSF=o;function c(w,x,E){var I="_"+x;w.prototype[x]=function(){return this[I]!==void 0?this[I]:this[I]=E.call(this)}}e.cachedProperty=c;function p(w){return typeof w=="string"?e.toArray(w,"hex"):w}e.parseBytes=p;function b(w){return new r(w,"hex","le")}e.intFromLE=b})(yr);var Ff={exports:{}},_o;Ff.exports=function(e){return _o||(_o=new Oi(null)),_o.generate(e)};function Oi(t){this.rand=t}Ff.exports.Rand=Oi;Oi.prototype.generate=function(e){return this._rand(e)};Oi.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Oi.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Oi.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Oi.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var lc=_a;if(typeof lc.randomBytes!="function")throw new Error("Not supported");Oi.prototype._rand=function(e){return lc.randomBytes(e)}}catch{}var nl=Ff.exports,Cf={},ji=yi,Es=yr,ua=Es.getNAF,p3=Es.getJSF,da=Es.assert;function Ci(t,e){this.type=t,this.p=new ji(e.p,16),this.red=e.prime?ji.red(e.prime):ji.mont(this.p),this.zero=new ji(0).toRed(this.red),this.one=new ji(1).toRed(this.red),this.two=new ji(2).toRed(this.red),this.n=e.n&&new ji(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ta=Ci;Ci.prototype.point=function(){throw new Error("Not implemented")};Ci.prototype.validate=function(){throw new Error("Not implemented")};Ci.prototype._fixedNafMul=function(e,r){da(e.precomputed);var i=e._getDoubles(),s=ua(r,1,this._bitLength),n=(1<<i.step+1)-(i.step%2===0?2:1);n/=3;var o=[],c,p;for(c=0;c<s.length;c+=i.step){p=0;for(var b=c+i.step-1;b>=c;b--)p=(p<<1)+s[b];o.push(p)}for(var w=this.jpoint(null,null,null),x=this.jpoint(null,null,null),E=n;E>0;E--){for(c=0;c<o.length;c++)p=o[c],p===E?x=x.mixedAdd(i.points[c]):p===-E&&(x=x.mixedAdd(i.points[c].neg()));w=w.add(x)}return w.toP()};Ci.prototype._wnafMul=function(e,r){var i=4,s=e._getNAFPoints(i);i=s.wnd;for(var n=s.points,o=ua(r,i,this._bitLength),c=this.jpoint(null,null,null),p=o.length-1;p>=0;p--){for(var b=0;p>=0&&o[p]===0;p--)b++;if(p>=0&&b++,c=c.dblp(b),p<0)break;var w=o[p];da(w!==0),e.type==="affine"?w>0?c=c.mixedAdd(n[w-1>>1]):c=c.mixedAdd(n[-w-1>>1].neg()):w>0?c=c.add(n[w-1>>1]):c=c.add(n[-w-1>>1].neg())}return e.type==="affine"?c.toP():c};Ci.prototype._wnafMulAdd=function(e,r,i,s,n){var o=this._wnafT1,c=this._wnafT2,p=this._wnafT3,b=0,w,x,E;for(w=0;w<s;w++){E=r[w];var I=E._getNAFPoints(e);o[w]=I.wnd,c[w]=I.points}for(w=s-1;w>=1;w-=2){var S=w-1,D=w;if(o[S]!==1||o[D]!==1){p[S]=ua(i[S],o[S],this._bitLength),p[D]=ua(i[D],o[D],this._bitLength),b=Math.max(p[S].length,b),b=Math.max(p[D].length,b);continue}var P=[r[S],null,null,r[D]];r[S].y.cmp(r[D].y)===0?(P[1]=r[S].add(r[D]),P[2]=r[S].toJ().mixedAdd(r[D].neg())):r[S].y.cmp(r[D].y.redNeg())===0?(P[1]=r[S].toJ().mixedAdd(r[D]),P[2]=r[S].add(r[D].neg())):(P[1]=r[S].toJ().mixedAdd(r[D]),P[2]=r[S].toJ().mixedAdd(r[D].neg()));var R=[-3,-1,-5,-7,0,7,5,1,3],N=p3(i[S],i[D]);for(b=Math.max(N[0].length,b),p[S]=new Array(b),p[D]=new Array(b),x=0;x<b;x++){var C=N[0][x]|0,L=N[1][x]|0;p[S][x]=R[(C+1)*3+(L+1)],p[D][x]=0,c[S]=P}}var B=this.jpoint(null,null,null),U=this._wnafT4;for(w=b;w>=0;w--){for(var K=0;w>=0;){var k=!0;for(x=0;x<s;x++)U[x]=p[x][w]|0,U[x]!==0&&(k=!1);if(!k)break;K++,w--}if(w>=0&&K++,B=B.dblp(K),w<0)break;for(x=0;x<s;x++){var z=U[x];z!==0&&(z>0?E=c[x][z-1>>1]:z<0&&(E=c[x][-z-1>>1].neg()),E.type==="affine"?B=B.mixedAdd(E):B=B.add(E))}}for(w=0;w<s;w++)c[w]=null;return n?B:B.toP()};function Pr(t,e){this.curve=t,this.type=e,this.precomputed=null}Ci.BasePoint=Pr;Pr.prototype.eq=function(){throw new Error("Not implemented")};Pr.prototype.validate=function(){return this.curve.validate(this)};Ci.prototype.decodePoint=function(e,r){e=Es.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?da(e[e.length-1]%2===0):e[0]===7&&da(e[e.length-1]%2===1);var s=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return s}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Pr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Pr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};Pr.prototype.encode=function(e,r){return Es.encode(this._encode(r),e)};Pr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};Pr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};Pr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],s=this,n=0;n<r;n+=e){for(var o=0;o<e;o++)s=s.dbl();i.push(s)}return{step:e,points:i}};Pr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,s=i===1?null:this.dbl(),n=1;n<i;n++)r[n]=r[n-1].add(s);return{wnd:e,points:r}};Pr.prototype._getBeta=function(){return null};Pr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var g3=yr,pt=yi,Lf=Oa,kn=Ta,v3=g3.assert;function Rr(t){kn.call(this,"short",t),this.a=new pt(t.a,16).toRed(this.red),this.b=new pt(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Lf(Rr,kn);var b3=Rr;Rr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new pt(e.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);r=s[0].cmp(s[1])<0?s[0]:s[1],r=r.toRed(this.red)}if(e.lambda)i=new pt(e.lambda,16);else{var n=this._getEndoRoots(this.n);this.g.mul(n[0]).x.cmp(this.g.x.redMul(r))===0?i=n[0]:(i=n[1],v3(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(c){return{a:new pt(c.a,16),b:new pt(c.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};Rr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:pt.mont(e),i=new pt(2).toRed(r).redInvm(),s=i.redNeg(),n=new pt(3).toRed(r).redNeg().redSqrt().redMul(i),o=s.redAdd(n).fromRed(),c=s.redSub(n).fromRed();return[o,c]};Rr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,s=this.n.clone(),n=new pt(1),o=new pt(0),c=new pt(0),p=new pt(1),b,w,x,E,I,S,D,P=0,R,N;i.cmpn(0)!==0;){var C=s.div(i);R=s.sub(C.mul(i)),N=c.sub(C.mul(n));var L=p.sub(C.mul(o));if(!x&&R.cmp(r)<0)b=D.neg(),w=n,x=R.neg(),E=N;else if(x&&++P===2)break;D=R,s=i,i=R,c=n,n=N,p=o,o=L}I=R.neg(),S=N;var B=x.sqr().add(E.sqr()),U=I.sqr().add(S.sqr());return U.cmp(B)>=0&&(I=b,S=w),x.negative&&(x=x.neg(),E=E.neg()),I.negative&&(I=I.neg(),S=S.neg()),[{a:x,b:E},{a:I,b:S}]};Rr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],s=r[1],n=s.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),c=n.mul(i.a),p=o.mul(s.a),b=n.mul(i.b),w=o.mul(s.b),x=e.sub(c).sub(p),E=b.add(w).neg();return{k1:x,k2:E}};Rr.prototype.pointFromX=function(e,r){e=new pt(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=i.redSqrt();if(s.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var n=s.fromRed().isOdd();return(r&&!n||!r&&n)&&(s=s.redNeg()),this.point(e,s)};Rr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,s=this.a.redMul(r),n=r.redSqr().redMul(r).redIAdd(s).redIAdd(this.b);return i.redSqr().redISub(n).cmpn(0)===0};Rr.prototype._endoWnafMulAdd=function(e,r,i){for(var s=this._endoWnafT1,n=this._endoWnafT2,o=0;o<e.length;o++){var c=this._endoSplit(r[o]),p=e[o],b=p._getBeta();c.k1.negative&&(c.k1.ineg(),p=p.neg(!0)),c.k2.negative&&(c.k2.ineg(),b=b.neg(!0)),s[o*2]=p,s[o*2+1]=b,n[o*2]=c.k1,n[o*2+1]=c.k2}for(var w=this._wnafMulAdd(1,s,n,o*2,i),x=0;x<o*2;x++)s[x]=null,n[x]=null;return w};function Rt(t,e,r,i){kn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new pt(e,16),this.y=new pt(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Lf(Rt,kn.BasePoint);Rr.prototype.point=function(e,r,i){return new Rt(this,e,r,i)};Rr.prototype.pointFromJSON=function(e,r){return Rt.fromJSON(this,e,r)};Rt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,s=function(n){return i.point(n.x.redMul(i.endo.beta),n.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(s)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(s)}}}return r}};Rt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Rt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var s=e.point(r[0],r[1],i);if(!r[2])return s;function n(c){return e.point(c[0],c[1],i)}var o=r[2];return s.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[s].concat(o.doubles.points.map(n))},naf:o.naf&&{wnd:o.naf.wnd,points:[s].concat(o.naf.points.map(n))}},s};Rt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Rt.prototype.isInfinity=function(){return this.inf};Rt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),s=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)};Rt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),s=e.redInvm(),n=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(s),o=n.redSqr().redISub(this.x.redAdd(this.x)),c=n.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,c)};Rt.prototype.getX=function(){return this.x.fromRed()};Rt.prototype.getY=function(){return this.y.fromRed()};Rt.prototype.mul=function(e){return e=new pt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Rt.prototype.mulAdd=function(e,r,i){var s=[this,r],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,n):this.curve._wnafMulAdd(1,s,n,2)};Rt.prototype.jmulAdd=function(e,r,i){var s=[this,r],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(s,n,!0):this.curve._wnafMulAdd(1,s,n,2,!0)};Rt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Rt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,s=function(n){return n.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(s)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(s)}}}return r};Rt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Lt(t,e,r,i){kn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new pt(0)):(this.x=new pt(e,16),this.y=new pt(r,16),this.z=new pt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Lf(Lt,kn.BasePoint);Rr.prototype.jpoint=function(e,r,i){return new Lt(this,e,r,i)};Lt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),s=this.y.redMul(r).redMul(e);return this.curve.point(i,s)};Lt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Lt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),s=this.x.redMul(r),n=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(i.redMul(this.z)),p=s.redSub(n),b=o.redSub(c);if(p.cmpn(0)===0)return b.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var w=p.redSqr(),x=w.redMul(p),E=s.redMul(w),I=b.redSqr().redIAdd(x).redISub(E).redISub(E),S=b.redMul(E.redISub(I)).redISub(o.redMul(x)),D=this.z.redMul(e.z).redMul(p);return this.curve.jpoint(I,S,D)};Lt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,s=e.x.redMul(r),n=this.y,o=e.y.redMul(r).redMul(this.z),c=i.redSub(s),p=n.redSub(o);if(c.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=c.redSqr(),w=b.redMul(c),x=i.redMul(b),E=p.redSqr().redIAdd(w).redISub(x).redISub(x),I=p.redMul(x.redISub(E)).redISub(n.redMul(w)),S=this.z.redMul(c);return this.curve.jpoint(E,I,S)};Lt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var s=this.curve.a,n=this.curve.tinv,o=this.x,c=this.y,p=this.z,b=p.redSqr().redSqr(),w=c.redAdd(c);for(r=0;r<e;r++){var x=o.redSqr(),E=w.redSqr(),I=E.redSqr(),S=x.redAdd(x).redIAdd(x).redIAdd(s.redMul(b)),D=o.redMul(E),P=S.redSqr().redISub(D.redAdd(D)),R=D.redISub(P),N=S.redMul(R);N=N.redIAdd(N).redISub(I);var C=w.redMul(p);r+1<e&&(b=b.redMul(I)),o=P,p=C,w=N}return this.curve.jpoint(o,w.redMul(n),p)};Lt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Lt.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var s=this.x.redSqr(),n=this.y.redSqr(),o=n.redSqr(),c=this.x.redAdd(n).redSqr().redISub(s).redISub(o);c=c.redIAdd(c);var p=s.redAdd(s).redIAdd(s),b=p.redSqr().redISub(c).redISub(c),w=o.redIAdd(o);w=w.redIAdd(w),w=w.redIAdd(w),e=b,r=p.redMul(c.redISub(b)).redISub(w),i=this.y.redAdd(this.y)}else{var x=this.x.redSqr(),E=this.y.redSqr(),I=E.redSqr(),S=this.x.redAdd(E).redSqr().redISub(x).redISub(I);S=S.redIAdd(S);var D=x.redAdd(x).redIAdd(x),P=D.redSqr(),R=I.redIAdd(I);R=R.redIAdd(R),R=R.redIAdd(R),e=P.redISub(S).redISub(S),r=D.redMul(S.redISub(e)).redISub(R),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};Lt.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var s=this.x.redSqr(),n=this.y.redSqr(),o=n.redSqr(),c=this.x.redAdd(n).redSqr().redISub(s).redISub(o);c=c.redIAdd(c);var p=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),b=p.redSqr().redISub(c).redISub(c);e=b;var w=o.redIAdd(o);w=w.redIAdd(w),w=w.redIAdd(w),r=p.redMul(c.redISub(b)).redISub(w),i=this.y.redAdd(this.y)}else{var x=this.z.redSqr(),E=this.y.redSqr(),I=this.x.redMul(E),S=this.x.redSub(x).redMul(this.x.redAdd(x));S=S.redAdd(S).redIAdd(S);var D=I.redIAdd(I);D=D.redIAdd(D);var P=D.redAdd(D);e=S.redSqr().redISub(P),i=this.y.redAdd(this.z).redSqr().redISub(E).redISub(x);var R=E.redSqr();R=R.redIAdd(R),R=R.redIAdd(R),R=R.redIAdd(R),r=S.redMul(D.redISub(e)).redISub(R)}return this.curve.jpoint(e,r,i)};Lt.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,s=this.z,n=s.redSqr().redSqr(),o=r.redSqr(),c=i.redSqr(),p=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(n)),b=r.redAdd(r);b=b.redIAdd(b);var w=b.redMul(c),x=p.redSqr().redISub(w.redAdd(w)),E=w.redISub(x),I=c.redSqr();I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=p.redMul(E).redISub(I),D=i.redAdd(i).redMul(s);return this.curve.jpoint(x,S,D)};Lt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),s=r.redSqr(),n=e.redAdd(e).redIAdd(e),o=n.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(s);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(o);var p=c.redSqr(),b=s.redIAdd(s);b=b.redIAdd(b),b=b.redIAdd(b),b=b.redIAdd(b);var w=n.redIAdd(c).redSqr().redISub(o).redISub(p).redISub(b),x=r.redMul(w);x=x.redIAdd(x),x=x.redIAdd(x);var E=this.x.redMul(p).redISub(x);E=E.redIAdd(E),E=E.redIAdd(E);var I=this.y.redMul(w.redMul(b.redISub(w)).redISub(c.redMul(p)));I=I.redIAdd(I),I=I.redIAdd(I),I=I.redIAdd(I);var S=this.z.redAdd(c).redSqr().redISub(i).redISub(p);return this.curve.jpoint(E,I,S)};Lt.prototype.mul=function(e,r){return e=new pt(e,r),this.curve._wnafMul(this,e)};Lt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var s=r.redMul(this.z),n=i.redMul(e.z);return this.y.redMul(n).redISub(e.y.redMul(s)).cmpn(0)===0};Lt.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var s=e.clone(),n=this.curve.redN.redMul(r);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(n),this.x.cmp(i)===0)return!0}};Lt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Lt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var xn=yi,sl=Oa,Fa=Ta,m3=yr;function jn(t){Fa.call(this,"mont",t),this.a=new xn(t.a,16).toRed(this.red),this.b=new xn(t.b,16).toRed(this.red),this.i4=new xn(4).toRed(this.red).redInvm(),this.two=new xn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}sl(jn,Fa);var y3=jn;jn.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),s=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),n=s.redSqrt();return n.redSqr().cmp(s)===0};function Ot(t,e,r){Fa.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new xn(e,16),this.z=new xn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}sl(Ot,Fa.BasePoint);jn.prototype.decodePoint=function(e,r){return this.point(m3.toArray(e,r),1)};jn.prototype.point=function(e,r){return new Ot(this,e,r)};jn.prototype.pointFromJSON=function(e){return Ot.fromJSON(this,e)};Ot.prototype.precompute=function(){};Ot.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Ot.fromJSON=function(e,r){return new Ot(e,r[0],r[1]||e.one)};Ot.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ot.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Ot.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),s=i.redSqr(),n=r.redSub(s),o=r.redMul(s),c=n.redMul(s.redAdd(this.curve.a24.redMul(n)));return this.curve.point(o,c)};Ot.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Ot.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),s=this.x.redSub(this.z),n=e.x.redAdd(e.z),o=e.x.redSub(e.z),c=o.redMul(i),p=n.redMul(s),b=r.z.redMul(c.redAdd(p).redSqr()),w=r.x.redMul(c.redISub(p).redSqr());return this.curve.point(b,w)};Ot.prototype.mul=function(e){for(var r=e.clone(),i=this,s=this.curve.point(null,null),n=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var c=o.length-1;c>=0;c--)o[c]===0?(i=i.diffAdd(s,n),s=s.dbl()):(s=i.diffAdd(s,n),i=i.dbl());return s};Ot.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Ot.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Ot.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Ot.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Ot.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var w3=yr,gi=yi,al=Oa,Ca=Ta,_3=w3.assert;function si(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,Ca.call(this,"edwards",t),this.a=new gi(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new gi(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new gi(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),_3(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}al(si,Ca);var x3=si;si.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};si.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};si.prototype.jpoint=function(e,r,i,s){return this.point(e,r,i,s)};si.prototype.pointFromX=function(e,r){e=new gi(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),s=this.c2.redSub(this.a.redMul(i)),n=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=s.redMul(n.redInvm()),c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var p=c.fromRed().isOdd();return(r&&!p||!r&&p)&&(c=c.redNeg()),this.point(e,c)};si.prototype.pointFromY=function(e,r){e=new gi(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),s=i.redSub(this.c2),n=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=s.redMul(n.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var c=o.redSqrt();if(c.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return c.fromRed().isOdd()!==r&&(c=c.redNeg()),this.point(c,e)};si.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),s=r.redMul(this.a).redAdd(i),n=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return s.cmp(n)===0};function ft(t,e,r,i,s){Ca.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new gi(e,16),this.y=new gi(r,16),this.z=i?new gi(i,16):this.curve.one,this.t=s&&new gi(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}al(ft,Ca.BasePoint);si.prototype.pointFromJSON=function(e){return ft.fromJSON(this,e)};si.prototype.point=function(e,r,i,s){return new ft(this,e,r,i,s)};ft.fromJSON=function(e,r){return new ft(e,r[0],r[1],r[2])};ft.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ft.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};ft.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var s=this.curve._mulA(e),n=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=s.redAdd(r),c=o.redSub(i),p=s.redSub(r),b=n.redMul(c),w=o.redMul(p),x=n.redMul(p),E=c.redMul(o);return this.curve.point(b,w,E,x)};ft.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),s,n,o,c,p,b;if(this.curve.twisted){c=this.curve._mulA(r);var w=c.redAdd(i);this.zOne?(s=e.redSub(r).redSub(i).redMul(w.redSub(this.curve.two)),n=w.redMul(c.redSub(i)),o=w.redSqr().redSub(w).redSub(w)):(p=this.z.redSqr(),b=w.redSub(p).redISub(p),s=e.redSub(r).redISub(i).redMul(b),n=w.redMul(c.redSub(i)),o=w.redMul(b))}else c=r.redAdd(i),p=this.curve._mulC(this.z).redSqr(),b=c.redSub(p).redSub(p),s=this.curve._mulC(e.redISub(c)).redMul(b),n=this.curve._mulC(c).redMul(r.redISub(i)),o=c.redMul(b);return this.curve.point(s,n,o)};ft.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};ft.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),s=this.t.redMul(this.curve.dd).redMul(e.t),n=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),c=n.redSub(s),p=n.redAdd(s),b=i.redAdd(r),w=o.redMul(c),x=p.redMul(b),E=o.redMul(b),I=c.redMul(p);return this.curve.point(w,x,I,E)};ft.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),s=this.x.redMul(e.x),n=this.y.redMul(e.y),o=this.curve.d.redMul(s).redMul(n),c=i.redSub(o),p=i.redAdd(o),b=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(n),w=r.redMul(c).redMul(b),x,E;return this.curve.twisted?(x=r.redMul(p).redMul(n.redSub(this.curve._mulA(s))),E=c.redMul(p)):(x=r.redMul(p).redMul(n.redSub(s)),E=this.curve._mulC(c).redMul(p)),this.curve.point(w,x,E)};ft.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};ft.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};ft.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};ft.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};ft.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};ft.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};ft.prototype.getX=function(){return this.normalize(),this.x.fromRed()};ft.prototype.getY=function(){return this.normalize(),this.y.fromRed()};ft.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};ft.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(s),this.x.cmp(r)===0)return!0}};ft.prototype.toP=ft.prototype.normalize;ft.prototype.mixedAdd=ft.prototype.add;(function(t){var e=t;e.base=Ta,e.short=b3,e.mont=y3,e.edwards=x3})(Cf);var La={},xo,pc;function M3(){return pc||(pc=1,xo={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),xo}(function(t){var e=t,r=xs,i=Cf,s=yr,n=s.assert;function o(b){b.type==="short"?this.curve=new i.short(b):b.type==="edwards"?this.curve=new i.edwards(b):this.curve=new i.mont(b),this.g=this.curve.g,this.n=this.curve.n,this.hash=b.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function c(b,w){Object.defineProperty(e,b,{configurable:!0,enumerable:!0,get:function(){var x=new o(w);return Object.defineProperty(e,b,{configurable:!0,enumerable:!0,value:x}),x}})}c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var p;try{p=M3()}catch{p=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",p]})})(La);var E3=xs,en=Tf,ol=hn;function Ti(t){if(!(this instanceof Ti))return new Ti(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=en.toArray(t.entropy,t.entropyEnc||"hex"),r=en.toArray(t.nonce,t.nonceEnc||"hex"),i=en.toArray(t.pers,t.persEnc||"hex");ol(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var S3=Ti;Ti.prototype._init=function(e,r,i){var s=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656};Ti.prototype._hmac=function(){return new E3.hmac(this.hash,this.K)};Ti.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Ti.prototype.reseed=function(e,r,i,s){typeof r!="string"&&(s=i,i=r,r=null),e=en.toArray(e,r),i=en.toArray(i,s),ol(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};Ti.prototype.generate=function(e,r,i,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(s=i,i=r,r=null),i&&(i=en.toArray(i,s||"hex"),this._update(i));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var o=n.slice(0,e);return this._update(i),this._reseed++,en.encode(o,r)};var I3=yi,A3=yr,ef=A3.assert;function kt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var D3=kt;kt.fromPublic=function(e,r,i){return r instanceof kt?r:new kt(e,{pub:r,pubEnc:i})};kt.fromPrivate=function(e,r,i){return r instanceof kt?r:new kt(e,{priv:r,privEnc:i})};kt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};kt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};kt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};kt.prototype._importPrivate=function(e,r){this.priv=new I3(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};kt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?ef(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&ef(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};kt.prototype.derive=function(e){return e.validate()||ef(e.validate(),"public point not validated"),e.mul(this.priv).getX()};kt.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};kt.prototype.verify=function(e,r,i){return this.ec.verify(e,r,this,void 0,i)};kt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var la=yi,qf=yr,O3=qf.assert;function qa(t,e){if(t instanceof qa)return t;this._importDER(t,e)||(O3(t.r&&t.s,"Signature without r or s"),this.r=new la(t.r,16),this.s=new la(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var P3=qa;function R3(){this.place=0}function Mo(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4||t[e.place]===0)return!1;for(var s=0,n=0,o=e.place;n<i;n++,o++)s<<=8,s|=t[o],s>>>=0;return s<=127?!1:(e.place=o,s)}function gc(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}qa.prototype._importDER=function(e,r){e=qf.toArray(e,r);var i=new R3;if(e[i.place++]!==48)return!1;var s=Mo(e,i);if(s===!1||s+i.place!==e.length||e[i.place++]!==2)return!1;var n=Mo(e,i);if(n===!1||e[i.place]&128)return!1;var o=e.slice(i.place,n+i.place);if(i.place+=n,e[i.place++]!==2)return!1;var c=Mo(e,i);if(c===!1||e.length!==c+i.place||e[i.place]&128)return!1;var p=e.slice(i.place,c+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(p[0]===0)if(p[1]&128)p=p.slice(1);else return!1;return this.r=new la(o),this.s=new la(p),this.recoveryParam=null,!0};function Eo(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}qa.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=gc(r),i=gc(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var s=[2];Eo(s,r.length),s=s.concat(r),s.push(2),Eo(s,i.length);var n=s.concat(i),o=[48];return Eo(o,n.length),o=o.concat(n),qf.encode(o,e)};var zr=yi,fl=S3,N3=yr,So=La,$3=nl,Gi=N3.assert,Bf=D3,Ba=P3;function Ar(t){if(!(this instanceof Ar))return new Ar(t);typeof t=="string"&&(Gi(Object.prototype.hasOwnProperty.call(So,t),"Unknown curve "+t),t=So[t]),t instanceof So.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var T3=Ar;Ar.prototype.keyPair=function(e){return new Bf(this,e)};Ar.prototype.keyFromPrivate=function(e,r){return Bf.fromPrivate(this,e,r)};Ar.prototype.keyFromPublic=function(e,r){return Bf.fromPublic(this,e,r)};Ar.prototype.genKeyPair=function(e){e||(e={});for(var r=new fl({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||$3(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),s=this.n.sub(new zr(2));;){var n=new zr(r.generate(i));if(!(n.cmp(s)>0))return n.iaddn(1),this.keyFromPrivate(n)}};Ar.prototype._truncateToN=function(e,r,i){var s;if(zr.isBN(e)||typeof e=="number")e=new zr(e,16),s=e.byteLength();else if(typeof e=="object")s=e.length,e=new zr(e,16);else{var n=e.toString();s=n.length+1>>>1,e=new zr(n,16)}typeof i!="number"&&(i=s*8);var o=i-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Ar.prototype.sign=function(e,r,i,s){if(typeof i=="object"&&(s=i,i=null),s||(s={}),typeof e!="string"&&typeof e!="number"&&!zr.isBN(e)){Gi(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Gi(e.length>>>0===e.length);for(var n=0;n<e.length;n++)Gi((e[n]&255)===e[n])}r=this.keyFromPrivate(r,i),e=this._truncateToN(e,!1,s.msgBitLength),Gi(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),c=r.getPrivate().toArray("be",o),p=e.toArray("be",o);Gi(new zr(p).eq(e),"Can not sign message");for(var b=new fl({hash:this.hash,entropy:c,nonce:p,pers:s.pers,persEnc:s.persEnc||"utf8"}),w=this.n.sub(new zr(1)),x=0;;x++){var E=s.k?s.k(x):new zr(b.generate(this.n.byteLength()));if(E=this._truncateToN(E,!0),!(E.cmpn(1)<=0||E.cmp(w)>=0)){var I=this.g.mul(E);if(!I.isInfinity()){var S=I.getX(),D=S.umod(this.n);if(D.cmpn(0)!==0){var P=E.invm(this.n).mul(D.mul(r.getPrivate()).iadd(e));if(P=P.umod(this.n),P.cmpn(0)!==0){var R=(I.getY().isOdd()?1:0)|(S.cmp(D)!==0?2:0);return s.canonical&&P.cmp(this.nh)>0&&(P=this.n.sub(P),R^=1),new Ba({r:D,s:P,recoveryParam:R})}}}}}};Ar.prototype.verify=function(e,r,i,s,n){n||(n={}),e=this._truncateToN(e,!1,n.msgBitLength),i=this.keyFromPublic(i,s),r=new Ba(r,"hex");var o=r.r,c=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var p=c.invm(this.n),b=p.mul(e).umod(this.n),w=p.mul(o).umod(this.n),x;return this.curve._maxwellTrick?(x=this.g.jmulAdd(b,i.getPublic(),w),x.isInfinity()?!1:x.eqXToP(o)):(x=this.g.mulAdd(b,i.getPublic(),w),x.isInfinity()?!1:x.getX().umod(this.n).cmp(o)===0)};Ar.prototype.recoverPubKey=function(t,e,r,i){Gi((3&r)===r,"The recovery param is more than two bits"),e=new Ba(e,i);var s=this.n,n=new zr(t),o=e.r,c=e.s,p=r&1,b=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&b)throw new Error("Unable to find sencond key candinate");b?o=this.curve.pointFromX(o.add(this.curve.n),p):o=this.curve.pointFromX(o,p);var w=e.r.invm(s),x=s.sub(n).mul(w).umod(s),E=c.mul(w).umod(s);return this.g.mulAdd(x,o,E)};Ar.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new Ba(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var s=0;s<4;s++){var n;try{n=this.recoverPubKey(t,e,s)}catch{continue}if(n.eq(r))return s}throw new Error("Unable to find valid recovery factor")};var Ss=yr,hl=Ss.assert,vc=Ss.parseBytes,Kn=Ss.cachedProperty;function Dt(t,e){this.eddsa=t,this._secret=vc(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=vc(e.pub)}Dt.fromPublic=function(e,r){return r instanceof Dt?r:new Dt(e,{pub:r})};Dt.fromSecret=function(e,r){return r instanceof Dt?r:new Dt(e,{secret:r})};Dt.prototype.secret=function(){return this._secret};Kn(Dt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Kn(Dt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Kn(Dt,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,s=r.slice(0,e.encodingLength);return s[0]&=248,s[i]&=127,s[i]|=64,s});Kn(Dt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Kn(Dt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Kn(Dt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Dt.prototype.sign=function(e){return hl(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Dt.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};Dt.prototype.getSecret=function(e){return hl(this._secret,"KeyPair is public only"),Ss.encode(this.secret(),e)};Dt.prototype.getPublic=function(e){return Ss.encode(this.pubBytes(),e)};var F3=Dt,C3=yi,Ua=yr,bc=Ua.assert,za=Ua.cachedProperty,L3=Ua.parseBytes;function un(t,e){this.eddsa=t,typeof e!="object"&&(e=L3(e)),Array.isArray(e)&&(bc(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),bc(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof C3&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}za(un,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});za(un,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});za(un,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});za(un,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});un.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};un.prototype.toHex=function(){return Ua.encode(this.toBytes(),"hex").toUpperCase()};var q3=un,B3=xs,U3=La,Pn=yr,z3=Pn.assert,cl=Pn.parseBytes,ul=F3,mc=q3;function Yt(t){if(z3(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Yt))return new Yt(t);t=U3[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=B3.sha512}var k3=Yt;Yt.prototype.sign=function(e,r){e=cl(e);var i=this.keyFromSecret(r),s=this.hashInt(i.messagePrefix(),e),n=this.g.mul(s),o=this.encodePoint(n),c=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),p=s.add(c).umod(this.curve.n);return this.makeSignature({R:n,S:p,Rencoded:o})};Yt.prototype.verify=function(e,r,i){if(e=cl(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var s=this.keyFromPublic(i),n=this.hashInt(r.Rencoded(),s.pubBytes(),e),o=this.g.mul(r.S()),c=r.R().add(s.pub().mul(n));return c.eq(o)};Yt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Pn.intFromLE(e.digest()).umod(this.curve.n)};Yt.prototype.keyFromPublic=function(e){return ul.fromPublic(this,e)};Yt.prototype.keyFromSecret=function(e){return ul.fromSecret(this,e)};Yt.prototype.makeSignature=function(e){return e instanceof mc?e:new mc(this,e)};Yt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};Yt.prototype.decodePoint=function(e){e=Pn.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&-129),s=(e[r]&128)!==0,n=Pn.intFromLE(i);return this.curve.pointFromY(n,s)};Yt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Yt.prototype.decodeInt=function(e){return Pn.intFromLE(e)};Yt.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(t){var e=t;e.version=l3.version,e.utils=yr,e.rand=nl,e.curve=Cf,e.curves=La,e.ec=T3,e.eddsa=k3})(il);const j3={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var K3={};const V3=":";function ta(t){const[e,r]=t.split(V3);return{namespace:e,reference:r}}function dl(t,e){return t.includes(":")?[t]:e.chains||[]}const H3="ReactNative",br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},W3="js";function pa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Li(){return!_s()&&!!Ef()&&navigator.product===H3}function G3(){return Li()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function J3(){return Li()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Is(){return!pa()&&!!Ef()&&!!_s()}function As(){return Li()?br.reactNative:pa()?br.node:Is()?br.browser:br.unknown}function yc(){var t;try{return Li()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function Z3(t,e){const r=new URLSearchParams(t);for(const i of Object.keys(e).sort())if(e.hasOwnProperty(i)){const s=e[i];s!==void 0&&r.set(i,s)}return r.toString()}function ll(){return Id()||{name:"",description:"",url:"",icons:[""]}}function Y3(){if(As()===br.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=Lb();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function X3(){var t;const e=As();return e===br.browser?[e,((t=Sd())==null?void 0:t.host)||"unknown"].join(":"):e}function pl(t,e,r){const i=Y3(),s=X3();return[[t,e].join("-"),[W3,r].join("-"),i,s].join("/")}function Q3({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:o,bundleId:c,packageName:p}){const b=r.split("?"),w=pl(t,e,i),x={auth:s,ua:w,projectId:n,useOnCloseEvent:o||void 0,packageName:p||void 0,bundleId:c||void 0},E=Z3(b[1]||"",x);return b[0]+"?"+E}function Qi(t,e){return t.filter(r=>e.includes(r)).length===t.length}function gl(t){return Object.fromEntries(t.entries())}function vl(t){return new Map(Object.entries(t))}function Hi(t=W.FIVE_MINUTES,e){const r=W.toMiliseconds(t||W.FIVE_MINUTES);let i,s,n,o;return{resolve:c=>{n&&i&&(clearTimeout(n),i(c),o=Promise.resolve(c))},reject:c=>{n&&s&&(clearTimeout(n),s(c))},done:()=>new Promise((c,p)=>{if(o)return c(o);n=setTimeout(()=>{const b=new Error(e);o=Promise.reject(b),p(b)},r),i=c,s=p})}}function Pi(t,e,r){return new Promise(async(i,s)=>{const n=setTimeout(()=>s(new Error(r)),e);try{const o=await t;i(o)}catch(o){s(o)}clearTimeout(n)})}function bl(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function ew(t){return bl("topic",t)}function tw(t){return bl("id",t)}function ml(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function wt(t,e){return W.fromMiliseconds(Date.now()+W.toMiliseconds(t))}function Di(t){return Date.now()>=W.toMiliseconds(t)}function qe(t,e){return`${t}${e?`:${e}`:""}`}function rw(t=[],e=[]){return[...new Set([...t,...e])]}async function iw({id:t,topic:e,wcDeepLink:r}){var i;try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,n=s==null?void 0:s.href;if(typeof n!="string")return;const o=nw(n,t,e),c=As();if(c===br.browser){if(!((i=_s())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}sw(o)}else c===br.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function nw(t,e,r){const i=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const n=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${n}${hw(i,!0)}`}else s=`${s}/wc?${i}`;return s}function sw(t){let e="_self";fw()?e="_top":(ow()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function aw(t,e){let r="";try{if(Is()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(i){console.error(i)}return r}function wc(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),i=r.indexOf(e);return r[i+2]}function _c(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Uf(){return typeof process<"u"&&K3.IS_VITEST==="true"}function ow(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function fw(){try{return window.self!==window.top}catch{return!1}}function hw(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function yl(t){return Buffer.from(t,"base64").toString("utf-8")}function cw(t){return new Promise(e=>setTimeout(e,t))}function gs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function uw(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ka(t,...e){if(!uw(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function zf(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");gs(t.outputLen),gs(t.blockLen)}function Rn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function wl(t,e){ka(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Ks=BigInt(2**32-1),xc=BigInt(32);function dw(t,e=!1){return e?{h:Number(t&Ks),l:Number(t>>xc&Ks)}:{h:Number(t>>xc&Ks)|0,l:Number(t&Ks)|0}}function lw(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:n,l:o}=dw(t[s],e);[r[s],i[s]]=[n,o]}return[r,i]}const pw=(t,e,r)=>t<<r|e>>>32-r,gw=(t,e,r)=>e<<r|t>>>32-r,vw=(t,e,r)=>e<<r-32|t>>>64-r,bw=(t,e,r)=>t<<r-32|e>>>64-r,mn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function mw(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Io(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Vr(t,e){return t<<32-e|t>>>e}const Mc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function yw(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Ec(t){for(let e=0;e<t.length;e++)t[e]=yw(t[e])}function ww(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Nn(t){return typeof t=="string"&&(t=ww(t)),ka(t),t}let kf=class{clone(){return this._cloneInto()}};function _l(t){const e=i=>t().update(Nn(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Ds(t=32){if(mn&&typeof mn.getRandomValues=="function")return mn.getRandomValues(new Uint8Array(t));if(mn&&typeof mn.randomBytes=="function")return mn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const xl=[],Ml=[],El=[],_w=BigInt(0),es=BigInt(1),xw=BigInt(2),Mw=BigInt(7),Ew=BigInt(256),Sw=BigInt(113);for(let t=0,e=es,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],xl.push(2*(5*i+r)),Ml.push((t+1)*(t+2)/2%64);let s=_w;for(let n=0;n<7;n++)e=(e<<es^(e>>Mw)*Sw)%Ew,e&xw&&(s^=es<<(es<<BigInt(n))-es);El.push(s)}const[Iw,Aw]=lw(El,!0),Sc=(t,e,r)=>r>32?vw(t,e,r):pw(t,e,r),Ic=(t,e,r)=>r>32?bw(t,e,r):gw(t,e,r);function Dw(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,p=(o+2)%10,b=r[p],w=r[p+1],x=Sc(b,w,1)^r[c],E=Ic(b,w,1)^r[c+1];for(let I=0;I<50;I+=10)t[o+I]^=x,t[o+I+1]^=E}let s=t[2],n=t[3];for(let o=0;o<24;o++){const c=Ml[o],p=Sc(s,n,c),b=Ic(s,n,c),w=xl[o];s=t[w],n=t[w+1],t[w]=p,t[w+1]=b}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=Iw[i],t[1]^=Aw[i]}r.fill(0)}let Ow=class Sl extends kf{constructor(e,r,i,s=!1,n=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=s,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,gs(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=mw(this.state)}keccak(){Mc||Ec(this.state32),Dw(this.state32,this.rounds),Mc||Ec(this.state32),this.posOut=0,this.pos=0}update(e){Rn(this);const{blockLen:r,state:i}=this;e=Nn(e);const s=e.length;for(let n=0;n<s;){const o=Math.min(r-this.pos,s-n);for(let c=0;c<o;c++)i[this.pos++]^=e[n++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:s}=this;e[i]^=r,r&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Rn(this,!1),ka(e),this.finish();const r=this.state,{blockLen:i}=this;for(let s=0,n=e.length;s<n;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,n-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return gs(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(wl(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:s,rounds:n,enableXOF:o}=this;return e||(e=new Sl(r,i,s,o,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=i,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Pw=(t,e,r)=>_l(()=>new Ow(e,t,r)),Rw=Pw(1,136,256/8),Nw="https://rpc.walletconnect.org/v1";function Il(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(Rw(r)).toString("hex")}async function $w(t,e,r,i,s,n){switch(r.t){case"eip191":return Tw(t,e,r.s);case"eip1271":return await Fw(t,e,r.s,i,s,n);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function Tw(t,e,r){return r2(Il(e),r).toLowerCase()===t.toLowerCase()}async function Fw(t,e,r,i,s,n){const o=ta(i);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const c="0x1626ba7e",p="0000000000000000000000000000000000000000000000000000000000000040",b="0000000000000000000000000000000000000000000000000000000000000041",w=r.substring(2),x=Il(e).substring(2),E=c+x+p+b+w,I=await fetch(`${n||Nw}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Cw(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:E},"latest"]})}),{result:S}=await I.json();return S?S.slice(0,c.length).toLowerCase()===c.toLowerCase():!1}catch(c){return console.error("isValidEip1271Signature: ",c),!1}}function Cw(){return Date.now()+Math.floor(Math.random()*1e3)}var Lw=Object.defineProperty,qw=Object.defineProperties,Bw=Object.getOwnPropertyDescriptors,Ac=Object.getOwnPropertySymbols,Uw=Object.prototype.hasOwnProperty,zw=Object.prototype.propertyIsEnumerable,Dc=(t,e,r)=>e in t?Lw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,kw=(t,e)=>{for(var r in e||(e={}))Uw.call(e,r)&&Dc(t,r,e[r]);if(Ac)for(var r of Ac(e))zw.call(e,r)&&Dc(t,r,e[r]);return t},jw=(t,e)=>qw(t,Bw(e));const Kw="did:pkh:",jf=t=>t==null?void 0:t.split(":"),Vw=t=>{const e=t&&jf(t);if(e)return t.includes(Kw)?e[3]:e[1]},tf=t=>{const e=t&&jf(t);if(e)return e[2]+":"+e[3]},ga=t=>{const e=t&&jf(t);if(e)return e.pop()};async function Oc(t){const{cacao:e,projectId:r}=t,{s:i,p:s}=e,n=Al(s,s.iss),o=ga(s.iss);return await $w(o,n,i,tf(s.iss),r)}const Al=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,i=ga(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const n=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,c=`Chain ID: ${Vw(e)}`,p=`Nonce: ${t.nonce}`,b=`Issued At: ${t.iat}`,w=t.exp?`Expiration Time: ${t.exp}`:void 0,x=t.nbf?`Not Before: ${t.nbf}`:void 0,E=t.requestId?`Request ID: ${t.requestId}`:void 0,I=t.resources?`Resources:${t.resources.map(D=>`
- ${D}`).join("")}`:void 0,S=ra(t.resources);if(S){const D=vs(S);s=e6(s,D)}return[r,i,"",s,"",n,o,c,p,b,w,x,E,I].filter(D=>D!=null).join(`
`)};function Hw(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function Ww(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function nn(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const i=t.att[r];if(Array.isArray(i))throw new Error(`Resource must be an object: ${r}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(i).forEach(s=>{const n=i[s];if(!Array.isArray(n))throw new Error(`Ability limits ${s} must be an array of objects, found: ${n}`);if(!n.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);n.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function Gw(t,e,r,i={}){return r==null||r.sort((s,n)=>s.localeCompare(n)),{att:{[t]:Jw(e,r,i)}}}function Jw(t,e,r={}){e=e==null?void 0:e.sort((s,n)=>s.localeCompare(n));const i=e.map(s=>({[`${t}/${s}`]:[r]}));return Object.assign({},...i)}function Dl(t){return nn(t),`urn:recap:${Hw(t).replace(/=/g,"")}`}function vs(t){const e=Ww(t.replace("urn:recap:",""));return nn(e),e}function Zw(t,e,r){const i=Gw(t,e,r);return Dl(i)}function Yw(t){return t&&t.includes("urn:recap:")}function Xw(t,e){const r=vs(t),i=vs(e),s=Qw(r,i);return Dl(s)}function Qw(t,e){nn(t),nn(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,n)=>s.localeCompare(n)),i={att:{}};return r.forEach(s=>{var n,o;Object.keys(((n=t.att)==null?void 0:n[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((c,p)=>c.localeCompare(p)).forEach(c=>{var p,b;i.att[s]=jw(kw({},i.att[s]),{[c]:((p=t.att[s])==null?void 0:p[c])||((b=e.att[s])==null?void 0:b[c])})})}),i}function e6(t="",e){nn(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const i=[];let s=0;Object.keys(e.att).forEach(c=>{const p=Object.keys(e.att[c]).map(x=>({ability:x.split("/")[0],action:x.split("/")[1]}));p.sort((x,E)=>x.action.localeCompare(E.action));const b={};p.forEach(x=>{b[x.ability]||(b[x.ability]=[]),b[x.ability].push(x.action)});const w=Object.keys(b).map(x=>(s++,`(${s}) '${x}': '${b[x].join("', '")}' for '${c}'.`));i.push(w.join(", ").replace(".,","."))});const n=i.join(" "),o=`${r}${n}`;return`${t?t+" ":""}${o}`}function Pc(t){var e;const r=vs(t);nn(r);const i=(e=r.att)==null?void 0:e.eip155;return i?Object.keys(i).map(s=>s.split("/")[1]):[]}function Rc(t){const e=vs(t);nn(e);const r=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(s=>{var n;(n=s==null?void 0:s[0])!=null&&n.chains&&r.push(s[0].chains)})}),[...new Set(r.flat())]}function ra(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return Yw(e)?e:void 0}function Ao(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Ol(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function vr(t,...e){if(!Ol(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Nc(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function t6(t,e){vr(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function $c(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Ni=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),r6=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),i6=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!i6)throw new Error("Non little-endian hardware is not supported");function n6(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function rf(t){if(typeof t=="string")t=n6(t);else if(Ol(t))t=nf(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function s6(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function a6(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const o6=(t,e)=>{function r(i,...s){if(vr(i),t.nonceLength!==void 0){const b=s[0];if(!b)throw new Error("nonce / iv required");t.varSizeNonce?vr(b):vr(b,t.nonceLength)}const n=t.tagLength;n&&s[1]!==void 0&&vr(s[1]);const o=e(i,...s),c=(b,w)=>{if(w!==void 0){if(b!==2)throw new Error("cipher output not supported");vr(w)}};let p=!1;return{encrypt(b,w){if(p)throw new Error("cannot encrypt() twice with same key + nonce");return p=!0,vr(b),c(o.encrypt.length,w),o.encrypt(b,w)},decrypt(b,w){if(vr(b),n&&b.length<n)throw new Error("invalid ciphertext length: smaller than tagLength="+n);return c(o.decrypt.length,w),o.decrypt(b,w)}}}return Object.assign(r,t),r};function Tc(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!f6(e))throw new Error("invalid output, must be aligned");return e}function Fc(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),c=Number(r&n);t.setUint32(e+4,o,i),t.setUint32(e+0,c,i)}function f6(t){return t.byteOffset%4===0}function nf(t){return Uint8Array.from(t)}function $n(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Pl=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),h6=Pl("expand 16-byte k"),c6=Pl("expand 32-byte k"),u6=Ni(h6),d6=Ni(c6);function ke(t,e){return t<<e|t>>>32-e}function sf(t){return t.byteOffset%4===0}const Vs=64,l6=16,Rl=2**32-1,Cc=new Uint32Array;function p6(t,e,r,i,s,n,o,c){const p=s.length,b=new Uint8Array(Vs),w=Ni(b),x=sf(s)&&sf(n),E=x?Ni(s):Cc,I=x?Ni(n):Cc;for(let S=0;S<p;o++){if(t(e,r,i,w,o,c),o>=Rl)throw new Error("arx: counter overflow");const D=Math.min(Vs,p-S);if(x&&D===Vs){const P=S/4;if(S%4!==0)throw new Error("arx: invalid block position");for(let R=0,N;R<l6;R++)N=P+R,I[N]=E[N]^w[R];S+=Vs;continue}for(let P=0,R;P<D;P++)R=S+P,n[R]=s[R]^b[P];S+=D}}function g6(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:o}=s6({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Ao(s),Ao(o),$c(n),$c(r),(c,p,b,w,x=0)=>{vr(c),vr(p),vr(b);const E=b.length;if(w===void 0&&(w=new Uint8Array(E)),vr(w),Ao(x),x<0||x>=Rl)throw new Error("arx: counter overflow");if(w.length<E)throw new Error(`arx: output (${w.length}) is shorter than data (${E})`);const I=[];let S=c.length,D,P;if(S===32)I.push(D=nf(c)),P=d6;else if(S===16&&r)D=new Uint8Array(32),D.set(c),D.set(c,16),P=u6,I.push(D);else throw new Error(`arx: invalid 32-byte key, got length=${S}`);sf(p)||I.push(p=nf(p));const R=Ni(D);if(i){if(p.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(P,R,Ni(p.subarray(0,16)),R),p=p.subarray(16)}const N=16-s;if(N!==p.length)throw new Error(`arx: nonce must be ${N} or 16 bytes`);if(N!==12){const L=new Uint8Array(12);L.set(p,n?0:12-p.length),p=L,I.push(p)}const C=Ni(p);return p6(t,P,R,C,b,w,x,o),$n(...I),w}}const $t=(t,e)=>t[e++]&255|(t[e++]&255)<<8;let v6=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=rf(e),vr(e,32);const r=$t(e,0),i=$t(e,2),s=$t(e,4),n=$t(e,6),o=$t(e,8),c=$t(e,10),p=$t(e,12),b=$t(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|s<<6)&7939,this.r[3]=(s>>>7|n<<9)&8191,this.r[4]=(n>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|c<<2)&8191,this.r[7]=(c>>>11|p<<5)&8065,this.r[8]=(p>>>8|b<<8)&8191,this.r[9]=b>>>5&127;for(let w=0;w<8;w++)this.pad[w]=$t(e,16+2*w)}process(e,r,i=!1){const s=i?0:2048,{h:n,r:o}=this,c=o[0],p=o[1],b=o[2],w=o[3],x=o[4],E=o[5],I=o[6],S=o[7],D=o[8],P=o[9],R=$t(e,r+0),N=$t(e,r+2),C=$t(e,r+4),L=$t(e,r+6),B=$t(e,r+8),U=$t(e,r+10),K=$t(e,r+12),k=$t(e,r+14);let z=n[0]+(R&8191),pe=n[1]+((R>>>13|N<<3)&8191),A=n[2]+((N>>>10|C<<6)&8191),_=n[3]+((C>>>7|L<<9)&8191),d=n[4]+((L>>>4|B<<12)&8191),a=n[5]+(B>>>1&8191),f=n[6]+((B>>>14|U<<2)&8191),u=n[7]+((U>>>11|K<<5)&8191),v=n[8]+((K>>>8|k<<8)&8191),y=n[9]+(k>>>5|s),m=0,l=m+z*c+pe*(5*P)+A*(5*D)+_*(5*S)+d*(5*I);m=l>>>13,l&=8191,l+=a*(5*E)+f*(5*x)+u*(5*w)+v*(5*b)+y*(5*p),m+=l>>>13,l&=8191;let g=m+z*p+pe*c+A*(5*P)+_*(5*D)+d*(5*S);m=g>>>13,g&=8191,g+=a*(5*I)+f*(5*E)+u*(5*x)+v*(5*w)+y*(5*b),m+=g>>>13,g&=8191;let h=m+z*b+pe*p+A*c+_*(5*P)+d*(5*D);m=h>>>13,h&=8191,h+=a*(5*S)+f*(5*I)+u*(5*E)+v*(5*x)+y*(5*w),m+=h>>>13,h&=8191;let M=m+z*w+pe*b+A*p+_*c+d*(5*P);m=M>>>13,M&=8191,M+=a*(5*D)+f*(5*S)+u*(5*I)+v*(5*E)+y*(5*x),m+=M>>>13,M&=8191;let T=m+z*x+pe*w+A*b+_*p+d*c;m=T>>>13,T&=8191,T+=a*(5*P)+f*(5*D)+u*(5*S)+v*(5*I)+y*(5*E),m+=T>>>13,T&=8191;let $=m+z*E+pe*x+A*w+_*b+d*p;m=$>>>13,$&=8191,$+=a*c+f*(5*P)+u*(5*D)+v*(5*S)+y*(5*I),m+=$>>>13,$&=8191;let q=m+z*I+pe*E+A*x+_*w+d*b;m=q>>>13,q&=8191,q+=a*p+f*c+u*(5*P)+v*(5*D)+y*(5*S),m+=q>>>13,q&=8191;let G=m+z*S+pe*I+A*E+_*x+d*w;m=G>>>13,G&=8191,G+=a*b+f*p+u*c+v*(5*P)+y*(5*D),m+=G>>>13,G&=8191;let H=m+z*D+pe*S+A*I+_*E+d*x;m=H>>>13,H&=8191,H+=a*w+f*b+u*p+v*c+y*(5*P),m+=H>>>13,H&=8191;let V=m+z*P+pe*D+A*S+_*I+d*E;m=V>>>13,V&=8191,V+=a*x+f*w+u*b+v*p+y*c,m+=V>>>13,V&=8191,m=(m<<2)+m|0,m=m+l|0,l=m&8191,m=m>>>13,g+=m,n[0]=l,n[1]=g,n[2]=h,n[3]=M,n[4]=T,n[5]=$,n[6]=q,n[7]=G,n[8]=H,n[9]=V}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let c=2;c<10;c++)e[c]+=s,s=e[c]>>>13,e[c]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,i[0]=e[0]+5,s=i[0]>>>13,i[0]&=8191;for(let c=1;c<10;c++)i[c]=e[c]+s,s=i[c]>>>13,i[c]&=8191;i[9]-=8192;let n=(s^1)-1;for(let c=0;c<10;c++)i[c]&=n;n=~n;for(let c=0;c<10;c++)e[c]=e[c]&n|i[c];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let c=1;c<8;c++)o=(e[c]+r[c]|0)+(o>>>16)|0,e[c]=o&65535;$n(i)}update(e){Nc(this);const{buffer:r,blockLen:i}=this;e=rf(e);const s=e.length;for(let n=0;n<s;){const o=Math.min(i-this.pos,s-n);if(o===i){for(;i<=s-n;n+=i)this.process(e,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){$n(this.h,this.r,this.buffer,this.pad)}digestInto(e){Nc(this),t6(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let n=0;for(let o=0;o<8;o++)e[n++]=i[o]>>>0,e[n++]=i[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}};function b6(t){const e=(i,s)=>t(s).update(rf(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const m6=b6(t=>new v6(t));function y6(t,e,r,i,s,n=20){let o=t[0],c=t[1],p=t[2],b=t[3],w=e[0],x=e[1],E=e[2],I=e[3],S=e[4],D=e[5],P=e[6],R=e[7],N=s,C=r[0],L=r[1],B=r[2],U=o,K=c,k=p,z=b,pe=w,A=x,_=E,d=I,a=S,f=D,u=P,v=R,y=N,m=C,l=L,g=B;for(let M=0;M<n;M+=2)U=U+pe|0,y=ke(y^U,16),a=a+y|0,pe=ke(pe^a,12),U=U+pe|0,y=ke(y^U,8),a=a+y|0,pe=ke(pe^a,7),K=K+A|0,m=ke(m^K,16),f=f+m|0,A=ke(A^f,12),K=K+A|0,m=ke(m^K,8),f=f+m|0,A=ke(A^f,7),k=k+_|0,l=ke(l^k,16),u=u+l|0,_=ke(_^u,12),k=k+_|0,l=ke(l^k,8),u=u+l|0,_=ke(_^u,7),z=z+d|0,g=ke(g^z,16),v=v+g|0,d=ke(d^v,12),z=z+d|0,g=ke(g^z,8),v=v+g|0,d=ke(d^v,7),U=U+A|0,g=ke(g^U,16),u=u+g|0,A=ke(A^u,12),U=U+A|0,g=ke(g^U,8),u=u+g|0,A=ke(A^u,7),K=K+_|0,y=ke(y^K,16),v=v+y|0,_=ke(_^v,12),K=K+_|0,y=ke(y^K,8),v=v+y|0,_=ke(_^v,7),k=k+d|0,m=ke(m^k,16),a=a+m|0,d=ke(d^a,12),k=k+d|0,m=ke(m^k,8),a=a+m|0,d=ke(d^a,7),z=z+pe|0,l=ke(l^z,16),f=f+l|0,pe=ke(pe^f,12),z=z+pe|0,l=ke(l^z,8),f=f+l|0,pe=ke(pe^f,7);let h=0;i[h++]=o+U|0,i[h++]=c+K|0,i[h++]=p+k|0,i[h++]=b+z|0,i[h++]=w+pe|0,i[h++]=x+A|0,i[h++]=E+_|0,i[h++]=I+d|0,i[h++]=S+a|0,i[h++]=D+f|0,i[h++]=P+u|0,i[h++]=R+v|0,i[h++]=N+y|0,i[h++]=C+m|0,i[h++]=L+l|0,i[h++]=B+g|0}const w6=g6(y6,{counterRight:!1,counterLength:4,allowShortKeys:!1}),_6=new Uint8Array(16),Lc=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(_6.subarray(r))},x6=new Uint8Array(32);function qc(t,e,r,i,s){const n=t(e,r,x6),o=m6.create(n);s&&Lc(o,s),Lc(o,i);const c=new Uint8Array(16),p=r6(c);Fc(p,0,BigInt(s?s.length:0),!0),Fc(p,8,BigInt(i.length),!0),o.update(c);const b=o.digest();return $n(n,c),b}const M6=t=>(e,r,i)=>({encrypt(s,n){const o=s.length;n=Tc(o+16,n,!1),n.set(s);const c=n.subarray(0,-16);t(e,r,c,c,1);const p=qc(t,e,r,c,i);return n.set(p,o),$n(p),n},decrypt(s,n){n=Tc(s.length-16,n,!1);const o=s.subarray(0,-16),c=s.subarray(-16),p=qc(t,e,r,o,i);if(!a6(c,p))throw new Error("invalid tag");return n.set(s.subarray(0,-16)),t(e,r,n,n,1),$n(p),n}}),Nl=o6({blockSize:64,nonceLength:12,tagLength:16},M6(w6));class $l extends kf{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,zf(e);const i=Nn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,n=new Uint8Array(s);n.set(i.length>s?e.create().update(i).digest():i);for(let o=0;o<n.length;o++)n[o]^=54;this.iHash.update(n),this.oHash=e.create();for(let o=0;o<n.length;o++)n[o]^=106;this.oHash.update(n),n.fill(0)}update(e){return Rn(this),this.iHash.update(e),this}digestInto(e){Rn(this),ka(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:s,destroyed:n,blockLen:o,outputLen:c}=this;return e=e,e.finished=s,e.destroyed=n,e.blockLen=o,e.outputLen=c,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Kf=(t,e,r)=>new $l(t,e).update(r).digest();Kf.create=(t,e)=>new $l(t,e);function E6(t,e,r){return zf(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Kf(t,Nn(r),Nn(e))}const Do=new Uint8Array([0]),Bc=new Uint8Array;function S6(t,e,r,i=32){if(zf(t),gs(i),i>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(i/t.outputLen);r===void 0&&(r=Bc);const n=new Uint8Array(s*t.outputLen),o=Kf.create(t,e),c=o._cloneInto(),p=new Uint8Array(o.outputLen);for(let b=0;b<s;b++)Do[0]=b+1,c.update(b===0?Bc:p).update(r).update(Do).digestInto(p),n.set(p,t.outputLen*b),o._cloneInto(c);return o.destroy(),c.destroy(),p.fill(0),Do.fill(0),n.slice(0,i)}const I6=(t,e,r,i,s)=>S6(t,E6(t,e,r),i,s);function A6(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),c=Number(r&n),p=i?4:0,b=i?0:4;t.setUint32(e+p,o,i),t.setUint32(e+b,c,i)}function D6(t,e,r){return t&e^~t&r}function O6(t,e,r){return t&e^t&r^e&r}let P6=class extends kf{constructor(e,r,i,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Io(this.buffer)}update(e){Rn(this);const{view:r,buffer:i,blockLen:s}=this;e=Nn(e);const n=e.length;for(let o=0;o<n;){const c=Math.min(s-this.pos,n-o);if(c===s){const p=Io(e);for(;s<=n-o;o+=s)this.process(p,o);continue}i.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Rn(this),wl(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:s,isLE:n}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(i,0),o=0);for(let x=o;x<s;x++)r[x]=0;A6(i,s-8,BigInt(this.length*8),n),this.process(i,0);const c=Io(e),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const b=p/4,w=this.get();if(b>w.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<b;x++)c.setUint32(4*x,w[x],n)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:s,finished:n,destroyed:o,pos:c}=this;return e.length=s,e.pos=c,e.finished=n,e.destroyed=o,s%r&&e.buffer.set(i),e}};const R6=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Si=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ii=new Uint32Array(64);let N6=class extends P6{constructor(){super(64,32,8,!1),this.A=Si[0]|0,this.B=Si[1]|0,this.C=Si[2]|0,this.D=Si[3]|0,this.E=Si[4]|0,this.F=Si[5]|0,this.G=Si[6]|0,this.H=Si[7]|0}get(){const{A:e,B:r,C:i,D:s,E:n,F:o,G:c,H:p}=this;return[e,r,i,s,n,o,c,p]}set(e,r,i,s,n,o,c,p){this.A=e|0,this.B=r|0,this.C=i|0,this.D=s|0,this.E=n|0,this.F=o|0,this.G=c|0,this.H=p|0}process(e,r){for(let x=0;x<16;x++,r+=4)Ii[x]=e.getUint32(r,!1);for(let x=16;x<64;x++){const E=Ii[x-15],I=Ii[x-2],S=Vr(E,7)^Vr(E,18)^E>>>3,D=Vr(I,17)^Vr(I,19)^I>>>10;Ii[x]=D+Ii[x-7]+S+Ii[x-16]|0}let{A:i,B:s,C:n,D:o,E:c,F:p,G:b,H:w}=this;for(let x=0;x<64;x++){const E=Vr(c,6)^Vr(c,11)^Vr(c,25),I=w+E+D6(c,p,b)+R6[x]+Ii[x]|0,S=(Vr(i,2)^Vr(i,13)^Vr(i,22))+O6(i,s,n)|0;w=b,b=p,p=c,c=o+I|0,o=n,n=s,s=i,i=I+S|0}i=i+this.A|0,s=s+this.B|0,n=n+this.C|0,o=o+this.D|0,c=c+this.E|0,p=p+this.F|0,b=b+this.G|0,w=w+this.H|0,this.set(i,s,n,o,c,p,b,w)}roundClean(){Ii.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const ja=_l(()=>new N6);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Tl=BigInt(0);function Vf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fl(t){if(!Vf(t))throw new Error("Uint8Array expected")}const $6=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function T6(t){Fl(t);let e="";for(let r=0;r<t.length;r++)e+=$6[t[r]];return e}function F6(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Tl:BigInt("0x"+t)}const ui={_0:48,_9:57,A:65,F:70,a:97,f:102};function Uc(t){if(t>=ui._0&&t<=ui._9)return t-ui._0;if(t>=ui.A&&t<=ui.F)return t-(ui.A-10);if(t>=ui.a&&t<=ui.f)return t-(ui.a-10)}function Cl(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let s=0,n=0;s<r;s++,n+=2){const o=Uc(t.charCodeAt(n)),c=Uc(t.charCodeAt(n+1));if(o===void 0||c===void 0){const p=t[n]+t[n+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+n)}i[s]=o*16+c}return i}function zc(t){return Fl(t),F6(T6(Uint8Array.from(t).reverse()))}function C6(t,e){return Cl(t.toString(16).padStart(e*2,"0"))}function L6(t,e){return C6(t,e).reverse()}function kc(t,e,r){let i;if(typeof e=="string")try{i=Cl(e)}catch(n){throw new Error(t+" must be hex string or Uint8Array, cause: "+n)}else if(Vf(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=i.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return i}const Oo=t=>typeof t=="bigint"&&Tl<=t;function q6(t,e,r){return Oo(t)&&Oo(e)&&Oo(r)&&e<=t&&t<r}function jc(t,e,r,i){if(!q6(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}const B6={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Vf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function U6(t,e,r={}){const i=(s,n,o)=>{const c=B6[n];if(typeof c!="function")throw new Error("invalid validator function");const p=t[s];if(!(o&&p===void 0)&&!c(p,t))throw new Error("param "+String(s)+" is invalid. Expected "+n+", got "+p)};for(const[s,n]of Object.entries(e))i(s,n,!1);for(const[s,n]of Object.entries(r))i(s,n,!0);return t}const Mn=BigInt(0),Hs=BigInt(1);function Ll(t,e){const r=t%e;return r>=Mn?r:e+r}function z6(t,e,r){if(e<Mn)throw new Error("invalid exponent, negatives unsupported");if(r<=Mn)throw new Error("invalid modulus");if(r===Hs)return Mn;let i=Hs;for(;e>Mn;)e&Hs&&(i=i*t%r),t=t*t%r,e>>=Hs;return i}function qr(t,e,r){let i=t;for(;e-- >Mn;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const yn=BigInt(0),Po=BigInt(1);function k6(t){return U6(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function j6(t){const e=k6(t),{P:r}=e,i=N=>Ll(N,r),s=e.montgomeryBits,n=Math.ceil(s/8),o=e.nByteLength,c=e.adjustScalarBytes||(N=>N),p=e.powPminus2||(N=>z6(N,r-BigInt(2),r));function b(N,C,L){const B=i(N*(C-L));return C=i(C-B),L=i(L+B),[C,L]}const w=(e.a-BigInt(2))/BigInt(4);function x(N,C){jc("u",N,yn,r),jc("scalar",C,yn,r);const L=C,B=N;let U=Po,K=yn,k=N,z=Po,pe=yn,A;for(let d=BigInt(s-1);d>=yn;d--){const a=L>>d&Po;pe^=a,A=b(pe,U,k),U=A[0],k=A[1],A=b(pe,K,z),K=A[0],z=A[1],pe=a;const f=U+K,u=i(f*f),v=U-K,y=i(v*v),m=u-y,l=k+z,g=k-z,h=i(g*f),M=i(l*v),T=h+M,$=h-M;k=i(T*T),z=i(B*i($*$)),U=i(u*y),K=i(m*(u+i(w*m)))}A=b(pe,U,k),U=A[0],k=A[1],A=b(pe,K,z),K=A[0],z=A[1];const _=p(K);return i(U*_)}function E(N){return L6(i(N),n)}function I(N){const C=kc("u coordinate",N,n);return o===32&&(C[31]&=127),zc(C)}function S(N){const C=kc("scalar",N),L=C.length;if(L!==n&&L!==o){let B=""+n+" or "+o;throw new Error("invalid scalar, expected "+B+" bytes, got "+L)}return zc(c(C))}function D(N,C){const L=I(C),B=S(N),U=x(L,B);if(U===yn)throw new Error("invalid private or public key received");return E(U)}const P=E(e.Gu);function R(N){return D(N,P)}return{scalarMult:D,scalarMultBase:R,getSharedSecret:(N,C)=>D(N,C),getPublicKey:N=>R(N),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:P}}const af=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const K6=BigInt(1),Kc=BigInt(2),V6=BigInt(3),H6=BigInt(5);BigInt(8);function W6(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=af,o=t*t%n*t%n,c=qr(o,Kc,n)*o%n,p=qr(c,K6,n)*t%n,b=qr(p,H6,n)*p%n,w=qr(b,e,n)*b%n,x=qr(w,r,n)*w%n,E=qr(x,i,n)*x%n,I=qr(E,s,n)*E%n,S=qr(I,s,n)*E%n,D=qr(S,e,n)*b%n;return{pow_p_5_8:qr(D,Kc,n)*t%n,b2:o}}function G6(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const of=j6({P:af,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=af,{pow_p_5_8:r,b2:i}=W6(t);return Ll(qr(r,V6,e)*i,e)},adjustScalarBytes:G6,randomBytes:Ds}),ql="base10",jt="base16",Ri="base64pad",ts="base64url",Os="utf8",Bl=0,vi=1,Ps=2,J6=0,Vc=1,cs=12,Hf=32;function Z6(){const t=of.utils.randomPrivateKey(),e=of.getPublicKey(t);return{privateKey:Vt(t,jt),publicKey:Vt(e,jt)}}function ff(){const t=Ds(Hf);return Vt(t,jt)}function Y6(t,e){const r=of.getSharedSecret(Sr(t,jt),Sr(e,jt)),i=I6(ja,r,void 0,void 0,Hf);return Vt(i,jt)}function ia(t){const e=ja(Sr(t,jt));return Vt(e,jt)}function pi(t){const e=ja(Sr(t,Os));return Vt(e,jt)}function Ul(t){return Sr(`${t}`,ql)}function sn(t){return Number(Vt(t,ql))}function X6(t){const e=Ul(typeof t.type<"u"?t.type:Bl);if(sn(e)===vi&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Sr(t.senderPublicKey,jt):void 0,i=typeof t.iv<"u"?Sr(t.iv,jt):Ds(cs),s=Sr(t.symKey,jt),n=Nl(s,i).encrypt(Sr(t.message,Os));return zl({type:e,sealed:n,iv:i,senderPublicKey:r,encoding:t.encoding})}function Q6(t){const e=Sr(t.symKey,jt),{sealed:r,iv:i}=bs(t),s=Nl(e,i).decrypt(r);if(s===null)throw new Error("Failed to decrypt");return Vt(s,Os)}function e4(t,e){const r=Ul(Ps),i=Ds(cs),s=Sr(t,Os);return zl({type:r,sealed:s,iv:i,encoding:e})}function t4(t,e){const{sealed:r}=bs({encoded:t,encoding:e});return Vt(r,Os)}function zl(t){const{encoding:e=Ri}=t;if(sn(t.type)===Ps)return Vt(yo([t.type,t.sealed]),e);if(sn(t.type)===vi){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Vt(yo([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return Vt(yo([t.type,t.iv,t.sealed]),e)}function bs(t){const{encoded:e,encoding:r=Ri}=t,i=Sr(e,r),s=i.slice(J6,Vc),n=Vc;if(sn(s)===vi){const b=n+Hf,w=b+cs,x=i.slice(n,b),E=i.slice(b,w),I=i.slice(w);return{type:s,sealed:I,iv:E,senderPublicKey:x}}if(sn(s)===Ps){const b=i.slice(n),w=Ds(cs);return{type:s,sealed:b,iv:w}}const o=n+cs,c=i.slice(n,o),p=i.slice(o);return{type:s,sealed:p,iv:c}}function r4(t,e){const r=bs({encoded:t,encoding:e==null?void 0:e.encoding});return kl({type:sn(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Vt(r.senderPublicKey,jt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function kl(t){const e=(t==null?void 0:t.type)||Bl;if(e===vi){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function Hc(t){return t.type===vi&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Wc(t){return t.type===Ps}function i4(t){return new il.ec("p256").keyFromPublic({x:Buffer.from(t.x,"base64").toString("hex"),y:Buffer.from(t.y,"base64").toString("hex")},"hex")}function n4(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function s4(t){return Buffer.from(n4(t),"base64")}function a4(t,e){const[r,i,s]=t.split("."),n=s4(s);if(n.length!==64)throw new Error("Invalid signature length");const o=n.slice(0,32).toString("hex"),c=n.slice(32,64).toString("hex"),p=`${r}.${i}`,b=ja(p),w=i4(e),x=Vt(b,jt);if(!w.verify(x,{r:o,s:c}))throw new Error("Invalid signature");return Wo(t).payload}const o4="irn";function va(t){return(t==null?void 0:t.relay)||{protocol:o4}}function fs(t){const e=j3[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function f4(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(i)){const n=s.replace(i,""),o=t[s];r[n]=o}}),r}function Gc(t){if(!t.includes("wc:")){const b=yl(t);b!=null&&b.includes("wc:")&&(t=b)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),s=t.substring(e+1,r).split("@"),n=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(n),c={};o.forEach((b,w)=>{c[w]=b});const p=typeof c.methods=="string"?c.methods.split(","):void 0;return{protocol:i,topic:h4(s[0]),version:parseInt(s[1],10),symKey:c.symKey,relay:f4(c),methods:p,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function h4(t){return t.startsWith("//")?t.substring(2):t}function c4(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(s=>{const n=r+e+s;t[s]&&(i[n]=t[s])}),i}function Jc(t){const e=new URLSearchParams,r=c4(t.relay);Object.keys(r).sort().forEach(s=>{e.set(s,r[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const i=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${i}`}function Ws(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function Vn(t){const e=[];return t.forEach(r=>{const[i,s]=r.split(":");e.push(`${i}:${s}`)}),e}function u4(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Vn(r.accounts))}),e}function d4(t,e){const r=[];return Object.values(t).forEach(i=>{Vn(i.accounts).includes(e)&&r.push(...i.methods)}),r}function l4(t,e){const r=[];return Object.values(t).forEach(i=>{Vn(i.accounts).includes(e)&&r.push(...i.events)}),r}function p4(t){const e={};return t==null||t.forEach(r=>{const[i,s]=r.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(r),e[i].chains.push(`${i}:${s}`)}),e}function Zc(t,e){e=e.map(i=>i.replace("did:pkh:",""));const r=p4(e);for(const[i,s]of Object.entries(r))s.methods?s.methods=rw(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return r}const g4={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},v4={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(t,e){const{message:r,code:i}=v4[t];return{message:e?`${r} ${e}`:r,code:i}}function at(t,e){const{message:r,code:i}=g4[t];return{message:e?`${r} ${e}`:r,code:i}}function Ka(t,e){return!!Array.isArray(t)}function ba(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Kt(t){return typeof t>"u"}function vt(t,e){return e&&Kt(t)?!0:typeof t=="string"&&!!t.trim().length}function Wf(t,e){return e&&Kt(t)?!0:typeof t=="number"&&!isNaN(t)}function b4(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),s=Object.keys(r);let n=!0;return Qi(s,i)?(i.forEach(o=>{const{accounts:c,methods:p,events:b}=t.namespaces[o],w=Vn(c),x=r[o];(!Qi(dl(o,x),w)||!Qi(x.methods,p)||!Qi(x.events,b))&&(n=!1)}),n):!1}function ma(t){return vt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function m4(t){if(vt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&ma(r)}}return!1}function y4(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(vt(t,!1)){if(e(t))return!0;const r=yl(t);return e(r)}}catch{}return!1}function w4(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function _4(t){return t==null?void 0:t.topic}function x4(t,e){let r=null;return vt(t==null?void 0:t.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Yc(t){let e=!0;return Ka(t)?t.length&&(e=t.every(r=>vt(r,!1))):e=!1,e}function M4(t,e,r){let i=null;return Ka(e)&&e.length?e.forEach(s=>{i||ma(s)||(i=at("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):ma(t)||(i=at("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function E4(t,e,r){let i=null;return Object.entries(t).forEach(([s,n])=>{if(i)return;const o=M4(s,dl(s,n),`${e} ${r}`);o&&(i=o)}),i}function S4(t,e){let r=null;return Ka(t)?t.forEach(i=>{r||m4(i)||(r=at("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=at("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function I4(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const s=S4(i==null?void 0:i.accounts,`${e} namespace`);s&&(r=s)}),r}function A4(t,e){let r=null;return Yc(t==null?void 0:t.methods)?Yc(t==null?void 0:t.events)||(r=at("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=at("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function jl(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const s=A4(i,`${e}, namespace`);s&&(r=s)}),r}function D4(t,e,r){let i=null;if(t&&ba(t)){const s=jl(t,e);s&&(i=s);const n=E4(t,e,r);n&&(i=n)}else i=J("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Ro(t,e){let r=null;if(t&&ba(t)){const i=jl(t,e);i&&(r=i);const s=I4(t,e);s&&(r=s)}else r=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Kl(t){return vt(t.protocol,!0)}function O4(t,e){let r=!1;return t?t&&Ka(t)&&t.length&&t.forEach(i=>{r=Kl(i)}):r=!0,r}function P4(t){return typeof t=="number"}function Jt(t){return typeof t<"u"&&typeof t!==null}function R4(t){return!(!t||typeof t!="object"||!t.code||!Wf(t.code,!1)||!t.message||!vt(t.message,!1))}function N4(t){return!(Kt(t)||!vt(t.method,!1))}function $4(t){return!(Kt(t)||Kt(t.result)&&Kt(t.error)||!Wf(t.id,!1)||!vt(t.jsonrpc,!1))}function T4(t){return!(Kt(t)||!vt(t.name,!1))}function Xc(t,e){return!(!ma(e)||!u4(t).includes(e))}function F4(t,e,r){return vt(r,!1)?d4(t,e).includes(r):!1}function C4(t,e,r){return vt(r,!1)?l4(t,e).includes(r):!1}function Qc(t,e,r){let i=null;const s=L4(t),n=q4(e),o=Object.keys(s),c=Object.keys(n),p=eu(Object.keys(t)),b=eu(Object.keys(e)),w=p.filter(x=>!b.includes(x));return w.length&&(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(e).toString()}`)),Qi(o,c)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(x=>{if(!x.includes(":")||i)return;const E=Vn(e[x].accounts);E.includes(x)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${x}
        Required: ${x}
        Approved: ${E.toString()}`))}),o.forEach(x=>{i||(Qi(s[x].methods,n[x].methods)?Qi(s[x].events,n[x].events)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${x}`)):i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${x}`))}),i}function L4(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(s=>{e[s]={methods:t[r].methods,events:t[r].events}})}),e}function eu(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function q4(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=Vn(t[r].accounts);i==null||i.forEach(s=>{e[s]={accounts:t[r].accounts.filter(n=>n.includes(`${s}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function B4(t,e){return Wf(t,!1)&&t<=e.max&&t>=e.min}function tu(){const t=As();return new Promise(e=>{switch(t){case br.browser:e(U4());break;case br.reactNative:e(z4());break;case br.node:e(k4());break;default:e(!0)}})}function U4(){return Is()&&(navigator==null?void 0:navigator.onLine)}async function z4(){if(Li()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function k4(){return!0}function j4(t){switch(As()){case br.browser:K4(t);break;case br.reactNative:V4(t);break}}function K4(t){!Li()&&Is()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function V4(t){Li()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}const No={};class rs{static get(e){return No[e]}static set(e,r){No[e]=r}static delete(e){delete No[e]}}class H4{}class W4 extends H4{constructor(){super()}}class G4 extends W4{constructor(e){super()}}const J4="^wss?:";function Z4(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Y4(t,e){const r=Z4(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ru(t){return Y4(t,J4)}function X4(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Vl(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Gf(t){return Vl(t)&&"method"in t}function Va(t){return Vl(t)&&(Gr(t)||Er(t))}function Gr(t){return"result"in t}function Er(t){return"error"in t}class Q4 extends G4{constructor(e){super(e),this.events=new jr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Yi(e.method,e.params||[],e.id||Xi().toString()),r)}async requestStrict(e,r){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(n){s(n)}this.events.on(`${e.id}`,n=>{Er(n)?s(n.error):i(n.result)});try{await this.connection.send(e,r)}catch(n){s(n)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Va(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const e8=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),t8=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",iu=t=>t.split("?")[0],nu=10,r8=e8();class i8{constructor(e){if(this.url=e,this.events=new jr.EventEmitter,this.registering=!1,!ru(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(tn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!ru(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,s)=>{this.events.once("register_error",n=>{this.resetMaxListeners(),s(n)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const s=T0.isReactNative()?void 0:{rejectUnauthorized:!X4(e)},n=new r8(e,[],s);t8()?n.onerror=o=>{const c=o;i(this.emitError(c.error))}:n.on("error",o=>{i(this.emitError(o))}),n.onopen=()=>{this.onOpen(n),r(n)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?In(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),s=i.message||i.toString(),n=df(e,s);this.events.emit("payload",n)}parseError(e,r=this.url){return F0(e,iu(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>nu&&this.events.setMaxListeners(nu)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${iu(this.url)}`));return this.events.emit("register_error",r),r}}var ya={exports:{}};ya.exports;(function(t,e){var r=200,i="__lodash_hash_undefined__",s=1,n=2,o=9007199254740991,c="[object Arguments]",p="[object Array]",b="[object AsyncFunction]",w="[object Boolean]",x="[object Date]",E="[object Error]",I="[object Function]",S="[object GeneratorFunction]",D="[object Map]",P="[object Number]",R="[object Null]",N="[object Object]",C="[object Promise]",L="[object Proxy]",B="[object RegExp]",U="[object Set]",K="[object String]",k="[object Symbol]",z="[object Undefined]",pe="[object WeakMap]",A="[object ArrayBuffer]",_="[object DataView]",d="[object Float32Array]",a="[object Float64Array]",f="[object Int8Array]",u="[object Int16Array]",v="[object Int32Array]",y="[object Uint8Array]",m="[object Uint8ClampedArray]",l="[object Uint16Array]",g="[object Uint32Array]",h=/[\\^$.*+?()[\]{}|]/g,M=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,$={};$[d]=$[a]=$[f]=$[u]=$[v]=$[y]=$[m]=$[l]=$[g]=!0,$[c]=$[p]=$[A]=$[w]=$[_]=$[x]=$[E]=$[I]=$[D]=$[P]=$[N]=$[B]=$[U]=$[K]=$[pe]=!1;var q=typeof Zi=="object"&&Zi&&Zi.Object===Object&&Zi,G=typeof self=="object"&&self&&self.Object===Object&&self,H=q||G||Function("return this")(),V=e&&!e.nodeType&&e,Oe=V&&!0&&t&&!t.nodeType&&t,ge=Oe&&Oe.exports===V,Y=ge&&q.process,Be=function(){try{return Y&&Y.binding&&Y.binding("util")}catch{}}(),be=Be&&Be.isTypedArray;function ie(O,F){for(var j=-1,ae=O==null?0:O.length,ht=0,Ce=[];++j<ae;){var dt=O[j];F(dt,j,O)&&(Ce[ht++]=dt)}return Ce}function He(O,F){for(var j=-1,ae=F.length,ht=O.length;++j<ae;)O[ht+j]=F[j];return O}function Se(O,F){for(var j=-1,ae=O==null?0:O.length;++j<ae;)if(F(O[j],j,O))return!0;return!1}function ne(O,F){for(var j=-1,ae=Array(O);++j<O;)ae[j]=F(j);return ae}function je(O){return function(F){return O(F)}}function we(O,F){return O.has(F)}function ee(O,F){return O==null?void 0:O[F]}function Ke(O){var F=-1,j=Array(O.size);return O.forEach(function(ae,ht){j[++F]=[ht,ae]}),j}function _e(O,F){return function(j){return O(F(j))}}function re(O){var F=-1,j=Array(O.size);return O.forEach(function(ae){j[++F]=ae}),j}var Ve=Array.prototype,xe=Function.prototype,Q=Object.prototype,ze=H["__core-js_shared__"],Me=xe.toString,Z=Q.hasOwnProperty,Ze=function(){var O=/[^.]+$/.exec(ze&&ze.keys&&ze.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),Ae=Q.toString,he=RegExp("^"+Me.call(Z).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ye=ge?H.Buffer:void 0,Ee=H.Symbol,oe=H.Uint8Array,Xe=Q.propertyIsEnumerable,Pe=Ve.splice,X=Ee?Ee.toStringTag:void 0,Qe=Object.getOwnPropertySymbols,Re=Ye?Ye.isBuffer:void 0,ce=_e(Object.keys,Object),We=ln(H,"DataView"),ye=ln(H,"Map"),se=ln(H,"Promise"),Ge=ln(H,"Set"),Ie=ln(H,"WeakMap"),te=ln(Object,"create"),et=qi(We),Ne=qi(ye),ue=qi(se),tt=qi(Ge),$e=qi(Ie),fe=Ee?Ee.prototype:void 0,Je=fe?fe.valueOf:void 0;function me(O){var F=-1,j=O==null?0:O.length;for(this.clear();++F<j;){var ae=O[F];this.set(ae[0],ae[1])}}function de(){this.__data__=te?te(null):{},this.size=0}function rt(O){var F=this.has(O)&&delete this.__data__[O];return this.size-=F?1:0,F}function Te(O){var F=this.__data__;if(te){var j=F[O];return j===i?void 0:j}return Z.call(F,O)?F[O]:void 0}function le(O){var F=this.__data__;return te?F[O]!==void 0:Z.call(F,O)}function it(O,F){var j=this.__data__;return this.size+=this.has(O)?0:1,j[O]=te&&F===void 0?i:F,this}me.prototype.clear=de,me.prototype.delete=rt,me.prototype.get=Te,me.prototype.has=le,me.prototype.set=it;function ve(O){var F=-1,j=O==null?0:O.length;for(this.clear();++F<j;){var ae=O[F];this.set(ae[0],ae[1])}}function De(){this.__data__=[],this.size=0}function Qt(O){var F=this.__data__,j=Ns(F,O);if(j<0)return!1;var ae=F.length-1;return j==ae?F.pop():Pe.call(F,j,1),--this.size,!0}function er(O){var F=this.__data__,j=Ns(F,O);return j<0?void 0:F[j][1]}function tr(O){return Ns(this.__data__,O)>-1}function rr(O,F){var j=this.__data__,ae=Ns(j,O);return ae<0?(++this.size,j.push([O,F])):j[ae][1]=F,this}ve.prototype.clear=De,ve.prototype.delete=Qt,ve.prototype.get=er,ve.prototype.has=tr,ve.prototype.set=rr;function yt(O){var F=-1,j=O==null?0:O.length;for(this.clear();++F<j;){var ae=O[F];this.set(ae[0],ae[1])}}function ir(){this.size=0,this.__data__={hash:new me,map:new(ye||ve),string:new me}}function nr(O){var F=$s(this,O).delete(O);return this.size-=F?1:0,F}function sr(O){return $s(this,O).get(O)}function ar(O){return $s(this,O).has(O)}function or(O,F){var j=$s(this,O),ae=j.size;return j.set(O,F),this.size+=j.size==ae?0:1,this}yt.prototype.clear=ir,yt.prototype.delete=nr,yt.prototype.get=sr,yt.prototype.has=ar,yt.prototype.set=or;function Bt(O){var F=-1,j=O==null?0:O.length;for(this.__data__=new yt;++F<j;)this.add(O[F])}function fr(O){return this.__data__.set(O,i),this}function hr(O){return this.__data__.has(O)}Bt.prototype.add=Bt.prototype.push=fr,Bt.prototype.has=hr;function mt(O){var F=this.__data__=new ve(O);this.size=F.size}function cr(){this.__data__=new ve,this.size=0}function ur(O){var F=this.__data__,j=F.delete(O);return this.size=F.size,j}function dr(O){return this.__data__.get(O)}function ai(O){return this.__data__.has(O)}function oi(O,F){var j=this.__data__;if(j instanceof ve){var ae=j.__data__;if(!ye||ae.length<r-1)return ae.push([O,F]),this.size=++j.size,this;j=this.__data__=new yt(ae)}return j.set(O,F),this.size=j.size,this}mt.prototype.clear=cr,mt.prototype.delete=ur,mt.prototype.get=dr,mt.prototype.has=ai,mt.prototype.set=oi;function u0(O,F){var j=Ts(O),ae=!j&&I0(O),ht=!j&&!ae&&Ga(O),Ce=!j&&!ae&&!ht&&sh(O),dt=j||ae||ht||Ce,xt=dt?ne(O.length,String):[],Nt=xt.length;for(var ut in O)Z.call(O,ut)&&!(dt&&(ut=="length"||ht&&(ut=="offset"||ut=="parent")||Ce&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||_0(ut,Nt)))&&xt.push(ut);return xt}function Ns(O,F){for(var j=O.length;j--;)if(th(O[j][0],F))return j;return-1}function d0(O,F,j){var ae=F(O);return Ts(O)?ae:He(ae,j(O))}function Hn(O){return O==null?O===void 0?z:R:X&&X in Object(O)?y0(O):S0(O)}function Yf(O){return Wn(O)&&Hn(O)==c}function Xf(O,F,j,ae,ht){return O===F?!0:O==null||F==null||!Wn(O)&&!Wn(F)?O!==O&&F!==F:l0(O,F,j,ae,Xf,ht)}function l0(O,F,j,ae,ht,Ce){var dt=Ts(O),xt=Ts(F),Nt=dt?p:wi(O),ut=xt?p:wi(F);Nt=Nt==c?N:Nt,ut=ut==c?N:ut;var lr=Nt==N,Nr=ut==N,Ut=Nt==ut;if(Ut&&Ga(O)){if(!Ga(F))return!1;dt=!0,lr=!1}if(Ut&&!lr)return Ce||(Ce=new mt),dt||sh(O)?Qf(O,F,j,ae,ht,Ce):b0(O,F,Nt,j,ae,ht,Ce);if(!(j&s)){var wr=lr&&Z.call(O,"__wrapped__"),_r=Nr&&Z.call(F,"__wrapped__");if(wr||_r){var _i=wr?O.value():O,fi=_r?F.value():F;return Ce||(Ce=new mt),ht(_i,fi,j,ae,Ce)}}return Ut?(Ce||(Ce=new mt),m0(O,F,j,ae,ht,Ce)):!1}function p0(O){if(!nh(O)||M0(O))return!1;var F=rh(O)?he:M;return F.test(qi(O))}function g0(O){return Wn(O)&&ih(O.length)&&!!$[Hn(O)]}function v0(O){if(!E0(O))return ce(O);var F=[];for(var j in Object(O))Z.call(O,j)&&j!="constructor"&&F.push(j);return F}function Qf(O,F,j,ae,ht,Ce){var dt=j&s,xt=O.length,Nt=F.length;if(xt!=Nt&&!(dt&&Nt>xt))return!1;var ut=Ce.get(O);if(ut&&Ce.get(F))return ut==F;var lr=-1,Nr=!0,Ut=j&n?new Bt:void 0;for(Ce.set(O,F),Ce.set(F,O);++lr<xt;){var wr=O[lr],_r=F[lr];if(ae)var _i=dt?ae(_r,wr,lr,F,O,Ce):ae(wr,_r,lr,O,F,Ce);if(_i!==void 0){if(_i)continue;Nr=!1;break}if(Ut){if(!Se(F,function(fi,Bi){if(!we(Ut,Bi)&&(wr===fi||ht(wr,fi,j,ae,Ce)))return Ut.push(Bi)})){Nr=!1;break}}else if(!(wr===_r||ht(wr,_r,j,ae,Ce))){Nr=!1;break}}return Ce.delete(O),Ce.delete(F),Nr}function b0(O,F,j,ae,ht,Ce,dt){switch(j){case _:if(O.byteLength!=F.byteLength||O.byteOffset!=F.byteOffset)return!1;O=O.buffer,F=F.buffer;case A:return!(O.byteLength!=F.byteLength||!Ce(new oe(O),new oe(F)));case w:case x:case P:return th(+O,+F);case E:return O.name==F.name&&O.message==F.message;case B:case K:return O==F+"";case D:var xt=Ke;case U:var Nt=ae&s;if(xt||(xt=re),O.size!=F.size&&!Nt)return!1;var ut=dt.get(O);if(ut)return ut==F;ae|=n,dt.set(O,F);var lr=Qf(xt(O),xt(F),ae,ht,Ce,dt);return dt.delete(O),lr;case k:if(Je)return Je.call(O)==Je.call(F)}return!1}function m0(O,F,j,ae,ht,Ce){var dt=j&s,xt=eh(O),Nt=xt.length,ut=eh(F),lr=ut.length;if(Nt!=lr&&!dt)return!1;for(var Nr=Nt;Nr--;){var Ut=xt[Nr];if(!(dt?Ut in F:Z.call(F,Ut)))return!1}var wr=Ce.get(O);if(wr&&Ce.get(F))return wr==F;var _r=!0;Ce.set(O,F),Ce.set(F,O);for(var _i=dt;++Nr<Nt;){Ut=xt[Nr];var fi=O[Ut],Bi=F[Ut];if(ae)var ah=dt?ae(Bi,fi,Ut,F,O,Ce):ae(fi,Bi,Ut,O,F,Ce);if(!(ah===void 0?fi===Bi||ht(fi,Bi,j,ae,Ce):ah)){_r=!1;break}_i||(_i=Ut=="constructor")}if(_r&&!_i){var Fs=O.constructor,Cs=F.constructor;Fs!=Cs&&"constructor"in O&&"constructor"in F&&!(typeof Fs=="function"&&Fs instanceof Fs&&typeof Cs=="function"&&Cs instanceof Cs)&&(_r=!1)}return Ce.delete(O),Ce.delete(F),_r}function eh(O){return d0(O,O0,w0)}function $s(O,F){var j=O.__data__;return x0(F)?j[typeof F=="string"?"string":"hash"]:j.map}function ln(O,F){var j=ee(O,F);return p0(j)?j:void 0}function y0(O){var F=Z.call(O,X),j=O[X];try{O[X]=void 0;var ae=!0}catch{}var ht=Ae.call(O);return ae&&(F?O[X]=j:delete O[X]),ht}var w0=Qe?function(O){return O==null?[]:(O=Object(O),ie(Qe(O),function(F){return Xe.call(O,F)}))}:P0,wi=Hn;(We&&wi(new We(new ArrayBuffer(1)))!=_||ye&&wi(new ye)!=D||se&&wi(se.resolve())!=C||Ge&&wi(new Ge)!=U||Ie&&wi(new Ie)!=pe)&&(wi=function(O){var F=Hn(O),j=F==N?O.constructor:void 0,ae=j?qi(j):"";if(ae)switch(ae){case et:return _;case Ne:return D;case ue:return C;case tt:return U;case $e:return pe}return F});function _0(O,F){return F=F??o,!!F&&(typeof O=="number"||T.test(O))&&O>-1&&O%1==0&&O<F}function x0(O){var F=typeof O;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?O!=="__proto__":O===null}function M0(O){return!!Ze&&Ze in O}function E0(O){var F=O&&O.constructor,j=typeof F=="function"&&F.prototype||Q;return O===j}function S0(O){return Ae.call(O)}function qi(O){if(O!=null){try{return Me.call(O)}catch{}try{return O+""}catch{}}return""}function th(O,F){return O===F||O!==O&&F!==F}var I0=Yf(function(){return arguments}())?Yf:function(O){return Wn(O)&&Z.call(O,"callee")&&!Xe.call(O,"callee")},Ts=Array.isArray;function A0(O){return O!=null&&ih(O.length)&&!rh(O)}var Ga=Re||R0;function D0(O,F){return Xf(O,F)}function rh(O){if(!nh(O))return!1;var F=Hn(O);return F==I||F==S||F==b||F==L}function ih(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=o}function nh(O){var F=typeof O;return O!=null&&(F=="object"||F=="function")}function Wn(O){return O!=null&&typeof O=="object"}var sh=be?je(be):g0;function O0(O){return A0(O)?u0(O):v0(O)}function P0(){return[]}function R0(){return!1}t.exports=D0})(ya,ya.exports);var n8=ya.exports;const s8=Tn(n8),Hl="wc",Wl=2,wa="core",ii=`${Hl}@2:${wa}:`,a8={name:wa,logger:"error"},o8={database:":memory:"},f8="crypto",su="client_ed25519_seed",h8=W.ONE_DAY,c8="keychain",u8="0.3",d8="messages",l8="0.3",au=W.SIX_HOURS,p8="publisher",Gl="irn",g8="error",Jl="wss://relay.walletconnect.org",v8="relayer",It={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},b8="_subscription",xr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},m8=.1,hf="2.18.0",st={link_mode:"link_mode",relay:"relay"},y8="0.3",w8="WALLETCONNECT_CLIENT_ID",ou="WALLETCONNECT_LINK_MODE_APPS",pr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},_8="subscription",x8="0.3",M8=W.FIVE_SECONDS*1e3,E8="pairing",S8="0.3",is={wc_pairingDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:W.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:W.ONE_DAY,prompt:!1,tag:0},res:{ttl:W.ONE_DAY,prompt:!1,tag:0}}},Ji={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Fr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},I8="history",A8="0.3",D8="expirer",Mr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},O8="0.3",P8="verify-api",R8="https://verify.walletconnect.com",Zl="https://verify.walletconnect.org",us=Zl,N8=`${us}/v3`,$8=[R8,Zl],T8="echo",F8="https://echo.walletconnect.com",Wr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},li={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Cr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ki={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Vi={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},ns={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},C8=.1,L8="event-client",q8=86400,B8="https://pulse.walletconnect.org/batch";function U8(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<t.length;s++){var n=t.charAt(s),o=n.charCodeAt(0);if(r[o]!==255)throw new TypeError(n+" is ambiguous");r[o]=s}var c=t.length,p=t.charAt(0),b=Math.log(c)/Math.log(256),w=Math.log(256)/Math.log(c);function x(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var D=0,P=0,R=0,N=S.length;R!==N&&S[R]===0;)R++,D++;for(var C=(N-R)*w+1>>>0,L=new Uint8Array(C);R!==N;){for(var B=S[R],U=0,K=C-1;(B!==0||U<P)&&K!==-1;K--,U++)B+=256*L[K]>>>0,L[K]=B%c>>>0,B=B/c>>>0;if(B!==0)throw new Error("Non-zero carry");P=U,R++}for(var k=C-P;k!==C&&L[k]===0;)k++;for(var z=p.repeat(D);k<C;++k)z+=t.charAt(L[k]);return z}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var D=0;if(S[D]!==" "){for(var P=0,R=0;S[D]===p;)P++,D++;for(var N=(S.length-D)*b+1>>>0,C=new Uint8Array(N);S[D];){var L=r[S.charCodeAt(D)];if(L===255)return;for(var B=0,U=N-1;(L!==0||B<R)&&U!==-1;U--,B++)L+=c*C[U]>>>0,C[U]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");R=B,D++}if(S[D]!==" "){for(var K=N-R;K!==N&&C[K]===0;)K++;for(var k=new Uint8Array(P+(N-K)),z=P;K!==N;)k[z++]=C[K++];return k}}}function I(S){var D=E(S);if(D)return D;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:E,decode:I}}var z8=U8,k8=z8;const Yl=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},j8=t=>new TextEncoder().encode(t),K8=t=>new TextDecoder().decode(t);class V8{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class H8{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Xl(this,e)}}class W8{constructor(e){this.decoders=e}or(e){return Xl(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Xl=(t,e)=>new W8({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class G8{constructor(e,r,i,s){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new V8(e,r,i),this.decoder=new H8(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ha=({name:t,prefix:e,encode:r,decode:i})=>new G8(t,e,r,i),Rs=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:s}=k8(r,e);return Ha({prefix:t,name:e,encode:i,decode:n=>Yl(s(n))})},J8=(t,e,r,i)=>{const s={};for(let w=0;w<e.length;++w)s[e[w]]=w;let n=t.length;for(;t[n-1]==="=";)--n;const o=new Uint8Array(n*r/8|0);let c=0,p=0,b=0;for(let w=0;w<n;++w){const x=s[t[w]];if(x===void 0)throw new SyntaxError(`Non-${i} character`);p=p<<r|x,c+=r,c>=8&&(c-=8,o[b++]=255&p>>c)}if(c>=r||255&p<<8-c)throw new SyntaxError("Unexpected end of data");return o},Z8=(t,e,r)=>{const i=e[e.length-1]==="=",s=(1<<r)-1;let n="",o=0,c=0;for(let p=0;p<t.length;++p)for(c=c<<8|t[p],o+=8;o>r;)o-=r,n+=e[s&c>>o];if(o&&(n+=e[s&c<<r-o]),i)for(;n.length*r&7;)n+="=";return n},qt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Ha({prefix:e,name:t,encode(s){return Z8(s,i,r)},decode(s){return J8(s,i,r,t)}}),Y8=Ha({prefix:"\0",name:"identity",encode:t=>K8(t),decode:t=>j8(t)});var X8=Object.freeze({__proto__:null,identity:Y8});const Q8=qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var e5=Object.freeze({__proto__:null,base2:Q8});const t5=qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var r5=Object.freeze({__proto__:null,base8:t5});const i5=Rs({prefix:"9",name:"base10",alphabet:"0123456789"});var n5=Object.freeze({__proto__:null,base10:i5});const s5=qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),a5=qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var o5=Object.freeze({__proto__:null,base16:s5,base16upper:a5});const f5=qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),h5=qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),c5=qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),u5=qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),d5=qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l5=qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),p5=qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),g5=qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),v5=qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var b5=Object.freeze({__proto__:null,base32:f5,base32upper:h5,base32pad:c5,base32padupper:u5,base32hex:d5,base32hexupper:l5,base32hexpad:p5,base32hexpadupper:g5,base32z:v5});const m5=Rs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),y5=Rs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var w5=Object.freeze({__proto__:null,base36:m5,base36upper:y5});const _5=Rs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),x5=Rs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var M5=Object.freeze({__proto__:null,base58btc:_5,base58flickr:x5});const E5=qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),S5=qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),I5=qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),A5=qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var D5=Object.freeze({__proto__:null,base64:E5,base64pad:S5,base64url:I5,base64urlpad:A5});const Ql=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),O5=Ql.reduce((t,e,r)=>(t[r]=e,t),[]),P5=Ql.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function R5(t){return t.reduce((e,r)=>(e+=O5[r],e),"")}function N5(t){const e=[];for(const r of t){const i=P5[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const $5=Ha({prefix:"🚀",name:"base256emoji",encode:R5,decode:N5});var T5=Object.freeze({__proto__:null,base256emoji:$5}),F5=e0,fu=128,C5=-128,L5=Math.pow(2,31);function e0(t,e,r){e=e||[],r=r||0;for(var i=r;t>=L5;)e[r++]=t&255|fu,t/=128;for(;t&C5;)e[r++]=t&255|fu,t>>>=7;return e[r]=t|0,e0.bytes=r-i+1,e}var q5=cf,B5=128,hu=127;function cf(t,i){var r=0,i=i||0,s=0,n=i,o,c=t.length;do{if(n>=c)throw cf.bytes=0,new RangeError("Could not decode varint");o=t[n++],r+=s<28?(o&hu)<<s:(o&hu)*Math.pow(2,s),s+=7}while(o>=B5);return cf.bytes=n-i,r}var U5=Math.pow(2,7),z5=Math.pow(2,14),k5=Math.pow(2,21),j5=Math.pow(2,28),K5=Math.pow(2,35),V5=Math.pow(2,42),H5=Math.pow(2,49),W5=Math.pow(2,56),G5=Math.pow(2,63),J5=function(t){return t<U5?1:t<z5?2:t<k5?3:t<j5?4:t<K5?5:t<V5?6:t<H5?7:t<W5?8:t<G5?9:10},Z5={encode:F5,decode:q5,encodingLength:J5},t0=Z5;const cu=(t,e,r=0)=>(t0.encode(t,e,r),e),uu=t=>t0.encodingLength(t),uf=(t,e)=>{const r=e.byteLength,i=uu(t),s=i+uu(r),n=new Uint8Array(s+r);return cu(t,n,0),cu(r,n,i),n.set(e,s),new Y5(t,r,e,n)};class Y5{constructor(e,r,i,s){this.code=e,this.size=r,this.digest=i,this.bytes=s}}const r0=({name:t,code:e,encode:r})=>new X5(t,e,r);class X5{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?uf(this.code,r):r.then(i=>uf(this.code,i))}else throw Error("Unknown type, must be binary type")}}const i0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Q5=r0({name:"sha2-256",code:18,encode:i0("SHA-256")}),e9=r0({name:"sha2-512",code:19,encode:i0("SHA-512")});var t9=Object.freeze({__proto__:null,sha256:Q5,sha512:e9});const n0=0,r9="identity",s0=Yl,i9=t=>uf(n0,s0(t)),n9={code:n0,name:r9,encode:s0,digest:i9};var s9=Object.freeze({__proto__:null,identity:n9});new TextEncoder,new TextDecoder;const du={...X8,...e5,...r5,...n5,...o5,...b5,...w5,...M5,...D5,...T5};({...t9,...s9});function a9(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function a0(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const lu=a0("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),$o=a0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=a9(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),o9={utf8:lu,"utf-8":lu,hex:du.base16,latin1:$o,ascii:$o,binary:$o,...du};function f9(t,e="utf8"){const r=o9[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}class h9{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=c8,this.version=u8,this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Ht(r,this.name)}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,gl(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?vl(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class c9{constructor(e,r,i){this.core=e,this.logger=r,this.name=f8,this.randomSessionIdentifier=ff(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),n=Vh(s);return Ed(n.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=Z6();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const n=await this.getClientSeed(),o=Vh(n),c=this.randomSessionIdentifier;return await Db(c,s,h8,o)},this.generateSharedKey=(s,n,o)=>{this.isInitialized();const c=this.getPrivateKey(s),p=Y6(c,n);return this.setSymKey(p,o)},this.setSymKey=async(s,n)=>{this.isInitialized();const o=n||ia(s);return await this.keychain.set(o,s),o},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,n,o)=>{this.isInitialized();const c=kl(o),p=tn(n);if(Wc(c))return e4(p,o==null?void 0:o.encoding);if(Hc(c)){const E=c.senderPublicKey,I=c.receiverPublicKey;s=await this.generateSharedKey(E,I)}const b=this.getSymKey(s),{type:w,senderPublicKey:x}=c;return X6({type:w,symKey:b,message:p,senderPublicKey:x,encoding:o==null?void 0:o.encoding})},this.decode=async(s,n,o)=>{this.isInitialized();const c=r4(n,o);if(Wc(c)){const p=t4(n,o==null?void 0:o.encoding);return In(p)}if(Hc(c)){const p=c.receiverPublicKey,b=c.senderPublicKey;s=await this.generateSharedKey(p,b)}try{const p=this.getSymKey(s),b=Q6({symKey:p,encoded:n,encoding:o==null?void 0:o.encoding});return In(b)}catch(p){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(p)}},this.getPayloadType=(s,n=Ri)=>{const o=bs({encoded:s,encoding:n});return sn(o.type)},this.getPayloadSenderPublicKey=(s,n=Ri)=>{const o=bs({encoded:s,encoding:n});return o.senderPublicKey?Vt(o.senderPublicKey,jt):void 0},this.core=e,this.logger=Ht(r,this.name),this.keychain=i||new h9(this.core,this.logger)}get context(){return Xt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(su)}catch{e=ff(),await this.keychain.set(su,e)}return f9(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class u9 extends D1{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=d8,this.version=l8,this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const n=pi(s);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[n]<"u"||(o[n]=s,this.messages.set(i,o),await this.persist()),n},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const n=this.get(i),o=pi(s);return typeof n[o]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Ht(e,this.name),this.core=r}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,gl(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?vl(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var d9=Object.defineProperty,l9=Object.defineProperties,p9=Object.getOwnPropertyDescriptors,pu=Object.getOwnPropertySymbols,g9=Object.prototype.hasOwnProperty,v9=Object.prototype.propertyIsEnumerable,gu=(t,e,r)=>e in t?d9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vu=(t,e)=>{for(var r in e||(e={}))g9.call(e,r)&&gu(t,r,e[r]);if(pu)for(var r of pu(e))v9.call(e,r)&&gu(t,r,e[r]);return t},bu=(t,e)=>l9(t,p9(e));class b9 extends O1{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new jr.EventEmitter,this.name=p8,this.queue=new Map,this.publishTimeout=W.toMiliseconds(W.ONE_MINUTE),this.initialPublishTimeout=W.toMiliseconds(W.ONE_SECOND*15),this.needsTransportRestart=!1,this.publish=async(i,s,n)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:n}});const c=(n==null?void 0:n.ttl)||au,p=va(n),b=(n==null?void 0:n.prompt)||!1,w=(n==null?void 0:n.tag)||0,x=(n==null?void 0:n.id)||Xi().toString(),E={topic:i,message:s,opts:{ttl:c,relay:p,prompt:b,tag:w,id:x,attestation:n==null?void 0:n.attestation}},I=`Failed to publish payload, please try again. id:${x} tag:${w}`;try{const S=new Promise(async D=>{const P=({id:N})=>{E.opts.id===N&&(this.removeRequestFromQueue(N),this.relayer.events.removeListener(It.publish,P),D(E))};this.relayer.events.on(It.publish,P);const R=Pi(new Promise((N,C)=>{this.rpcPublish({topic:i,message:s,ttl:c,prompt:b,tag:w,id:x,attestation:n==null?void 0:n.attestation}).then(N).catch(L=>{this.logger.warn(L,L==null?void 0:L.message),C(L)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${x} tag:${w}`);try{await R,this.events.removeListener(It.publish,P)}catch(N){this.queue.set(x,bu(vu({},E),{attempt:1})),this.logger.warn(N,N==null?void 0:N.message)}});this.logger.trace({type:"method",method:"publish",params:{id:x,topic:i,message:s,opts:n}}),await Pi(S,this.publishTimeout,I)}catch(S){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(S),(o=n==null?void 0:n.internal)!=null&&o.throwOnFailedPublish)throw S}finally{this.queue.delete(x)}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=e,this.logger=Ht(r,this.name),this.registerEventListeners()}get context(){return Xt(this.logger)}async rpcPublish(e){var r,i,s,n;const{topic:o,message:c,ttl:p=au,prompt:b,tag:w,id:x,attestation:E}=e,I={method:fs(va().protocol).publish,params:{topic:o,message:c,ttl:p,prompt:b,tag:w,attestation:E},id:x};Kt((r=I.params)==null?void 0:r.prompt)&&((i=I.params)==null||delete i.prompt),Kt((s=I.params)==null?void 0:s.tag)&&((n=I.params)==null||delete n.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I});const S=await this.relayer.request(I);return this.relayer.events.emit(It.publish,e),this.logger.debug("Successfully Published Payload"),S}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const i=e.attempt+1;this.queue.set(r,bu(vu({},e),{attempt:i}));const{topic:s,message:n,opts:o,attestation:c}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish({topic:s,message:n,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:c}),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(It.connection_stalled);return}this.checkQueue()}),this.relayer.on(It.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class m9{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const s=i.filter(n=>n!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var y9=Object.defineProperty,w9=Object.defineProperties,_9=Object.getOwnPropertyDescriptors,mu=Object.getOwnPropertySymbols,x9=Object.prototype.hasOwnProperty,M9=Object.prototype.propertyIsEnumerable,yu=(t,e,r)=>e in t?y9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ss=(t,e)=>{for(var r in e||(e={}))x9.call(e,r)&&yu(t,r,e[r]);if(mu)for(var r of mu(e))M9.call(e,r)&&yu(t,r,e[r]);return t},To=(t,e)=>w9(t,_9(e));class E9 extends N1{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new m9,this.events=new jr.EventEmitter,this.name=_8,this.version=x8,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ii,this.subscribeTimeout=W.toMiliseconds(W.ONE_MINUTE),this.initialSubscribeTimeout=W.toMiliseconds(W.ONE_SECOND*15),this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const n=va(s),o={topic:i,relay:n,transportType:s==null?void 0:s.transportType};this.pending.set(i,o);const c=await this.rpcSubscribe(i,n,s);return typeof c=="string"&&(this.onSubscribe(c,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}})),c}catch(n){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(n),n}},this.unsubscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const s=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((n,o)=>{const c=new W.Watch;c.start(s);const p=setInterval(()=>{(!this.pending.has(i)&&this.topics.includes(i)||this.cached.some(b=>b.topic===i))&&(clearInterval(p),c.stop(s),n(!0)),c.elapsed(s)>=M8&&(clearInterval(p),c.stop(s),o(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{await this.restore(),await this.onRestart()},this.checkPending=async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const i=[];this.pending.forEach(s=>{i.push(s)}),await this.batchSubscribe(i)},this.registerEventListeners=()=>{this.relayer.core.heartbeat.on(Fn.pulse,async()=>{await this.checkPending()}),this.events.on(pr.created,async i=>{const s=pr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:i}),await this.persist()}),this.events.on(pr.deleted,async i=>{const s=pr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:i}),await this.persist()})},this.relayer=e,this.logger=Ht(r,this.name),this.clientId=""}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const s=va(i);await this.rpcUnsubscribe(e,r,s);const n=at("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r,i){var s;(i==null?void 0:i.transportType)===st.relay&&await this.restartToComplete();const n={method:fs(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});const o=(s=i==null?void 0:i.internal)==null?void 0:s.throwOnFailedPublish;try{const c=this.getSubscriptionId(e);if((i==null?void 0:i.transportType)===st.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(n).catch(w=>this.logger.warn(w))},W.toMiliseconds(W.ONE_SECOND)),c;const p=new Promise(async w=>{const x=E=>{E.topic===e&&(this.events.removeListener(pr.created,x),w(E.id))};this.events.on(pr.created,x);try{const E=await Pi(new Promise((I,S)=>{this.relayer.request(n).catch(D=>{this.logger.warn(D,D==null?void 0:D.message),S(D)}).then(I)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(pr.created,x),w(E)}catch{}}),b=await Pi(p,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!b&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return b?c:null}catch(c){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(It.connection_stalled),o)throw c}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:fs(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Pi(new Promise(s=>{this.relayer.request(i).catch(n=>this.logger.warn(n)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(It.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,i={method:fs(r.protocol).batchFetchMessages,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let s;try{s=await await Pi(new Promise((n,o)=>{this.relayer.request(i).catch(c=>{this.logger.warn(c),o(c)}).then(n)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(It.connection_stalled)}return s}rpcUnsubscribe(e,r,i){const s={method:fs(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,To(ss({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,ss({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,ss({},r)),this.topicMap.set(r.topic,e),this.events.emit(pr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(pr.deleted,To(ss({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(pr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(pr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(e.map(r=>To(ss({},r),{id:this.getSubscriptionId(r.topic)}))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await cw(W.toMiliseconds(W.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen()}getSubscriptionId(e){return pi(e+this.clientId)}}var S9=Object.defineProperty,wu=Object.getOwnPropertySymbols,I9=Object.prototype.hasOwnProperty,A9=Object.prototype.propertyIsEnumerable,_u=(t,e,r)=>e in t?S9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xu=(t,e)=>{for(var r in e||(e={}))I9.call(e,r)&&_u(t,r,e[r]);if(wu)for(var r of wu(e))A9.call(e,r)&&_u(t,r,e[r]);return t};class D9 extends P1{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new jr.EventEmitter,this.name=v8,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1,this.heartBeatTimeout=W.toMiliseconds(W.THIRTY_SECONDS+W.FIVE_SECONDS),this.requestsInFlight=[],this.connectTimeout=W.toMiliseconds(W.ONE_SECOND*15),this.request=async r=>{var i,s;this.logger.debug("Publishing Request Payload");const n=r.id||Xi().toString();await this.toEstablishConnection();try{this.logger.trace({id:n,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const o=`${n}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(p=>p!==o),c}catch(o){throw this.logger.debug(`Failed to Publish Request: ${n}`),o}},this.resetPingTimeout=()=>{if(pa())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,s;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(s=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||s.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r,r==null?void 0:r.message)}},this.onPayloadHandler=r=>{this.onProviderPayload(r),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(It.connect)},this.onDisconnectHandler=()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.fatal(r,`Fatal socket error: ${r==null?void 0:r.message}`),this.events.emit(It.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(xr.payload,this.onPayloadHandler),this.provider.on(xr.connect,this.onConnectHandler),this.provider.on(xr.disconnect,this.onDisconnectHandler),this.provider.on(xr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ht(e.logger,this.name):Sa(vf({level:e.logger||g8})),this.messages=new u9(this.logger,e.core),this.subscriber=new E9(this,this.logger),this.publisher=new b9(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Jl,this.projectId=e.projectId,G3()?this.packageName=yc():J3()&&(this.bundleId=yc()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Xt(this.logger)}get connected(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===1}get connecting(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===0}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:st.relay})}async subscribe(e,r){var i,s,n;this.isInitialized(),(!(r!=null&&r.transportType)||(r==null?void 0:r.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(s=r==null?void 0:r.internal)==null?void 0:s.throwOnFailedPublish;let c=((n=this.subscriber.topicMap.get(e))==null?void 0:n[0])||"",p;const b=w=>{w.topic===e&&(this.subscriber.off(pr.created,b),p())};return await Promise.all([new Promise(w=>{p=w,this.subscriber.on(pr.created,b)}),new Promise(async(w,x)=>{c=await this.subscriber.subscribe(e,xu({internal:{throwOnFailedPublish:o}},r)).catch(E=>{o&&x(E)})||c,w()})]),c}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Pi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,i)=>{await this.connect(e).then(r).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await tu())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((i,s)=>i.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const i of r)try{await this.onMessageEvent(i)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:i}=e;if(!r.sessionExists){const s=wt(W.FIVE_MINUTES),n={topic:i,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,n)}this.events.emit(It.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(i,s)=>{const n=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(xr.disconnect,n),await Pi(new Promise((o,c)=>{this.provider.connect().then(o).catch(c)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(xr.disconnect,n),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),await new Promise(async(o,c)=>{const p=()=>{c(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(xr.disconnect,p),await this.subscriber.start().then(o).catch(c).finally(()=>{this.provider.off(xr.disconnect,p)})}),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){await this.subscriber.stop();const s=i;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(i=>setTimeout(i,W.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,i,s,n;if(pa())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((n=(s=(i=this.provider)==null?void 0:i.connection)==null?void 0:s.socket)==null||n.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Q4(new i8(Q3({sdkVersion:hf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.warn(`Ignoring message for non-subscribed topic ${r}`),!0;const s=this.messages.has(r,i);return s&&this.logger.warn(`Ignoring duplicate message: ${i}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Gf(e)){if(!e.method.endsWith(b8))return;const r=e.params,{topic:i,message:s,publishedAt:n,attestation:o}=r.data,c={topic:i,message:s,publishedAt:n,transportType:st.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(xu({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}else Va(e)&&this.events.emit(It.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(It.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=lf(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(xr.payload,this.onPayloadHandler),this.provider.off(xr.connect,this.onConnectHandler),this.provider.off(xr.disconnect,this.onDisconnectHandler),this.provider.off(xr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await tu();j4(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(i=>this.logger.error(i,i==null?void 0:i.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),clearTimeout(this.pingTimeout),this.events.emit(It.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||this.connectPromise||(this.reconnectTimeout=setTimeout(async()=>{clearTimeout(this.reconnectTimeout),await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message))},W.toMiliseconds(m8))))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.transportOpen()}}var O9=Object.defineProperty,Mu=Object.getOwnPropertySymbols,P9=Object.prototype.hasOwnProperty,R9=Object.prototype.propertyIsEnumerable,Eu=(t,e,r)=>e in t?O9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Su=(t,e)=>{for(var r in e||(e={}))P9.call(e,r)&&Eu(t,r,e[r]);if(Mu)for(var r of Mu(e))R9.call(e,r)&&Eu(t,r,e[r]);return t};class dn extends R1{constructor(e,r,i,s=ii,n=void 0){super(e,r,i,s),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=y8,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Kt(o)?this.map.set(this.getKey(o),o):w4(o)?this.map.set(o.id,o):_4(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)},this.set=async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(p=>s8(c[p],o[p]))):this.values),this.update=async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const p=Su(Su({},this.getData(o)),c);this.map.set(o,p),await this.persist()},this.delete=async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())},this.logger=Ht(r,this.name),this.storagePrefix=s,this.getKey=n}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:s}=J("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class N9{constructor(e,r){this.core=e,this.logger=r,this.name=E8,this.version=S8,this.events=new ku,this.initialized=!1,this.storagePrefix=ii,this.ignoredPayloadTypes=[vi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const s=ff(),n=await this.core.crypto.setSymKey(s),o=wt(W.FIVE_MINUTES),c={protocol:Gl},p={topic:n,expiry:o,relay:c,active:!1,methods:i==null?void 0:i.methods},b=Jc({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:s,relay:c,expiryTimestamp:o,methods:i==null?void 0:i.methods});return this.events.emit(Ji.create,p),this.core.expirer.set(n,o),await this.pairings.set(n,p),await this.core.relayer.subscribe(n,{transportType:i==null?void 0:i.transportType}),{topic:n,uri:b}},this.pair=async i=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[Wr.pairing_started]}});this.isValidPair(i,s);const{topic:n,symKey:o,relay:c,expiryTimestamp:p,methods:b}=Gc(i.uri);s.props.properties.topic=n,s.addTrace(Wr.pairing_uri_validation_success),s.addTrace(Wr.pairing_uri_not_expired);let w;if(this.pairings.keys.includes(n)){if(w=this.pairings.get(n),s.addTrace(Wr.existing_pairing),w.active)throw s.setError(li.active_pairing_already_exists),new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);s.addTrace(Wr.pairing_not_expired)}const x=p||wt(W.FIVE_MINUTES),E={topic:n,relay:c,expiry:x,active:!1,methods:b};this.core.expirer.set(n,x),await this.pairings.set(n,E),s.addTrace(Wr.store_new_pairing),i.activatePairing&&await this.activate({topic:n}),this.events.emit(Ji.create,E),s.addTrace(Wr.emit_inactive_pairing),this.core.crypto.keychain.has(n)||await this.core.crypto.setSymKey(o,n),s.addTrace(Wr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(li.no_internet_connection)}try{await this.core.relayer.subscribe(n,{relay:c})}catch(I){throw s.setError(li.subscribe_pairing_topic_failure),I}return s.addTrace(Wr.subscribe_pairing_topic_success),E},this.activate=async({topic:i})=>{this.isInitialized();const s=wt(W.FIVE_MINUTES);this.core.expirer.set(i,s),await this.pairings.update(i,{active:!0,expiry:s})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=i;if(this.pairings.keys.includes(s)){const n=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:c,reject:p}=Hi();this.events.once(qe("pairing_ping",n),({error:b})=>{b?p(b):c()}),await o()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",at("USER_DISCONNECTED")),await this.deletePairing(s))},this.formatUriFromPairing=i=>{this.isInitialized();const{topic:s,relay:n,expiry:o,methods:c}=i,p=this.core.crypto.keychain.get(s);return Jc({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:p,relay:n,expiryTimestamp:o,methods:c})},this.sendRequest=async(i,s,n)=>{const o=Yi(s,n),c=await this.core.crypto.encode(i,o),p=is[s].req;return this.core.history.set(i,o),this.core.relayer.publish(i,c,p),o.id},this.sendResult=async(i,s,n)=>{const o=lf(i,n),c=await this.core.crypto.encode(s,o),p=await this.core.history.get(s,i),b=is[p.request.method].res;await this.core.relayer.publish(s,c,b),await this.core.history.resolve(o)},this.sendError=async(i,s,n)=>{const o=df(i,n),c=await this.core.crypto.encode(s,o),p=await this.core.history.get(s,i),b=is[p.request.method]?is[p.request.method].res:is.unregistered_method.res;await this.core.relayer.publish(s,c,b),await this.core.history.resolve(o)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,at("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>Di(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:n}=i;switch(n.method){case"wc_pairingPing":return this.onPairingPingRequest(s,n);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,n);default:return this.onUnknownRpcMethodRequest(s,n)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:n}=i,o=(await this.core.history.get(s,n.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,n);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(i,s)=>{const{id:n}=s;try{this.isValidPing({topic:i}),await this.sendResult(n,i,!0),this.events.emit(Ji.ping,{id:n,topic:i})}catch(o){await this.sendError(n,i,o),this.logger.error(o)}},this.onPairingPingResponse=(i,s)=>{const{id:n}=s;setTimeout(()=>{Gr(s)?this.events.emit(qe("pairing_ping",n),{}):Er(s)&&this.events.emit(qe("pairing_ping",n),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:n}=s;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Ji.delete,{id:n,topic:i})}catch(o){await this.sendError(n,i,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:n,method:o}=s;try{if(this.registeredMethods.includes(o))return;const c=at("WC_METHOD_UNSUPPORTED",o);await this.sendError(n,i,c),this.logger.error(c)}catch(c){await this.sendError(n,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(at("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,s)=>{var n;if(!Jt(i)){const{message:c}=J("MISSING_OR_INVALID",`pair() params: ${i}`);throw s.setError(li.malformed_pairing_uri),new Error(c)}if(!y4(i.uri)){const{message:c}=J("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw s.setError(li.malformed_pairing_uri),new Error(c)}const o=Gc(i==null?void 0:i.uri);if(!((n=o==null?void 0:o.relay)!=null&&n.protocol)){const{message:c}=J("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(li.malformed_pairing_uri),new Error(c)}if(!(o!=null&&o.symKey)){const{message:c}=J("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(li.malformed_pairing_uri),new Error(c)}if(o!=null&&o.expiryTimestamp&&W.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(li.pairing_expired);const{message:c}=J("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(c)}},this.isValidPing=async i=>{if(!Jt(i)){const{message:n}=J("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(n)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!Jt(i)){const{message:n}=J("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(n)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!vt(i,!1)){const{message:s}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(Di(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=J("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=e,this.logger=Ht(r,this.name),this.pairings=new dn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Xt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(It.message,async e=>{const{topic:r,message:i,transportType:s}=e;if(!this.pairings.keys.includes(r)||s===st.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);try{Gf(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Va(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.core.history.delete(r,n.id))}catch(o){this.logger.error(o)}})}registerExpirerEvents(){this.core.expirer.on(Mr.expired,async e=>{const{topic:r}=ml(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Ji.expire,{topic:r}))})}}class $9 extends A1{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new jr.EventEmitter,this.name=I8,this.version=A8,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,n)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:n}),this.records.has(s.id))return;const o={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:n,expiry:wt(W.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Fr.created,o)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=Er(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.persist(),this.events.emit(Fr.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(n=>{if(n.topic===i){if(typeof s<"u"&&n.id!==s)return;this.records.delete(n.id),this.events.emit(Fr.deleted,n)}}),this.persist()},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Ht(r,this.name)}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Yi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Fr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Fr.created,e=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Fr.updated,e=>{const r=Fr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Fr.deleted,e=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Fn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{W.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Fr.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class T9 extends $1{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new jr.EventEmitter,this.name=D8,this.version=O8,this.cached=[],this.initialized=!1,this.storagePrefix=ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const n=this.formatTarget(i),o={target:n,expiry:s};this.expirations.set(n,o),this.checkExpiry(n,o),this.events.emit(Mr.created,{target:n,expiration:o})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),n=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Mr.deleted,{target:s,expiration:n})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Ht(r,this.name)}get context(){return Xt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return ew(e);if(typeof e=="number")return tw(e);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Mr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;W.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Mr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Fn.pulse,()=>this.checkExpirations()),this.events.on(Mr.created,e=>{const r=Mr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Mr.expired,e=>{const r=Mr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Mr.deleted,e=>{const r=Mr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class F9 extends T1{constructor(e,r,i){super(e,r,i),this.core=e,this.logger=r,this.store=i,this.name=P8,this.verifyUrlV3=N8,this.storagePrefix=ii,this.version=Wl,this.init=async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&W.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async s=>{if(!Is()||this.isDevEnv)return;const n=window.location.origin,{id:o,decryptedId:c}=s,p=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${n}&id=${o}&decryptedId=${c}`;try{const b=_s(),w=this.startAbortTimer(W.ONE_SECOND*5),x=await new Promise((E,I)=>{const S=()=>{window.removeEventListener("message",P),b.body.removeChild(D),I("attestation aborted")};this.abortController.signal.addEventListener("abort",S);const D=b.createElement("iframe");D.src=p,D.style.display="none",D.addEventListener("error",S,{signal:this.abortController.signal});const P=R=>{if(R.data&&typeof R.data=="string")try{const N=JSON.parse(R.data);if(N.type==="verify_attestation"){if(Wo(N.attestation).payload.id!==o)return;clearInterval(w),b.body.removeChild(D),this.abortController.signal.removeEventListener("abort",S),window.removeEventListener("message",P),E(N.attestation===null?"":N.attestation)}}catch(N){this.logger.warn(N)}};b.body.appendChild(D),window.addEventListener("message",P,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",x),x}catch(b){this.logger.warn(b)}return""},this.resolve=async s=>{if(this.isDevEnv)return"";const{attestationId:n,hash:o,encryptedId:c}=s;if(n===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(n){if(Wo(n).payload.id!==c)return;const b=await this.isValidJwtAttestation(n);if(b){if(!b.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return b}}if(!o)return;const p=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,p)},this.fetchAttestation=async(s,n)=>{this.logger.debug(`resolving attestation: ${s} from url: ${n}`);const o=this.startAbortTimer(W.ONE_SECOND*5),c=await fetch(`${n}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),c.status===200?await c.json():void 0},this.getVerifyUrl=s=>{let n=s||us;return $8.includes(n)||(this.logger.info(`verify url: ${n}, not included in trusted list, assigning default: ${us}`),n=us),n},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(W.FIVE_SECONDS),n=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await n.json()}catch(s){this.logger.warn(s)}},this.persistPublicKey=async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async s=>{const n=await this.getPublicKey();try{if(n)return this.validateAttestation(s,n)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async n=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),n(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s},this.validateAttestation=(s,n)=>{const o=a4(s,n.publicKey),c={hasExpired:W.toMiliseconds(o.exp)<Date.now(),payload:o};if(c.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:c.payload.origin,isScam:c.payload.isScam,isVerified:c.payload.isVerified}},this.logger=Ht(r,this.name),this.abortController=new AbortController,this.isDevEnv=Uf(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Xt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),W.toMiliseconds(e))}}class C9 extends F1{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.context=T8,this.registerDeviceToken=async i=>{const{clientId:s,token:n,notificationType:o,enableEncrypted:c=!1}=i,p=`${F8}/${this.projectId}/clients`;await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:n,always_raw:c})})},this.logger=Ht(r,this.context)}}var L9=Object.defineProperty,Iu=Object.getOwnPropertySymbols,q9=Object.prototype.hasOwnProperty,B9=Object.prototype.propertyIsEnumerable,Au=(t,e,r)=>e in t?L9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,as=(t,e)=>{for(var r in e||(e={}))q9.call(e,r)&&Au(t,r,e[r]);if(Iu)for(var r of Iu(e))B9.call(e,r)&&Au(t,r,e[r]);return t};class U9 extends C1{constructor(e,r,i=!0){super(e,r,i),this.core=e,this.logger=r,this.context=L8,this.storagePrefix=ii,this.storageVersion=C8,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!Uf())try{const s={eventId:_c(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:pl(this.core.relayer.protocol,this.core.relayer.version,hf)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}},this.createEvent=s=>{const{event:n="ERROR",type:o="",properties:{topic:c,trace:p}}=s,b=_c(),w=this.core.projectId||"",x=Date.now(),E=as({eventId:b,timestamp:x,props:{event:n,type:o,properties:{topic:c,trace:p}},bundleId:w,domain:this.getAppDomain()},this.setMethods(b));return this.telemetryEnabled&&(this.events.set(b,E),this.shouldPersist=!0),E},this.getEvent=s=>{const{eventId:n,topic:o}=s;if(n)return this.events.get(n);const c=Array.from(this.events.values()).find(p=>p.props.properties.topic===o);if(c)return as(as({},c),this.setMethods(c.eventId))},this.deleteEvent=s=>{const{eventId:n}=s;this.events.delete(n),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(Fn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{W.fromMiliseconds(Date.now())-W.fromMiliseconds(s.timestamp)>q8&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})},this.setMethods=s=>({addTrace:n=>this.addTrace(s,n),setError:n=>this.setError(s,n)}),this.addTrace=(s,n)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(n),this.events.set(s,o),this.shouldPersist=!0)},this.setError=(s,n)=>{const o=this.events.get(s);o&&(o.props.type=n,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(n=>{this.events.set(n.eventId,as(as({},n),this.setMethods(n.eventId)))})}catch(s){this.logger.warn(s)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[n,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const n of s)this.events.delete(n.eventId),this.shouldPersist=!0}catch(n){this.logger.warn(n)}},this.sendEvent=async s=>{const n=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${B8}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${hf}${n}`,{method:"POST",body:JSON.stringify(s)})},this.getAppDomain=()=>ll().url,this.logger=Ht(r,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var z9=Object.defineProperty,Du=Object.getOwnPropertySymbols,k9=Object.prototype.hasOwnProperty,j9=Object.prototype.propertyIsEnumerable,Ou=(t,e,r)=>e in t?z9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Pu=(t,e)=>{for(var r in e||(e={}))k9.call(e,r)&&Ou(t,r,e[r]);if(Du)for(var r of Du(e))j9.call(e,r)&&Ou(t,r,e[r]);return t};let K9=class o0 extends I1{constructor(e){var r;super(e),this.protocol=Hl,this.version=Wl,this.name=wa,this.events=new jr.EventEmitter,this.initialized=!1,this.on=(o,c)=>this.events.on(o,c),this.once=(o,c)=>this.events.once(o,c),this.off=(o,c)=>this.events.off(o,c),this.removeListener=(o,c)=>this.events.removeListener(o,c),this.dispatchEnvelope=({topic:o,message:c,sessionExists:p})=>{if(!o||!c)return;const b={topic:o,message:c,publishedAt:Date.now(),transportType:st.link_mode};this.relayer.onLinkMessageEvent(b,{sessionExists:p})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Jl,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=vf({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:a8.logger,name:wa}),{logger:s,chunkLoggerController:n}=S1({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=n,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var o,c;(o=this.logChunkController)!=null&&o.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ht(s,this.name),this.heartbeat=new bp,this.crypto=new c9(this,this.logger,e==null?void 0:e.keychain),this.history=new $9(this,this.logger),this.expirer=new T9(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Yp(Pu(Pu({},o8),e==null?void 0:e.storageOptions)),this.relayer=new D9({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new N9(this,this.logger),this.verify=new F9(this,this.logger,this.storage),this.echoClient=new C9(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new U9(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const r=new o0(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(w8,i),r}get context(){return Xt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(ou,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ou)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}};const V9=K9,f0="wc",h0=2,c0="client",Jf=`${f0}@${h0}:${c0}:`,Fo={name:c0,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},Ru="WALLETCONNECT_DEEPLINK_CHOICE",H9="proposal",W9="Proposal expired",G9="session",wn=W.SEVEN_DAYS,J9="engine",Mt={wc_sessionPropose:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1104},res:{ttl:W.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1106},res:{ttl:W.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1112},res:{ttl:W.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1114},res:{ttl:W.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:W.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:W.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1119}}},Co={min:W.FIVE_MINUTES,max:W.SEVEN_DAYS},Hr={idle:"IDLE",active:"ACTIVE"},Z9="request",Y9=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],X9="wc",Q9="auth",e7="authKeys",t7="pairingTopics",r7="requests",Wa=`${X9}@${1.5}:${Q9}:`,na=`${Wa}:PUB_KEY`;var i7=Object.defineProperty,n7=Object.defineProperties,s7=Object.getOwnPropertyDescriptors,Nu=Object.getOwnPropertySymbols,a7=Object.prototype.hasOwnProperty,o7=Object.prototype.propertyIsEnumerable,$u=(t,e,r)=>e in t?i7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lt=(t,e)=>{for(var r in e||(e={}))a7.call(e,r)&&$u(t,r,e[r]);if(Nu)for(var r of Nu(e))o7.call(e,r)&&$u(t,r,e[r]);return t},Lr=(t,e)=>n7(t,s7(e));class f7 extends q1{constructor(e){super(e),this.name=J9,this.events=new ku,this.initialized=!1,this.requestQueue={state:Hr.idle,queue:[]},this.sessionRequestQueue={state:Hr.idle,queue:[]},this.requestQueueDelay=W.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Mt)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},W.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Lr(lt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:s,requiredNamespaces:n,optionalNamespaces:o,sessionProperties:c,relays:p}=i;let b=s,w,x=!1;try{if(b){const L=this.client.core.pairing.pairings.get(b);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),x=L.active}}catch(L){throw this.client.logger.error(`connect() -> pairing.get(${b}) failed`),L}if(!b||!x){const{topic:L,uri:B}=await this.client.core.pairing.create();b=L,w=B}if(!b){const{message:L}=J("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(L)}const E=await this.client.core.crypto.generateKeyPair(),I=Mt.wc_sessionPropose.req.ttl||W.FIVE_MINUTES,S=wt(I),D=lt({requiredNamespaces:n,optionalNamespaces:o,relays:p??[{protocol:Gl}],proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:S,pairingTopic:b},c&&{sessionProperties:c}),{reject:P,resolve:R,done:N}=Hi(I,W9);this.events.once(qe("session_connect"),async({error:L,session:B})=>{if(L)P(L);else if(B){B.self.publicKey=E;const U=Lr(lt({},B),{pairingTopic:D.pairingTopic,requiredNamespaces:D.requiredNamespaces,optionalNamespaces:D.optionalNamespaces,transportType:st.relay});await this.client.session.set(B.topic,U),await this.setExpiry(B.topic,B.expiry),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:B.peer.metadata}),this.cleanupDuplicatePairings(U),R(U)}});const C=await this.sendRequest({topic:b,method:"wc_sessionPropose",params:D,throwOnFailedPublish:!0});return await this.setProposal(C,lt({id:C},D)),{uri:w,approval:N}},this.pair=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async r=>{var i,s,n;const o=this.client.core.eventClient.createEvent({properties:{topic:(i=r==null?void 0:r.id)==null?void 0:i.toString(),trace:[Cr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(k){throw o.setError(Ki.no_internet_connection),k}try{await this.isValidProposalId(r==null?void 0:r.id)}catch(k){throw this.client.logger.error(`approve() -> proposal.get(${r==null?void 0:r.id}) failed`),o.setError(Ki.proposal_not_found),k}try{await this.isValidApprove(r)}catch(k){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ki.session_approve_namespace_validation_failure),k}const{id:c,relayProtocol:p,namespaces:b,sessionProperties:w,sessionConfig:x}=r,E=this.client.proposal.get(c);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:I,proposer:S,requiredNamespaces:D,optionalNamespaces:P}=E;let R=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:I});R||(R=(n=this.client.core.eventClient)==null?void 0:n.createEvent({type:Cr.session_approve_started,properties:{topic:I,trace:[Cr.session_approve_started,Cr.session_namespaces_validation_success]}}));const N=await this.client.core.crypto.generateKeyPair(),C=S.publicKey,L=await this.client.core.crypto.generateSharedKey(N,C),B=lt(lt({relay:{protocol:p??"irn"},namespaces:b,controller:{publicKey:N,metadata:this.client.metadata},expiry:wt(wn)},w&&{sessionProperties:w}),x&&{sessionConfig:x}),U=st.relay;R.addTrace(Cr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(L,{transportType:U})}catch(k){throw R.setError(Ki.subscribe_session_topic_failure),k}R.addTrace(Cr.subscribe_session_topic_success);const K=Lr(lt({},B),{topic:L,requiredNamespaces:D,optionalNamespaces:P,pairingTopic:I,acknowledged:!1,self:B.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:N,transportType:st.relay});await this.client.session.set(L,K),R.addTrace(Cr.store_session);try{R.addTrace(Cr.publishing_session_settle),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0}).catch(k=>{throw R==null||R.setError(Ki.session_settle_publish_failure),k}),R.addTrace(Cr.session_settle_publish_success),R.addTrace(Cr.publishing_session_approve),await this.sendResult({id:c,topic:I,result:{relay:{protocol:p??"irn"},responderPublicKey:N},throwOnFailedPublish:!0}).catch(k=>{throw R==null||R.setError(Ki.session_approve_publish_failure),k}),R.addTrace(Cr.session_approve_publish_success)}catch(k){throw this.client.logger.error(k),this.client.session.delete(L,at("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(L),k}return this.client.core.eventClient.deleteEvent({eventId:R.eventId}),await this.client.core.pairing.updateMetadata({topic:I,metadata:S.metadata}),await this.client.proposal.delete(c,at("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:I}),await this.setExpiry(L,wt(wn)),{topic:L,acknowledged:()=>Promise.resolve(this.client.session.get(L))}},this.reject=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:i,reason:s}=r;let n;try{n=this.client.proposal.get(i).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),o}n&&(await this.sendError({id:i,topic:n,error:s,rpcOpts:Mt.wc_sessionPropose.reject}),await this.client.proposal.delete(i,at("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(x){throw this.client.logger.error("update() -> isValidUpdate() failed"),x}const{topic:i,namespaces:s}=r,{done:n,resolve:o,reject:c}=Hi(),p=Ui(),b=Xi().toString(),w=this.client.session.get(i).namespaces;return this.events.once(qe("session_update",p),({error:x})=>{x?c(x):o()}),await this.client.session.update(i,{namespaces:s}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:p,relayRpcId:b}).catch(x=>{this.client.logger.error(x),this.client.session.update(i,{namespaces:w}),c(x)}),{acknowledged:n}},this.extend=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(p){throw this.client.logger.error("extend() -> isValidExtend() failed"),p}const{topic:i}=r,s=Ui(),{done:n,resolve:o,reject:c}=Hi();return this.events.once(qe("session_extend",s),({error:p})=>{p?c(p):o()}),await this.setExpiry(i,wt(wn)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(p=>{c(p)}),{acknowledged:n}},this.request=async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(S){throw this.client.logger.error("request() -> isValidRequest() failed"),S}const{chainId:i,request:s,topic:n,expiry:o=Mt.wc_sessionRequest.req.ttl}=r,c=this.client.session.get(n);(c==null?void 0:c.transportType)===st.relay&&await this.confirmOnlineStateOrThrow();const p=Ui(),b=Xi().toString(),{done:w,resolve:x,reject:E}=Hi(o,"Request expired. Please try again.");this.events.once(qe("session_request",p),({error:S,result:D})=>{S?E(S):x(D)});const I=this.getAppLinkIfEnabled(c.peer.metadata,c.transportType);return I?(await this.sendRequest({clientRpcId:p,relayRpcId:b,topic:n,method:"wc_sessionRequest",params:{request:Lr(lt({},s),{expiryTimestamp:wt(o)}),chainId:i},expiry:o,throwOnFailedPublish:!0,appLink:I}).catch(S=>E(S)),this.client.events.emit("session_request_sent",{topic:n,request:s,chainId:i,id:p}),await w()):await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:p,relayRpcId:b,topic:n,method:"wc_sessionRequest",params:{request:Lr(lt({},s),{expiryTimestamp:wt(o)}),chainId:i},expiry:o,throwOnFailedPublish:!0}).catch(D=>E(D)),this.client.events.emit("session_request_sent",{topic:n,request:s,chainId:i,id:p}),S()}),new Promise(async S=>{var D;if(!((D=c.sessionConfig)!=null&&D.disableDeepLink)){const P=await aw(this.client.core.storage,Ru);await iw({id:p,topic:n,wcDeepLink:P})}S()}),w()]).then(S=>S[2])},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:s}=r,{id:n}=s,o=this.client.session.get(i);o.transportType===st.relay&&await this.confirmOnlineStateOrThrow();const c=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Gr(s)?await this.sendResult({id:n,topic:i,result:s.result,throwOnFailedPublish:!0,appLink:c}):Er(s)&&await this.sendError({id:n,topic:i,error:s.error,appLink:c}),this.cleanupAfterResponse(r)},this.ping=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:i}=r;if(this.client.session.keys.includes(i)){const s=Ui(),n=Xi().toString(),{done:o,resolve:c,reject:p}=Hi();this.events.once(qe("session_ping",s),({error:b})=>{b?p(b):c()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:n}),o()])}else this.client.core.pairing.pairings.keys.includes(i)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:i}))},this.emit=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:i,event:s,chainId:n}=r,o=Xi().toString(),c=Ui();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:s,chainId:n},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:c})},this.disconnect=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:at("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:s}=J("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(s)}},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>b4(i,r))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(r,i)=>{var s;this.isInitialized(),this.isValidAuthenticate(r);const n=i&&this.client.core.linkModeSupportedApps.includes(i)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=n?st.link_mode:st.relay;o===st.relay&&await this.confirmOnlineStateOrThrow();const{chains:c,statement:p="",uri:b,domain:w,nonce:x,type:E,exp:I,nbf:S,methods:D=[],expiry:P}=r,R=[...r.resources||[]],{topic:N,uri:C}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:N,uri:C}});const L=await this.client.core.crypto.generateKeyPair(),B=ia(L);if(await Promise.all([this.client.auth.authKeys.set(na,{responseTopic:B,publicKey:L}),this.client.auth.pairingTopics.set(B,{topic:B,pairingTopic:N})]),await this.client.core.relayer.subscribe(B,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${N}`),D.length>0){const{namespace:y}=ta(c[0]);let m=Zw(y,"request",D);ra(R)&&(m=Xw(m,R.pop())),R.push(m)}const U=P&&P>Mt.wc_sessionAuthenticate.req.ttl?P:Mt.wc_sessionAuthenticate.req.ttl,K={authPayload:{type:E??"caip122",chains:c,statement:p,aud:b,domain:w,version:"1",nonce:x,iat:new Date().toISOString(),exp:I,nbf:S,resources:R},requester:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:wt(U)},k={eip155:{chains:c,methods:[...new Set(["personal_sign",...D])],events:["chainChanged","accountsChanged"]}},z={requiredNamespaces:{},optionalNamespaces:k,relays:[{protocol:"irn"}],pairingTopic:N,proposer:{publicKey:L,metadata:this.client.metadata},expiryTimestamp:wt(Mt.wc_sessionPropose.req.ttl)},{done:pe,resolve:A,reject:_}=Hi(U,"Request expired"),d=async({error:y,session:m})=>{if(this.events.off(qe("session_request",f),a),y)_(y);else if(m){m.self.publicKey=L,await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:m.peer.metadata});const l=this.client.session.get(m.topic);await this.deleteProposal(u),A({session:l})}},a=async y=>{var m,l,g;if(await this.deletePendingAuthRequest(f,{message:"fulfilled",code:0}),y.error){const H=at("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return y.error.code===H.code?void 0:(this.events.off(qe("session_connect"),d),_(y.error.message))}await this.deleteProposal(u),this.events.off(qe("session_connect"),d);const{cacaos:h,responder:M}=y.result,T=[],$=[];for(const H of h){await Oc({cacao:H,projectId:this.client.core.projectId})||(this.client.logger.error(H,"Signature verification failed"),_(at("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:V}=H,Oe=ra(V.resources),ge=[tf(V.iss)],Y=ga(V.iss);if(Oe){const Be=Pc(Oe),be=Rc(Oe);T.push(...Be),ge.push(...be)}for(const Be of ge)$.push(`${Be}:${Y}`)}const q=await this.client.core.crypto.generateSharedKey(L,M.publicKey);let G;T.length>0&&(G={topic:q,acknowledged:!0,self:{publicKey:L,metadata:this.client.metadata},peer:M,controller:M.publicKey,expiry:wt(wn),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:N,namespaces:Zc([...new Set(T)],[...new Set($)]),transportType:o},await this.client.core.relayer.subscribe(q,{transportType:o}),await this.client.session.set(q,G),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:M.metadata}),G=this.client.session.get(q)),(m=this.client.metadata.redirect)!=null&&m.linkMode&&(l=M.metadata.redirect)!=null&&l.linkMode&&(g=M.metadata.redirect)!=null&&g.universal&&i&&(this.client.core.addLinkModeSupportedApp(M.metadata.redirect.universal),this.client.session.update(q,{transportType:st.link_mode})),A({auths:h,session:G})},f=Ui(),u=Ui();this.events.once(qe("session_connect"),d),this.events.once(qe("session_request",f),a);let v;try{if(n){const y=Yi("wc_sessionAuthenticate",K,f);this.client.core.history.set(N,y);const m=await this.client.core.crypto.encode("",y,{type:Ps,encoding:ts});v=Ws(i,N,m)}else await Promise.all([this.sendRequest({topic:N,method:"wc_sessionAuthenticate",params:K,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:f}),this.sendRequest({topic:N,method:"wc_sessionPropose",params:z,expiry:Mt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:u})])}catch(y){throw this.events.off(qe("session_connect"),d),this.events.off(qe("session_request",f),a),y}return await this.setProposal(u,lt({id:u},z)),await this.setAuthRequest(f,{request:Lr(lt({},K),{verifyContext:{}}),pairingTopic:N,transportType:o}),{uri:v??C,response:pe}},this.approveSessionAuthenticate=async r=>{const{id:i,auths:s}=r,n=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[Vi.authenticated_session_approve_started]}});try{this.isInitialized()}catch(P){throw n.setError(ns.no_internet_connection),P}const o=this.getPendingAuthRequest(i);if(!o)throw n.setError(ns.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const c=o.transportType||st.relay;c===st.relay&&await this.confirmOnlineStateOrThrow();const p=o.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),w=ia(p),x={type:vi,receiverPublicKey:p,senderPublicKey:b},E=[],I=[];for(const P of s){if(!await Oc({cacao:P,projectId:this.client.core.projectId})){n.setError(ns.invalid_cacao);const B=at("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:w,error:B,encodeOpts:x}),new Error(B.message)}n.addTrace(Vi.cacaos_verified);const{p:R}=P,N=ra(R.resources),C=[tf(R.iss)],L=ga(R.iss);if(N){const B=Pc(N),U=Rc(N);E.push(...B),C.push(...U)}for(const B of C)I.push(`${B}:${L}`)}const S=await this.client.core.crypto.generateSharedKey(b,p);n.addTrace(Vi.create_authenticated_session_topic);let D;if((E==null?void 0:E.length)>0){D={topic:S,acknowledged:!0,self:{publicKey:b,metadata:this.client.metadata},peer:{publicKey:p,metadata:o.requester.metadata},controller:p,expiry:wt(wn),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Zc([...new Set(E)],[...new Set(I)]),transportType:c},n.addTrace(Vi.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(S,{transportType:c})}catch(P){throw n.setError(ns.subscribe_authenticated_session_topic_failure),P}n.addTrace(Vi.subscribe_authenticated_session_topic_success),await this.client.session.set(S,D),n.addTrace(Vi.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}n.addTrace(Vi.publishing_authenticated_session_approve);try{await this.sendResult({topic:w,id:i,result:{cacaos:s,responder:{publicKey:b,metadata:this.client.metadata}},encodeOpts:x,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,c)})}catch(P){throw n.setError(ns.authenticated_session_approve_publish_failure),P}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:D}},this.rejectSessionAuthenticate=async r=>{this.isInitialized();const{id:i,reason:s}=r,n=this.getPendingAuthRequest(i);if(!n)throw new Error(`Could not find pending auth request with id ${i}`);n.transportType===st.relay&&await this.confirmOnlineStateOrThrow();const o=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),p=ia(o),b={type:vi,receiverPublicKey:o,senderPublicKey:c};await this.sendError({id:i,topic:p,error:s,encodeOpts:b,rpcOpts:Mt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(n.requester.metadata,n.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,at("USER_DISCONNECTED"))},this.formatAuthMessage=r=>{this.isInitialized();const{request:i,iss:s}=r;return Al(i,s)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)},this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(n=>{var o,c;return((o=n.peerMetadata)==null?void 0:o.url)&&((c=n.peerMetadata)==null?void 0:c.url)===r.peer.metadata.url&&n.topic&&n.topic!==i.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(n=>this.client.core.pairing.disconnect({topic:n.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async r=>{var i;const{topic:s,expirerHasDeleted:n=!1,emitEvent:o=!0,id:c=0}=r,{self:p}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,at("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(p.publicKey)&&await this.client.core.crypto.deleteKeyPair(p.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),n||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Ru).catch(b=>this.client.logger.warn(b)),this.getPendingSessionRequests().forEach(b=>{b.topic===s&&this.deletePendingSessionRequest(b.id,at("USER_DISCONNECTED"))}),s===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=Hr.idle),o&&this.client.events.emit("session_delete",{id:c,topic:s})},this.deleteProposal=async(r,i)=>{if(i)try{const s=this.client.proposal.get(r),n=this.client.core.eventClient.getEvent({topic:s.pairingTopic});n==null||n.setError(Ki.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,at("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")},this.deletePendingSessionRequest=async(r,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(n=>n.id!==r),s&&(this.sessionRequestQueue.state=Hr.idle,this.client.events.emit("session_request_expire",{id:r}))},this.deletePendingAuthRequest=async(r,i,s=!1)=>{await Promise.all([this.client.auth.requests.delete(r,i),s?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,i),await this.client.session.update(r,{expiry:i}))},this.setProposal=async(r,i)=>{this.client.core.expirer.set(r,wt(Mt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,i)},this.setAuthRequest=async(r,i)=>{const{request:s,pairingTopic:n,transportType:o=st.relay}=i;this.client.core.expirer.set(r,s.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:r,pairingTopic:n,verifyContext:s.verifyContext,transportType:o})},this.setPendingSessionRequest=async r=>{const{id:i,topic:s,params:n,verifyContext:o}=r,c=n.request.expiryTimestamp||wt(Mt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,c),await this.client.pendingRequest.set(i,{id:i,topic:s,params:n,verifyContext:o})},this.sendRequest=async r=>{const{topic:i,method:s,params:n,expiry:o,relayRpcId:c,clientRpcId:p,throwOnFailedPublish:b,appLink:w}=r,x=Yi(s,n,p);let E;const I=!!w;try{const P=I?ts:Ri;E=await this.client.core.crypto.encode(i,x,{encoding:P})}catch(P){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),P}let S;if(Y9.includes(s)){const P=pi(JSON.stringify(x)),R=pi(E);S=await this.client.core.verify.register({id:R,decryptedId:P})}const D=Mt[s].req;if(D.attestation=S,o&&(D.ttl=o),c&&(D.id=c),this.client.core.history.set(i,x),I){const P=Ws(w,i,E);await global.Linking.openURL(P,this.client.name)}else{const P=Mt[s].req;o&&(P.ttl=o),c&&(P.id=c),b?(P.internal=Lr(lt({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,E,P)):this.client.core.relayer.publish(i,E,P).catch(R=>this.client.logger.error(R))}return x.id},this.sendResult=async r=>{const{id:i,topic:s,result:n,throwOnFailedPublish:o,encodeOpts:c,appLink:p}=r,b=lf(i,n);let w;const x=p&&typeof(global==null?void 0:global.Linking)<"u";try{const I=x?ts:Ri;w=await this.client.core.crypto.encode(s,b,Lr(lt({},c||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),I}let E;try{E=await this.client.core.history.get(s,i)}catch(I){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${i}) failed`),I}if(x){const I=Ws(p,s,w);await global.Linking.openURL(I,this.client.name)}else{const I=Mt[E.request.method].res;o?(I.internal=Lr(lt({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,w,I)):this.client.core.relayer.publish(s,w,I).catch(S=>this.client.logger.error(S))}await this.client.core.history.resolve(b)},this.sendError=async r=>{const{id:i,topic:s,error:n,encodeOpts:o,rpcOpts:c,appLink:p}=r,b=df(i,n);let w;const x=p&&typeof(global==null?void 0:global.Linking)<"u";try{const I=x?ts:Ri;w=await this.client.core.crypto.encode(s,b,Lr(lt({},o||{}),{encoding:I}))}catch(I){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),I}let E;try{E=await this.client.core.history.get(s,i)}catch(I){throw this.client.logger.error(`sendError() -> history.get(${s}, ${i}) failed`),I}if(x){const I=Ws(p,s,w);await global.Linking.openURL(I,this.client.name)}else{const I=c||Mt[E.request.method].res;this.client.core.relayer.publish(s,w,I)}await this.client.core.history.resolve(b)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(s=>{let n=!1;Di(s.expiry)&&(n=!0),this.client.core.crypto.keychain.has(s.topic)||(n=!0),n&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Di(s.expiryTimestamp)&&i.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession({topic:s})),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Hr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Hr.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Hr.idle},this.processRequest=async r=>{const{topic:i,payload:s,attestation:n,transportType:o,encryptedId:c}=r,p=s.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:p}))switch(p){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:s,attestation:n,encryptedId:c});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,s);case"wc_sessionPing":return await this.onSessionPingRequest(i,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:s,attestation:n,encryptedId:c,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(i,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:s,attestation:n,encryptedId:c,transportType:o});default:return this.client.logger.info(`Unsupported request method ${p}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:s,transportType:n}=r,o=(await this.client.core.history.get(i,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:s}=J("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.shouldIgnorePairingRequest=r=>{const{topic:i,requestMethod:s}=r,n=this.expectedPairingMethodMap.get(i);return!n||n.includes(s)?!1:!!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async r=>{const{topic:i,payload:s,attestation:n,encryptedId:o}=r,{params:c,id:p}=s;try{const b=this.client.core.eventClient.getEvent({topic:i});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),b==null||b.setError(li.proposal_listener_not_found)),this.isValidConnect(lt({},s.params));const w=c.expiryTimestamp||wt(Mt.wc_sessionPropose.req.ttl),x=lt({id:p,pairingTopic:i,expiryTimestamp:w},c);await this.setProposal(p,x);const E=await this.getVerifyContext({attestationId:n,hash:pi(JSON.stringify(s)),encryptedId:o,metadata:x.proposer.metadata});b==null||b.addTrace(Wr.emit_session_proposal),this.client.events.emit("session_proposal",{id:p,params:x,verifyContext:E})}catch(b){await this.sendError({id:p,topic:i,error:b,rpcOpts:Mt.wc_sessionPropose.autoReject}),this.client.logger.error(b)}},this.onSessionProposeResponse=async(r,i,s)=>{const{id:n}=i;if(Gr(i)){const{result:o}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const c=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:c});const p=c.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const b=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const w=await this.client.core.crypto.generateSharedKey(p,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const x=await this.client.core.relayer.subscribe(w,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:r})}else if(Er(i)){await this.client.proposal.delete(n,at("USER_DISCONNECTED"));const o=qe("session_connect");if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(qe("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(r,i)=>{const{id:s,params:n}=i;try{this.isValidSessionSettleRequest(n);const{relay:o,controller:c,expiry:p,namespaces:b,sessionProperties:w,sessionConfig:x}=i.params,E=Lr(lt(lt({topic:r,relay:o,expiry:p,namespaces:b,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},w&&{sessionProperties:w}),x&&{sessionConfig:x}),{transportType:st.relay}),I=qe("session_connect");if(this.events.listenerCount(I)===0)throw new Error(`emitting ${I} without any listeners 997`);this.events.emit(qe("session_connect"),{session:E}),await this.sendResult({id:i.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,i)=>{const{id:s}=i;Gr(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(qe("session_approve",s),{})):Er(i)&&(await this.client.session.delete(r,at("USER_DISCONNECTED")),this.events.emit(qe("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:s,id:n}=i;try{const o=`${r}_session_update`,c=rs.get(o);if(c&&this.isRequestOutOfSync(c,n)){this.client.logger.warn(`Discarding out of sync request - ${n}`),this.sendError({id:n,topic:r,error:at("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(lt({topic:r},s));try{rs.set(o,n),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0})}catch(p){throw rs.delete(o),p}this.client.events.emit("session_update",{id:n,topic:r,params:s})}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}},this.isRequestOutOfSync=(r,i)=>i.toString().slice(0,-3)<r.toString().slice(0,-3),this.onSessionUpdateResponse=(r,i)=>{const{id:s}=i,n=qe("session_update",s);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Gr(i)?this.events.emit(qe("session_update",s),{}):Er(i)&&this.events.emit(qe("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:s}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,wt(wn)),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(n){await this.sendError({id:s,topic:r,error:n}),this.client.logger.error(n)}},this.onSessionExtendResponse=(r,i)=>{const{id:s}=i,n=qe("session_extend",s);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Gr(i)?this.events.emit(qe("session_extend",s),{}):Er(i)&&this.events.emit(qe("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(n){await this.sendError({id:s,topic:r,error:n}),this.client.logger.error(n)}},this.onSessionPingResponse=(r,i)=>{const{id:s}=i,n=qe("session_ping",s);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);setTimeout(()=>{Gr(i)?this.events.emit(qe("session_ping",s),{}):Er(i)&&this.events.emit(qe("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),Promise.all([new Promise(n=>{this.client.core.relayer.once(It.publish,async()=>{n(await this.deleteSession({topic:r,id:s}))})}),this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:at("USER_DISCONNECTED")})]).catch(n=>this.client.logger.error(n))}catch(n){this.client.logger.error(n)}},this.onSessionRequest=async r=>{var i,s,n;const{topic:o,payload:c,attestation:p,encryptedId:b,transportType:w}=r,{id:x,params:E}=c;try{await this.isValidRequest(lt({topic:o},E));const I=this.client.session.get(o),S=await this.getVerifyContext({attestationId:p,hash:pi(JSON.stringify(Yi("wc_sessionRequest",E,x))),encryptedId:b,metadata:I.peer.metadata,transportType:w}),D={id:x,topic:o,params:E,verifyContext:S};await this.setPendingSessionRequest(D),w===st.link_mode&&(i=I.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((s=I.peer.metadata.redirect)==null?void 0:s.universal),(n=this.client.signConfig)!=null&&n.disableRequestQueue?this.emitSessionRequest(D):(this.addSessionRequestToSessionRequestQueue(D),this.processSessionRequestQueue())}catch(I){await this.sendError({id:x,topic:o,error:I}),this.client.logger.error(I)}},this.onSessionRequestResponse=(r,i)=>{const{id:s}=i,n=qe("session_request",s);if(this.events.listenerCount(n)===0)throw new Error(`emitting ${n} without any listeners`);Gr(i)?this.events.emit(qe("session_request",s),{result:i.result}):Er(i)&&this.events.emit(qe("session_request",s),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:s,params:n}=i;try{const o=`${r}_session_event_${n.event.name}`,c=rs.get(o);if(c&&this.isRequestOutOfSync(c,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(lt({topic:r},n)),this.client.events.emit("session_event",{id:s,topic:r,params:n}),rs.set(o,s)}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}},this.onSessionAuthenticateResponse=(r,i)=>{const{id:s}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:i}),Gr(i)?this.events.emit(qe("session_request",s),{result:i.result}):Er(i)&&this.events.emit(qe("session_request",s),{error:i.error})},this.onSessionAuthenticateRequest=async r=>{var i;const{topic:s,payload:n,attestation:o,encryptedId:c,transportType:p}=r;try{const{requester:b,authPayload:w,expiryTimestamp:x}=n.params,E=await this.getVerifyContext({attestationId:o,hash:pi(JSON.stringify(n)),encryptedId:c,metadata:b.metadata,transportType:p}),I={requester:b,pairingTopic:s,id:n.id,authPayload:w,verifyContext:E,expiryTimestamp:x};await this.setAuthRequest(n.id,{request:I,pairingTopic:s,transportType:p}),p===st.link_mode&&(i=b.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(b.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:n.params,id:n.id,verifyContext:E})}catch(b){this.client.logger.error(b);const w=n.params.requester.publicKey,x=await this.client.core.crypto.generateKeyPair(),E=this.getAppLinkIfEnabled(n.params.requester.metadata,p),I={type:vi,receiverPublicKey:w,senderPublicKey:x};await this.sendError({id:n.id,topic:s,error:b,encodeOpts:I,rpcOpts:Mt.wc_sessionAuthenticate.autoReject,appLink:E})}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Hr.idle,this.processSessionRequestQueue()},W.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:r,error:i})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(n=>n.topic===r&&n.request.method==="wc_sessionRequest").forEach(n=>{const o=n.request.id,c=qe("session_request",o);if(this.events.listenerCount(c)===0)throw new Error(`emitting ${c} without any listeners`);this.events.emit(qe("session_request",n.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Hr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Hr.active,this.emitSessionRequest(r)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=r=>{this.client.events.emit("session_request",r)},this.onPairingCreated=r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const i=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);i&&this.onSessionProposeRequest({topic:r.topic,payload:Yi("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async r=>{if(!Jt(r)){const{message:p}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(p)}const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:n,sessionProperties:o,relays:c}=r;if(Kt(i)||await this.isValidPairingTopic(i),!O4(c)){const{message:p}=J("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(p)}!Kt(s)&&ba(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Kt(n)&&ba(n)!==0&&this.validateNamespaces(n,"optionalNamespaces"),Kt(o)||this.validateSessionProps(o,"sessionProperties")},this.validateNamespaces=(r,i)=>{const s=D4(r,"connect()",i);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!Jt(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:s,relayProtocol:n,sessionProperties:o}=r;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const c=this.client.proposal.get(i),p=Ro(s,"approve()");if(p)throw new Error(p.message);const b=Qc(c.requiredNamespaces,s,"approve()");if(b)throw new Error(b.message);if(!vt(n,!0)){const{message:w}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(w)}Kt(o)||this.validateSessionProps(o,"sessionProperties")},this.isValidReject=async r=>{if(!Jt(r)){const{message:n}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(n)}const{id:i,reason:s}=r;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!R4(s)){const{message:n}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(n)}},this.isValidSessionSettleRequest=r=>{if(!Jt(r)){const{message:b}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(b)}const{relay:i,controller:s,namespaces:n,expiry:o}=r;if(!Kl(i)){const{message:b}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}const c=x4(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);const p=Ro(n,"onSessionSettleRequest()");if(p)throw new Error(p.message);if(Di(o)){const{message:b}=J("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=async r=>{if(!Jt(r)){const{message:p}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(p)}const{topic:i,namespaces:s}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const n=this.client.session.get(i),o=Ro(s,"update()");if(o)throw new Error(o.message);const c=Qc(n.requiredNamespaces,s,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!Jt(r)){const{message:s}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:i}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!Jt(r)){const{message:p}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(p)}const{topic:i,request:s,chainId:n,expiry:o}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Xc(c,n)){const{message:p}=J("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(p)}if(!N4(s)){const{message:p}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(p)}if(!F4(c,n,s.method)){const{message:p}=J("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(p)}if(o&&!B4(o,Co)){const{message:p}=J("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Co.min} and ${Co.max}`);throw new Error(p)}},this.isValidRespond=async r=>{var i;if(!Jt(r)){const{message:o}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:s,response:n}=r;try{await this.isValidSessionTopic(s)}catch(o){throw(i=r==null?void 0:r.response)!=null&&i.id&&this.cleanupAfterResponse(r),o}if(!$4(n)){const{message:o}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(o)}},this.isValidPing=async r=>{if(!Jt(r)){const{message:s}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!Jt(r)){const{message:c}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:s,chainId:n}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!Xc(o,n)){const{message:c}=J("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(c)}if(!T4(s)){const{message:c}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}if(!C4(o,n,s.name)){const{message:c}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!Jt(r)){const{message:s}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=r=>{const{chains:i,uri:s,domain:n,nonce:o}=r;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!vt(s,!1))throw new Error("uri is required parameter");if(!vt(n,!1))throw new Error("domain is required parameter");if(!vt(o,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(p=>ta(p).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:c}=ta(i[0]);if(c!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async r=>{const{attestationId:i,hash:s,encryptedId:n,metadata:o,transportType:c}=r,p={verified:{verifyUrl:o.verifyUrl||us,validation:"UNKNOWN",origin:o.url||""}};try{if(c===st.link_mode){const w=this.getAppLinkIfEnabled(o,c);return p.verified.validation=w&&new URL(w).origin===new URL(o.url).origin?"VALID":"INVALID",p}const b=await this.client.core.verify.resolve({attestationId:i,hash:s,encryptedId:n,verifyUrl:o.verifyUrl});b&&(p.verified.origin=b.origin,p.verified.isScam=b.isScam,p.verified.validation=b.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(b){this.client.logger.warn(b)}return this.client.logger.debug(`Verify context: ${JSON.stringify(p)}`),p},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(s=>{if(!vt(s,!1)){const{message:n}=J("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(n)}})},this.getPendingAuthRequest=r=>{const i=this.client.auth.requests.get(r);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(r,i)=>{if(this.recentlyDeletedMap.set(r,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const n=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=n)break;this.recentlyDeletedMap.delete(o)}}},this.checkRecentlyDeleted=r=>{const i=this.recentlyDeletedMap.get(r);if(i){const{message:s}=J("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${r}`);throw new Error(s)}},this.isLinkModeEnabled=(r,i)=>{var s,n,o,c,p,b,w,x,E;return!r||i!==st.link_mode?!1:((n=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:n.linkMode)===!0&&((c=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:c.universal)!==void 0&&((b=(p=this.client.metadata)==null?void 0:p.redirect)==null?void 0:b.universal)!==""&&((w=r==null?void 0:r.redirect)==null?void 0:w.universal)!==void 0&&((x=r==null?void 0:r.redirect)==null?void 0:x.universal)!==""&&((E=r==null?void 0:r.redirect)==null?void 0:E.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"},this.getAppLinkIfEnabled=(r,i)=>{var s;return this.isLinkModeEnabled(r,i)?(s=r==null?void 0:r.redirect)==null?void 0:s.universal:void 0},this.handleLinkModeMessage=({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const i=wc(r,"topic")||"",s=decodeURIComponent(wc(r,"wc_ev")||""),n=this.client.session.keys.includes(i);n&&this.client.session.update(i,{transportType:st.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:s,sessionExists:n})},this.registerLinkModeListeners=async()=>{var r;if(Uf()||Li()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await i.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(It.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:r,message:i,attestation:s,transportType:n}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(na)?this.client.auth.authKeys.get(na):{responseTopic:void 0,publicKey:void 0},c=await this.client.core.crypto.decode(r,i,{receiverPublicKey:o,encoding:n===st.link_mode?ts:Ri});try{Gf(c)?(this.client.core.history.set(r,c),this.onRelayEventRequest({topic:r,payload:c,attestation:s,transportType:n,encryptedId:pi(i)})):Va(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:r,payload:c,transportType:n}),this.client.core.history.delete(r,c.id)):this.onRelayEventUnknownPayload({topic:r,payload:c,transportType:n})}catch(p){this.client.logger.error(p)}}registerExpirerEvents(){this.client.core.expirer.on(Mr.expired,async e=>{const{topic:r,id:i}=ml(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,J("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ji.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Ji.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!vt(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!vt(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=J("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=J("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(vt(e,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!P4(e)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=J("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class h7 extends dn{constructor(e,r){super(e,r,H9,Jf),this.core=e,this.logger=r}}class c7 extends dn{constructor(e,r){super(e,r,G9,Jf),this.core=e,this.logger=r}}class u7 extends dn{constructor(e,r){super(e,r,Z9,Jf,i=>i.id),this.core=e,this.logger=r}}class d7 extends dn{constructor(e,r){super(e,r,e7,Wa,()=>na),this.core=e,this.logger=r}}class l7 extends dn{constructor(e,r){super(e,r,t7,Wa),this.core=e,this.logger=r}}class p7 extends dn{constructor(e,r){super(e,r,r7,Wa,i=>i.id),this.core=e,this.logger=r}}class g7{constructor(e,r){this.core=e,this.logger=r,this.authKeys=new d7(this.core,this.logger),this.pairingTopics=new l7(this.core,this.logger),this.requests=new p7(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Zf extends L1{constructor(e){super(e),this.protocol=f0,this.version=h0,this.name=Fo.name,this.events=new jr.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,s)=>{try{return await this.engine.authenticate(i,s)}catch(n){throw this.logger.error(n.message),n}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(s){throw this.logger.error(s.message),s}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Fo.name,this.metadata=(e==null?void 0:e.metadata)||ll(),this.signConfig=e==null?void 0:e.signConfig;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Sa(vf({level:(e==null?void 0:e.logger)||Fo.logger}));this.core=(e==null?void 0:e.core)||new V9(e),this.logger=Ht(r,this.name),this.session=new c7(this.core,this.logger),this.proposal=new h7(this.core,this.logger),this.pendingRequest=new u7(this.core,this.logger),this.engine=new f7(this),this.auth=new g7(this.core,this.logger)}static async init(e){const r=new Zf(e);return await r.initialize(),r}get context(){return Xt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},W.toMiliseconds(W.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const j7=Zf;export{Q9 as AUTH_CONTEXT,e7 as AUTH_KEYS_CONTEXT,t7 as AUTH_PAIRING_TOPIC_CONTEXT,X9 as AUTH_PROTOCOL,na as AUTH_PUBLIC_KEY_NAME,r7 as AUTH_REQUEST_CONTEXT,Wa as AUTH_STORAGE_PREFIX,J9 as ENGINE_CONTEXT,Hr as ENGINE_QUEUE_STATES,Mt as ENGINE_RPC_OPTS,Y9 as METHODS_TO_VERIFY,H9 as PROPOSAL_CONTEXT,W9 as PROPOSAL_EXPIRY_MESSAGE,Z9 as REQUEST_CONTEXT,G9 as SESSION_CONTEXT,wn as SESSION_EXPIRY,Co as SESSION_REQUEST_EXPIRY_BOUNDARIES,c0 as SIGN_CLIENT_CONTEXT,Fo as SIGN_CLIENT_DEFAULT,f0 as SIGN_CLIENT_PROTOCOL,Jf as SIGN_CLIENT_STORAGE_PREFIX,h0 as SIGN_CLIENT_VERSION,j7 as SignClient,Ru as WALLETCONNECT_DEEPLINK_CHOICE,Zf as default};
